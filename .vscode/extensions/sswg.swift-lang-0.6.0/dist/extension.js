var Ob=Object.create;var ys=Object.defineProperty,Lb=Object.defineProperties,Ab=Object.getOwnPropertyDescriptor,Mb=Object.getOwnPropertyDescriptors,$b=Object.getOwnPropertyNames,Zd=Object.getOwnPropertySymbols,jb=Object.getPrototypeOf,ef=Object.prototype.hasOwnProperty,Wb=Object.prototype.propertyIsEnumerable;var tf=(n,e,t)=>e in n?ys(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,Ve=(n,e)=>{for(var t in e||(e={}))ef.call(e,t)&&tf(n,t,e[t]);if(Zd)for(var t of Zd(e))Wb.call(e,t)&&tf(n,t,e[t]);return n},Bo=(n,e)=>Lb(n,Mb(e)),nf=n=>ys(n,"__esModule",{value:!0});var F=(n,e)=>()=>(e||n((e={exports:{}}).exports,e),e.exports),Hb=(n,e)=>{for(var t in e)ys(n,t,{get:e[t],enumerable:!0})},rf=(n,e,t,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of $b(e))!ef.call(n,i)&&(t||i!=="default")&&ys(n,i,{get:()=>e[i],enumerable:!(r=Ab(e,i))||r.enumerable});return n},ne=(n,e)=>rf(nf(ys(n!=null?Ob(jb(n)):{},"default",!e&&n&&n.__esModule?{get:()=>n.default,enumerable:!0}:{value:n,enumerable:!0})),n),Ub=(n=>(e,t)=>n&&n.get(e)||(t=rf(nf({}),e,1),n&&n.set(e,t),t))(typeof WeakMap!="undefined"?new WeakMap:0);var Ss=F((RI,Rf)=>{var nD="2.0.0",rD=256,iD=Number.MAX_SAFE_INTEGER||9007199254740991,sD=16;Rf.exports={SEMVER_SPEC_VERSION:nD,MAX_LENGTH:rD,MAX_SAFE_INTEGER:iD,MAX_SAFE_COMPONENT_LENGTH:sD}});var _s=F((SI,Sf)=>{var oD=typeof process=="object"&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?(...n)=>console.error("SEMVER",...n):()=>{};Sf.exports=oD});var Zr=F((Or,_f)=>{var{MAX_SAFE_COMPONENT_LENGTH:Yc}=Ss(),aD=_s();Or=_f.exports={};var cD=Or.re=[],G=Or.src=[],Q=Or.t={},uD=0,pe=(n,e,t)=>{let r=uD++;aD(r,e),Q[n]=r,G[r]=e,cD[r]=new RegExp(e,t?"g":void 0)};pe("NUMERICIDENTIFIER","0|[1-9]\\d*");pe("NUMERICIDENTIFIERLOOSE","[0-9]+");pe("NONNUMERICIDENTIFIER","\\d*[a-zA-Z-][a-zA-Z0-9-]*");pe("MAINVERSION",`(${G[Q.NUMERICIDENTIFIER]})\\.(${G[Q.NUMERICIDENTIFIER]})\\.(${G[Q.NUMERICIDENTIFIER]})`);pe("MAINVERSIONLOOSE",`(${G[Q.NUMERICIDENTIFIERLOOSE]})\\.(${G[Q.NUMERICIDENTIFIERLOOSE]})\\.(${G[Q.NUMERICIDENTIFIERLOOSE]})`);pe("PRERELEASEIDENTIFIER",`(?:${G[Q.NUMERICIDENTIFIER]}|${G[Q.NONNUMERICIDENTIFIER]})`);pe("PRERELEASEIDENTIFIERLOOSE",`(?:${G[Q.NUMERICIDENTIFIERLOOSE]}|${G[Q.NONNUMERICIDENTIFIER]})`);pe("PRERELEASE",`(?:-(${G[Q.PRERELEASEIDENTIFIER]}(?:\\.${G[Q.PRERELEASEIDENTIFIER]})*))`);pe("PRERELEASELOOSE",`(?:-?(${G[Q.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${G[Q.PRERELEASEIDENTIFIERLOOSE]})*))`);pe("BUILDIDENTIFIER","[0-9A-Za-z-]+");pe("BUILD",`(?:\\+(${G[Q.BUILDIDENTIFIER]}(?:\\.${G[Q.BUILDIDENTIFIER]})*))`);pe("FULLPLAIN",`v?${G[Q.MAINVERSION]}${G[Q.PRERELEASE]}?${G[Q.BUILD]}?`);pe("FULL",`^${G[Q.FULLPLAIN]}$`);pe("LOOSEPLAIN",`[v=\\s]*${G[Q.MAINVERSIONLOOSE]}${G[Q.PRERELEASELOOSE]}?${G[Q.BUILD]}?`);pe("LOOSE",`^${G[Q.LOOSEPLAIN]}$`);pe("GTLT","((?:<|>)?=?)");pe("XRANGEIDENTIFIERLOOSE",`${G[Q.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`);pe("XRANGEIDENTIFIER",`${G[Q.NUMERICIDENTIFIER]}|x|X|\\*`);pe("XRANGEPLAIN",`[v=\\s]*(${G[Q.XRANGEIDENTIFIER]})(?:\\.(${G[Q.XRANGEIDENTIFIER]})(?:\\.(${G[Q.XRANGEIDENTIFIER]})(?:${G[Q.PRERELEASE]})?${G[Q.BUILD]}?)?)?`);pe("XRANGEPLAINLOOSE",`[v=\\s]*(${G[Q.XRANGEIDENTIFIERLOOSE]})(?:\\.(${G[Q.XRANGEIDENTIFIERLOOSE]})(?:\\.(${G[Q.XRANGEIDENTIFIERLOOSE]})(?:${G[Q.PRERELEASELOOSE]})?${G[Q.BUILD]}?)?)?`);pe("XRANGE",`^${G[Q.GTLT]}\\s*${G[Q.XRANGEPLAIN]}$`);pe("XRANGELOOSE",`^${G[Q.GTLT]}\\s*${G[Q.XRANGEPLAINLOOSE]}$`);pe("COERCE",`(^|[^\\d])(\\d{1,${Yc}})(?:\\.(\\d{1,${Yc}}))?(?:\\.(\\d{1,${Yc}}))?(?:$|[^\\d])`);pe("COERCERTL",G[Q.COERCE],!0);pe("LONETILDE","(?:~>?)");pe("TILDETRIM",`(\\s*)${G[Q.LONETILDE]}\\s+`,!0);Or.tildeTrimReplace="$1~";pe("TILDE",`^${G[Q.LONETILDE]}${G[Q.XRANGEPLAIN]}$`);pe("TILDELOOSE",`^${G[Q.LONETILDE]}${G[Q.XRANGEPLAINLOOSE]}$`);pe("LONECARET","(?:\\^)");pe("CARETTRIM",`(\\s*)${G[Q.LONECARET]}\\s+`,!0);Or.caretTrimReplace="$1^";pe("CARET",`^${G[Q.LONECARET]}${G[Q.XRANGEPLAIN]}$`);pe("CARETLOOSE",`^${G[Q.LONECARET]}${G[Q.XRANGEPLAINLOOSE]}$`);pe("COMPARATORLOOSE",`^${G[Q.GTLT]}\\s*(${G[Q.LOOSEPLAIN]})$|^$`);pe("COMPARATOR",`^${G[Q.GTLT]}\\s*(${G[Q.FULLPLAIN]})$|^$`);pe("COMPARATORTRIM",`(\\s*)${G[Q.GTLT]}\\s*(${G[Q.LOOSEPLAIN]}|${G[Q.XRANGEPLAIN]})`,!0);Or.comparatorTrimReplace="$1$2$3";pe("HYPHENRANGE",`^\\s*(${G[Q.XRANGEPLAIN]})\\s+-\\s+(${G[Q.XRANGEPLAIN]})\\s*$`);pe("HYPHENRANGELOOSE",`^\\s*(${G[Q.XRANGEPLAINLOOSE]})\\s+-\\s+(${G[Q.XRANGEPLAINLOOSE]})\\s*$`);pe("STAR","(<|>)?=?\\s*\\*");pe("GTE0","^\\s*>=\\s*0.0.0\\s*$");pe("GTE0PRE","^\\s*>=\\s*0.0.0-0\\s*$")});var Ps=F((_I,Pf)=>{var lD=["includePrerelease","loose","rtl"],dD=n=>n?typeof n!="object"?{loose:!0}:lD.filter(e=>n[e]).reduce((e,t)=>(e[t]=!0,e),{}):{};Pf.exports=dD});var ra=F((PI,xf)=>{var kf=/^[0-9]+$/,Ef=(n,e)=>{let t=kf.test(n),r=kf.test(e);return t&&r&&(n=+n,e=+e),n===e?0:t&&!r?-1:r&&!t?1:n<e?-1:1},fD=(n,e)=>Ef(e,n);xf.exports={compareIdentifiers:Ef,rcompareIdentifiers:fD}});var qt=F((kI,Nf)=>{var ia=_s(),{MAX_LENGTH:qf,MAX_SAFE_INTEGER:sa}=Ss(),{re:If,t:Ff}=Zr(),hD=Ps(),{compareIdentifiers:ks}=ra(),pn=class{constructor(e,t){if(t=hD(t),e instanceof pn){if(e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease)return e;e=e.version}else if(typeof e!="string")throw new TypeError(`Invalid Version: ${e}`);if(e.length>qf)throw new TypeError(`version is longer than ${qf} characters`);ia("SemVer",e,t),this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease;let r=e.trim().match(t.loose?If[Ff.LOOSE]:If[Ff.FULL]);if(!r)throw new TypeError(`Invalid Version: ${e}`);if(this.raw=e,this.major=+r[1],this.minor=+r[2],this.patch=+r[3],this.major>sa||this.major<0)throw new TypeError("Invalid major version");if(this.minor>sa||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>sa||this.patch<0)throw new TypeError("Invalid patch version");r[4]?this.prerelease=r[4].split(".").map(i=>{if(/^[0-9]+$/.test(i)){let s=+i;if(s>=0&&s<sa)return s}return i}):this.prerelease=[],this.build=r[5]?r[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(e){if(ia("SemVer.compare",this.version,this.options,e),!(e instanceof pn)){if(typeof e=="string"&&e===this.version)return 0;e=new pn(e,this.options)}return e.version===this.version?0:this.compareMain(e)||this.comparePre(e)}compareMain(e){return e instanceof pn||(e=new pn(e,this.options)),ks(this.major,e.major)||ks(this.minor,e.minor)||ks(this.patch,e.patch)}comparePre(e){if(e instanceof pn||(e=new pn(e,this.options)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;let t=0;do{let r=this.prerelease[t],i=e.prerelease[t];if(ia("prerelease compare",t,r,i),r===void 0&&i===void 0)return 0;if(i===void 0)return 1;if(r===void 0)return-1;if(r===i)continue;return ks(r,i)}while(++t)}compareBuild(e){e instanceof pn||(e=new pn(e,this.options));let t=0;do{let r=this.build[t],i=e.build[t];if(ia("prerelease compare",t,r,i),r===void 0&&i===void 0)return 0;if(i===void 0)return 1;if(r===void 0)return-1;if(r===i)continue;return ks(r,i)}while(++t)}inc(e,t){switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",t);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",t);break;case"prepatch":this.prerelease.length=0,this.inc("patch",t),this.inc("pre",t);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",t),this.inc("pre",t);break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":if(this.prerelease.length===0)this.prerelease=[0];else{let r=this.prerelease.length;for(;--r>=0;)typeof this.prerelease[r]=="number"&&(this.prerelease[r]++,r=-2);r===-1&&this.prerelease.push(0)}t&&(this.prerelease[0]===t?isNaN(this.prerelease[1])&&(this.prerelease=[t,0]):this.prerelease=[t,0]);break;default:throw new Error(`invalid increment argument: ${e}`)}return this.format(),this.raw=this.version,this}};Nf.exports=pn});var ei=F((EI,Mf)=>{var{MAX_LENGTH:pD}=Ss(),{re:Of,t:Lf}=Zr(),Af=qt(),gD=Ps(),mD=(n,e)=>{if(e=gD(e),n instanceof Af)return n;if(typeof n!="string"||n.length>pD||!(e.loose?Of[Lf.LOOSE]:Of[Lf.FULL]).test(n))return null;try{return new Af(n,e)}catch{return null}};Mf.exports=mD});var jf=F((xI,$f)=>{var vD=ei(),yD=(n,e)=>{let t=vD(n,e);return t?t.version:null};$f.exports=yD});var Hf=F((qI,Wf)=>{var wD=ei(),CD=(n,e)=>{let t=wD(n.trim().replace(/^[=v]+/,""),e);return t?t.version:null};Wf.exports=CD});var Kf=F((II,Uf)=>{var bD=qt(),DD=(n,e,t,r)=>{typeof t=="string"&&(r=t,t=void 0);try{return new bD(n,t).inc(e,r).version}catch{return null}};Uf.exports=DD});var gn=F((FI,Vf)=>{var zf=qt(),TD=(n,e,t)=>new zf(n,t).compare(new zf(e,t));Vf.exports=TD});var oa=F((NI,Xf)=>{var RD=gn(),SD=(n,e,t)=>RD(n,e,t)===0;Xf.exports=SD});var Qf=F((OI,Gf)=>{var Bf=ei(),_D=oa(),PD=(n,e)=>{if(_D(n,e))return null;{let t=Bf(n),r=Bf(e),i=t.prerelease.length||r.prerelease.length,s=i?"pre":"",o=i?"prerelease":"";for(let a in t)if((a==="major"||a==="minor"||a==="patch")&&t[a]!==r[a])return s+a;return o}};Gf.exports=PD});var Jf=F((LI,Yf)=>{var kD=qt(),ED=(n,e)=>new kD(n,e).major;Yf.exports=ED});var eh=F((AI,Zf)=>{var xD=qt(),qD=(n,e)=>new xD(n,e).minor;Zf.exports=qD});var nh=F((MI,th)=>{var ID=qt(),FD=(n,e)=>new ID(n,e).patch;th.exports=FD});var ih=F(($I,rh)=>{var ND=ei(),OD=(n,e)=>{let t=ND(n,e);return t&&t.prerelease.length?t.prerelease:null};rh.exports=OD});var oh=F((jI,sh)=>{var LD=gn(),AD=(n,e,t)=>LD(e,n,t);sh.exports=AD});var ch=F((WI,ah)=>{var MD=gn(),$D=(n,e)=>MD(n,e,!0);ah.exports=$D});var aa=F((HI,lh)=>{var uh=qt(),jD=(n,e,t)=>{let r=new uh(n,t),i=new uh(e,t);return r.compare(i)||r.compareBuild(i)};lh.exports=jD});var fh=F((UI,dh)=>{var WD=aa(),HD=(n,e)=>n.sort((t,r)=>WD(t,r,e));dh.exports=HD});var ph=F((KI,hh)=>{var UD=aa(),KD=(n,e)=>n.sort((t,r)=>UD(r,t,e));hh.exports=KD});var Es=F((zI,gh)=>{var zD=gn(),VD=(n,e,t)=>zD(n,e,t)>0;gh.exports=VD});var ca=F((VI,mh)=>{var XD=gn(),BD=(n,e,t)=>XD(n,e,t)<0;mh.exports=BD});var Jc=F((XI,vh)=>{var GD=gn(),QD=(n,e,t)=>GD(n,e,t)!==0;vh.exports=QD});var ua=F((BI,yh)=>{var YD=gn(),JD=(n,e,t)=>YD(n,e,t)>=0;yh.exports=JD});var la=F((GI,wh)=>{var ZD=gn(),eT=(n,e,t)=>ZD(n,e,t)<=0;wh.exports=eT});var Zc=F((QI,Ch)=>{var tT=oa(),nT=Jc(),rT=Es(),iT=ua(),sT=ca(),oT=la(),aT=(n,e,t,r)=>{switch(e){case"===":return typeof n=="object"&&(n=n.version),typeof t=="object"&&(t=t.version),n===t;case"!==":return typeof n=="object"&&(n=n.version),typeof t=="object"&&(t=t.version),n!==t;case"":case"=":case"==":return tT(n,t,r);case"!=":return nT(n,t,r);case">":return rT(n,t,r);case">=":return iT(n,t,r);case"<":return sT(n,t,r);case"<=":return oT(n,t,r);default:throw new TypeError(`Invalid operator: ${e}`)}};Ch.exports=aT});var Dh=F((YI,bh)=>{var cT=qt(),uT=ei(),{re:da,t:fa}=Zr(),lT=(n,e)=>{if(n instanceof cT)return n;if(typeof n=="number"&&(n=String(n)),typeof n!="string")return null;e=e||{};let t=null;if(!e.rtl)t=n.match(da[fa.COERCE]);else{let r;for(;(r=da[fa.COERCERTL].exec(n))&&(!t||t.index+t[0].length!==n.length);)(!t||r.index+r[0].length!==t.index+t[0].length)&&(t=r),da[fa.COERCERTL].lastIndex=r.index+r[1].length+r[2].length;da[fa.COERCERTL].lastIndex=-1}return t===null?null:uT(`${t[2]}.${t[3]||"0"}.${t[4]||"0"}`,e)};bh.exports=lT});var Rh=F((JI,Th)=>{"use strict";Th.exports=function(n){n.prototype[Symbol.iterator]=function*(){for(let e=this.head;e;e=e.next)yield e.value}}});var _h=F((ZI,Sh)=>{"use strict";Sh.exports=Pe;Pe.Node=ti;Pe.create=Pe;function Pe(n){var e=this;if(e instanceof Pe||(e=new Pe),e.tail=null,e.head=null,e.length=0,n&&typeof n.forEach=="function")n.forEach(function(i){e.push(i)});else if(arguments.length>0)for(var t=0,r=arguments.length;t<r;t++)e.push(arguments[t]);return e}Pe.prototype.removeNode=function(n){if(n.list!==this)throw new Error("removing node which does not belong to this list");var e=n.next,t=n.prev;return e&&(e.prev=t),t&&(t.next=e),n===this.head&&(this.head=e),n===this.tail&&(this.tail=t),n.list.length--,n.next=null,n.prev=null,n.list=null,e};Pe.prototype.unshiftNode=function(n){if(n!==this.head){n.list&&n.list.removeNode(n);var e=this.head;n.list=this,n.next=e,e&&(e.prev=n),this.head=n,this.tail||(this.tail=n),this.length++}};Pe.prototype.pushNode=function(n){if(n!==this.tail){n.list&&n.list.removeNode(n);var e=this.tail;n.list=this,n.prev=e,e&&(e.next=n),this.tail=n,this.head||(this.head=n),this.length++}};Pe.prototype.push=function(){for(var n=0,e=arguments.length;n<e;n++)fT(this,arguments[n]);return this.length};Pe.prototype.unshift=function(){for(var n=0,e=arguments.length;n<e;n++)hT(this,arguments[n]);return this.length};Pe.prototype.pop=function(){if(!!this.tail){var n=this.tail.value;return this.tail=this.tail.prev,this.tail?this.tail.next=null:this.head=null,this.length--,n}};Pe.prototype.shift=function(){if(!!this.head){var n=this.head.value;return this.head=this.head.next,this.head?this.head.prev=null:this.tail=null,this.length--,n}};Pe.prototype.forEach=function(n,e){e=e||this;for(var t=this.head,r=0;t!==null;r++)n.call(e,t.value,r,this),t=t.next};Pe.prototype.forEachReverse=function(n,e){e=e||this;for(var t=this.tail,r=this.length-1;t!==null;r--)n.call(e,t.value,r,this),t=t.prev};Pe.prototype.get=function(n){for(var e=0,t=this.head;t!==null&&e<n;e++)t=t.next;if(e===n&&t!==null)return t.value};Pe.prototype.getReverse=function(n){for(var e=0,t=this.tail;t!==null&&e<n;e++)t=t.prev;if(e===n&&t!==null)return t.value};Pe.prototype.map=function(n,e){e=e||this;for(var t=new Pe,r=this.head;r!==null;)t.push(n.call(e,r.value,this)),r=r.next;return t};Pe.prototype.mapReverse=function(n,e){e=e||this;for(var t=new Pe,r=this.tail;r!==null;)t.push(n.call(e,r.value,this)),r=r.prev;return t};Pe.prototype.reduce=function(n,e){var t,r=this.head;if(arguments.length>1)t=e;else if(this.head)r=this.head.next,t=this.head.value;else throw new TypeError("Reduce of empty list with no initial value");for(var i=0;r!==null;i++)t=n(t,r.value,i),r=r.next;return t};Pe.prototype.reduceReverse=function(n,e){var t,r=this.tail;if(arguments.length>1)t=e;else if(this.tail)r=this.tail.prev,t=this.tail.value;else throw new TypeError("Reduce of empty list with no initial value");for(var i=this.length-1;r!==null;i--)t=n(t,r.value,i),r=r.prev;return t};Pe.prototype.toArray=function(){for(var n=new Array(this.length),e=0,t=this.head;t!==null;e++)n[e]=t.value,t=t.next;return n};Pe.prototype.toArrayReverse=function(){for(var n=new Array(this.length),e=0,t=this.tail;t!==null;e++)n[e]=t.value,t=t.prev;return n};Pe.prototype.slice=function(n,e){e=e||this.length,e<0&&(e+=this.length),n=n||0,n<0&&(n+=this.length);var t=new Pe;if(e<n||e<0)return t;n<0&&(n=0),e>this.length&&(e=this.length);for(var r=0,i=this.head;i!==null&&r<n;r++)i=i.next;for(;i!==null&&r<e;r++,i=i.next)t.push(i.value);return t};Pe.prototype.sliceReverse=function(n,e){e=e||this.length,e<0&&(e+=this.length),n=n||0,n<0&&(n+=this.length);var t=new Pe;if(e<n||e<0)return t;n<0&&(n=0),e>this.length&&(e=this.length);for(var r=this.length,i=this.tail;i!==null&&r>e;r--)i=i.prev;for(;i!==null&&r>n;r--,i=i.prev)t.push(i.value);return t};Pe.prototype.splice=function(n,e,...t){n>this.length&&(n=this.length-1),n<0&&(n=this.length+n);for(var r=0,i=this.head;i!==null&&r<n;r++)i=i.next;for(var s=[],r=0;i&&r<e;r++)s.push(i.value),i=this.removeNode(i);i===null&&(i=this.tail),i!==this.head&&i!==this.tail&&(i=i.prev);for(var r=0;r<t.length;r++)i=dT(this,i,t[r]);return s};Pe.prototype.reverse=function(){for(var n=this.head,e=this.tail,t=n;t!==null;t=t.prev){var r=t.prev;t.prev=t.next,t.next=r}return this.head=e,this.tail=n,this};function dT(n,e,t){var r=e===n.head?new ti(t,null,e,n):new ti(t,e,e.next,n);return r.next===null&&(n.tail=r),r.prev===null&&(n.head=r),n.length++,r}function fT(n,e){n.tail=new ti(e,n.tail,null,n),n.head||(n.head=n.tail),n.length++}function hT(n,e){n.head=new ti(e,null,n.head,n),n.tail||(n.tail=n.head),n.length++}function ti(n,e,t,r){if(!(this instanceof ti))return new ti(n,e,t,r);this.list=r,this.value=n,e?(e.next=this,this.prev=e):this.prev=null,t?(t.prev=this,this.next=t):this.next=null}try{Rh()(Pe)}catch{}});var Fh=F((eF,Ih)=>{"use strict";var pT=_h(),ni=Symbol("max"),lr=Symbol("length"),Ni=Symbol("lengthCalculator"),xs=Symbol("allowStale"),ri=Symbol("maxAge"),dr=Symbol("dispose"),Ph=Symbol("noDisposeOnSet"),Ct=Symbol("lruList"),In=Symbol("cache"),kh=Symbol("updateAgeOnGet"),eu=()=>1,Eh=class{constructor(e){if(typeof e=="number"&&(e={max:e}),e||(e={}),e.max&&(typeof e.max!="number"||e.max<0))throw new TypeError("max must be a non-negative number");let t=this[ni]=e.max||1/0,r=e.length||eu;if(this[Ni]=typeof r!="function"?eu:r,this[xs]=e.stale||!1,e.maxAge&&typeof e.maxAge!="number")throw new TypeError("maxAge must be a number");this[ri]=e.maxAge||0,this[dr]=e.dispose,this[Ph]=e.noDisposeOnSet||!1,this[kh]=e.updateAgeOnGet||!1,this.reset()}set max(e){if(typeof e!="number"||e<0)throw new TypeError("max must be a non-negative number");this[ni]=e||1/0,qs(this)}get max(){return this[ni]}set allowStale(e){this[xs]=!!e}get allowStale(){return this[xs]}set maxAge(e){if(typeof e!="number")throw new TypeError("maxAge must be a non-negative number");this[ri]=e,qs(this)}get maxAge(){return this[ri]}set lengthCalculator(e){typeof e!="function"&&(e=eu),e!==this[Ni]&&(this[Ni]=e,this[lr]=0,this[Ct].forEach(t=>{t.length=this[Ni](t.value,t.key),this[lr]+=t.length})),qs(this)}get lengthCalculator(){return this[Ni]}get length(){return this[lr]}get itemCount(){return this[Ct].length}rforEach(e,t){t=t||this;for(let r=this[Ct].tail;r!==null;){let i=r.prev;qh(this,e,r,t),r=i}}forEach(e,t){t=t||this;for(let r=this[Ct].head;r!==null;){let i=r.next;qh(this,e,r,t),r=i}}keys(){return this[Ct].toArray().map(e=>e.key)}values(){return this[Ct].toArray().map(e=>e.value)}reset(){this[dr]&&this[Ct]&&this[Ct].length&&this[Ct].forEach(e=>this[dr](e.key,e.value)),this[In]=new Map,this[Ct]=new pT,this[lr]=0}dump(){return this[Ct].map(e=>ha(this,e)?!1:{k:e.key,v:e.value,e:e.now+(e.maxAge||0)}).toArray().filter(e=>e)}dumpLru(){return this[Ct]}set(e,t,r){if(r=r||this[ri],r&&typeof r!="number")throw new TypeError("maxAge must be a number");let i=r?Date.now():0,s=this[Ni](t,e);if(this[In].has(e)){if(s>this[ni])return Oi(this,this[In].get(e)),!1;let c=this[In].get(e).value;return this[dr]&&(this[Ph]||this[dr](e,c.value)),c.now=i,c.maxAge=r,c.value=t,this[lr]+=s-c.length,c.length=s,this.get(e),qs(this),!0}let o=new xh(e,t,s,i,r);return o.length>this[ni]?(this[dr]&&this[dr](e,t),!1):(this[lr]+=o.length,this[Ct].unshift(o),this[In].set(e,this[Ct].head),qs(this),!0)}has(e){if(!this[In].has(e))return!1;let t=this[In].get(e).value;return!ha(this,t)}get(e){return tu(this,e,!0)}peek(e){return tu(this,e,!1)}pop(){let e=this[Ct].tail;return e?(Oi(this,e),e.value):null}del(e){Oi(this,this[In].get(e))}load(e){this.reset();let t=Date.now();for(let r=e.length-1;r>=0;r--){let i=e[r],s=i.e||0;if(s===0)this.set(i.k,i.v);else{let o=s-t;o>0&&this.set(i.k,i.v,o)}}}prune(){this[In].forEach((e,t)=>tu(this,t,!1))}},tu=(n,e,t)=>{let r=n[In].get(e);if(r){let i=r.value;if(ha(n,i)){if(Oi(n,r),!n[xs])return}else t&&(n[kh]&&(r.value.now=Date.now()),n[Ct].unshiftNode(r));return i.value}},ha=(n,e)=>{if(!e||!e.maxAge&&!n[ri])return!1;let t=Date.now()-e.now;return e.maxAge?t>e.maxAge:n[ri]&&t>n[ri]},qs=n=>{if(n[lr]>n[ni])for(let e=n[Ct].tail;n[lr]>n[ni]&&e!==null;){let t=e.prev;Oi(n,e),e=t}},Oi=(n,e)=>{if(e){let t=e.value;n[dr]&&n[dr](t.key,t.value),n[lr]-=t.length,n[In].delete(t.key),n[Ct].removeNode(e)}},xh=class{constructor(e,t,r,i,s){this.key=e,this.value=t,this.length=r,this.now=i,this.maxAge=s||0}},qh=(n,e,t,r)=>{let i=t.value;ha(n,i)&&(Oi(n,t),n[xs]||(i=void 0)),i&&e.call(r,i.value,i.key,n)};Ih.exports=Eh});var mn=F((tF,Ah)=>{var Li=class{constructor(e,t){if(t=mT(t),e instanceof Li)return e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease?e:new Li(e.raw,t);if(e instanceof nu)return this.raw=e.value,this.set=[[e]],this.format(),this;if(this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease,this.raw=e,this.set=e.split(/\s*\|\|\s*/).map(r=>this.parseRange(r.trim())).filter(r=>r.length),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${e}`);if(this.set.length>1){let r=this.set[0];if(this.set=this.set.filter(i=>!Oh(i[0])),this.set.length===0)this.set=[r];else if(this.set.length>1){for(let i of this.set)if(i.length===1&&bT(i[0])){this.set=[i];break}}}this.format()}format(){return this.range=this.set.map(e=>e.join(" ").trim()).join("||").trim(),this.range}toString(){return this.range}parseRange(e){e=e.trim();let r=`parseRange:${Object.keys(this.options).join(",")}:${e}`,i=Nh.get(r);if(i)return i;let s=this.options.loose,o=s?It[_t.HYPHENRANGELOOSE]:It[_t.HYPHENRANGE];e=e.replace(o,qT(this.options.includePrerelease)),at("hyphen replace",e),e=e.replace(It[_t.COMPARATORTRIM],yT),at("comparator trim",e,It[_t.COMPARATORTRIM]),e=e.replace(It[_t.TILDETRIM],wT),e=e.replace(It[_t.CARETTRIM],CT),e=e.split(/\s+/).join(" ");let a=s?It[_t.COMPARATORLOOSE]:It[_t.COMPARATOR],c=e.split(" ").map(p=>DT(p,this.options)).join(" ").split(/\s+/).map(p=>xT(p,this.options)).filter(this.options.loose?p=>!!p.match(a):()=>!0).map(p=>new nu(p,this.options)),u=c.length,l=new Map;for(let p of c){if(Oh(p))return[p];l.set(p.value,p)}l.size>1&&l.has("")&&l.delete("");let h=[...l.values()];return Nh.set(r,h),h}intersects(e,t){if(!(e instanceof Li))throw new TypeError("a Range is required");return this.set.some(r=>Lh(r,t)&&e.set.some(i=>Lh(i,t)&&r.every(s=>i.every(o=>s.intersects(o,t)))))}test(e){if(!e)return!1;if(typeof e=="string")try{e=new vT(e,this.options)}catch{return!1}for(let t=0;t<this.set.length;t++)if(IT(this.set[t],e,this.options))return!0;return!1}};Ah.exports=Li;var gT=Fh(),Nh=new gT({max:1e3}),mT=Ps(),nu=Is(),at=_s(),vT=qt(),{re:It,t:_t,comparatorTrimReplace:yT,tildeTrimReplace:wT,caretTrimReplace:CT}=Zr(),Oh=n=>n.value==="<0.0.0-0",bT=n=>n.value==="",Lh=(n,e)=>{let t=!0,r=n.slice(),i=r.pop();for(;t&&r.length;)t=r.every(s=>i.intersects(s,e)),i=r.pop();return t},DT=(n,e)=>(at("comp",n,e),n=ST(n,e),at("caret",n),n=TT(n,e),at("tildes",n),n=PT(n,e),at("xrange",n),n=ET(n,e),at("stars",n),n),jt=n=>!n||n.toLowerCase()==="x"||n==="*",TT=(n,e)=>n.trim().split(/\s+/).map(t=>RT(t,e)).join(" "),RT=(n,e)=>{let t=e.loose?It[_t.TILDELOOSE]:It[_t.TILDE];return n.replace(t,(r,i,s,o,a)=>{at("tilde",n,r,i,s,o,a);let c;return jt(i)?c="":jt(s)?c=`>=${i}.0.0 <${+i+1}.0.0-0`:jt(o)?c=`>=${i}.${s}.0 <${i}.${+s+1}.0-0`:a?(at("replaceTilde pr",a),c=`>=${i}.${s}.${o}-${a} <${i}.${+s+1}.0-0`):c=`>=${i}.${s}.${o} <${i}.${+s+1}.0-0`,at("tilde return",c),c})},ST=(n,e)=>n.trim().split(/\s+/).map(t=>_T(t,e)).join(" "),_T=(n,e)=>{at("caret",n,e);let t=e.loose?It[_t.CARETLOOSE]:It[_t.CARET],r=e.includePrerelease?"-0":"";return n.replace(t,(i,s,o,a,c)=>{at("caret",n,i,s,o,a,c);let u;return jt(s)?u="":jt(o)?u=`>=${s}.0.0${r} <${+s+1}.0.0-0`:jt(a)?s==="0"?u=`>=${s}.${o}.0${r} <${s}.${+o+1}.0-0`:u=`>=${s}.${o}.0${r} <${+s+1}.0.0-0`:c?(at("replaceCaret pr",c),s==="0"?o==="0"?u=`>=${s}.${o}.${a}-${c} <${s}.${o}.${+a+1}-0`:u=`>=${s}.${o}.${a}-${c} <${s}.${+o+1}.0-0`:u=`>=${s}.${o}.${a}-${c} <${+s+1}.0.0-0`):(at("no pr"),s==="0"?o==="0"?u=`>=${s}.${o}.${a}${r} <${s}.${o}.${+a+1}-0`:u=`>=${s}.${o}.${a}${r} <${s}.${+o+1}.0-0`:u=`>=${s}.${o}.${a} <${+s+1}.0.0-0`),at("caret return",u),u})},PT=(n,e)=>(at("replaceXRanges",n,e),n.split(/\s+/).map(t=>kT(t,e)).join(" ")),kT=(n,e)=>{n=n.trim();let t=e.loose?It[_t.XRANGELOOSE]:It[_t.XRANGE];return n.replace(t,(r,i,s,o,a,c)=>{at("xRange",n,r,i,s,o,a,c);let u=jt(s),l=u||jt(o),h=l||jt(a),p=h;return i==="="&&p&&(i=""),c=e.includePrerelease?"-0":"",u?i===">"||i==="<"?r="<0.0.0-0":r="*":i&&p?(l&&(o=0),a=0,i===">"?(i=">=",l?(s=+s+1,o=0,a=0):(o=+o+1,a=0)):i==="<="&&(i="<",l?s=+s+1:o=+o+1),i==="<"&&(c="-0"),r=`${i+s}.${o}.${a}${c}`):l?r=`>=${s}.0.0${c} <${+s+1}.0.0-0`:h&&(r=`>=${s}.${o}.0${c} <${s}.${+o+1}.0-0`),at("xRange return",r),r})},ET=(n,e)=>(at("replaceStars",n,e),n.trim().replace(It[_t.STAR],"")),xT=(n,e)=>(at("replaceGTE0",n,e),n.trim().replace(It[e.includePrerelease?_t.GTE0PRE:_t.GTE0],"")),qT=n=>(e,t,r,i,s,o,a,c,u,l,h,p,C)=>(jt(r)?t="":jt(i)?t=`>=${r}.0.0${n?"-0":""}`:jt(s)?t=`>=${r}.${i}.0${n?"-0":""}`:o?t=`>=${t}`:t=`>=${t}${n?"-0":""}`,jt(u)?c="":jt(l)?c=`<${+u+1}.0.0-0`:jt(h)?c=`<${u}.${+l+1}.0-0`:p?c=`<=${u}.${l}.${h}-${p}`:n?c=`<${u}.${l}.${+h+1}-0`:c=`<=${c}`,`${t} ${c}`.trim()),IT=(n,e,t)=>{for(let r=0;r<n.length;r++)if(!n[r].test(e))return!1;if(e.prerelease.length&&!t.includePrerelease){for(let r=0;r<n.length;r++)if(at(n[r].semver),n[r].semver!==nu.ANY&&n[r].semver.prerelease.length>0){let i=n[r].semver;if(i.major===e.major&&i.minor===e.minor&&i.patch===e.patch)return!0}return!1}return!0}});var Is=F((nF,Hh)=>{var Fs=Symbol("SemVer ANY"),Ns=class{static get ANY(){return Fs}constructor(e,t){if(t=FT(t),e instanceof Ns){if(e.loose===!!t.loose)return e;e=e.value}iu("comparator",e,t),this.options=t,this.loose=!!t.loose,this.parse(e),this.semver===Fs?this.value="":this.value=this.operator+this.semver.version,iu("comp",this)}parse(e){let t=this.options.loose?Mh[$h.COMPARATORLOOSE]:Mh[$h.COMPARATOR],r=e.match(t);if(!r)throw new TypeError(`Invalid comparator: ${e}`);this.operator=r[1]!==void 0?r[1]:"",this.operator==="="&&(this.operator=""),r[2]?this.semver=new jh(r[2],this.options.loose):this.semver=Fs}toString(){return this.value}test(e){if(iu("Comparator.test",e,this.options.loose),this.semver===Fs||e===Fs)return!0;if(typeof e=="string")try{e=new jh(e,this.options)}catch{return!1}return ru(e,this.operator,this.semver,this.options)}intersects(e,t){if(!(e instanceof Ns))throw new TypeError("a Comparator is required");if((!t||typeof t!="object")&&(t={loose:!!t,includePrerelease:!1}),this.operator==="")return this.value===""?!0:new Wh(e.value,t).test(this.value);if(e.operator==="")return e.value===""?!0:new Wh(this.value,t).test(e.semver);let r=(this.operator===">="||this.operator===">")&&(e.operator===">="||e.operator===">"),i=(this.operator==="<="||this.operator==="<")&&(e.operator==="<="||e.operator==="<"),s=this.semver.version===e.semver.version,o=(this.operator===">="||this.operator==="<=")&&(e.operator===">="||e.operator==="<="),a=ru(this.semver,"<",e.semver,t)&&(this.operator===">="||this.operator===">")&&(e.operator==="<="||e.operator==="<"),c=ru(this.semver,">",e.semver,t)&&(this.operator==="<="||this.operator==="<")&&(e.operator===">="||e.operator===">");return r||i||s&&o||a||c}};Hh.exports=Ns;var FT=Ps(),{re:Mh,t:$h}=Zr(),ru=Zc(),iu=_s(),jh=qt(),Wh=mn()});var Os=F((rF,Uh)=>{var NT=mn(),OT=(n,e,t)=>{try{e=new NT(e,t)}catch{return!1}return e.test(n)};Uh.exports=OT});var zh=F((iF,Kh)=>{var LT=mn(),AT=(n,e)=>new LT(n,e).set.map(t=>t.map(r=>r.value).join(" ").trim().split(" "));Kh.exports=AT});var Xh=F((sF,Vh)=>{var MT=qt(),$T=mn(),jT=(n,e,t)=>{let r=null,i=null,s=null;try{s=new $T(e,t)}catch{return null}return n.forEach(o=>{s.test(o)&&(!r||i.compare(o)===-1)&&(r=o,i=new MT(r,t))}),r};Vh.exports=jT});var Gh=F((oF,Bh)=>{var WT=qt(),HT=mn(),UT=(n,e,t)=>{let r=null,i=null,s=null;try{s=new HT(e,t)}catch{return null}return n.forEach(o=>{s.test(o)&&(!r||i.compare(o)===1)&&(r=o,i=new WT(r,t))}),r};Bh.exports=UT});var Jh=F((aF,Yh)=>{var su=qt(),KT=mn(),Qh=Es(),zT=(n,e)=>{n=new KT(n,e);let t=new su("0.0.0");if(n.test(t)||(t=new su("0.0.0-0"),n.test(t)))return t;t=null;for(let r=0;r<n.set.length;++r){let i=n.set[r],s=null;i.forEach(o=>{let a=new su(o.semver.version);switch(o.operator){case">":a.prerelease.length===0?a.patch++:a.prerelease.push(0),a.raw=a.format();case"":case">=":(!s||Qh(a,s))&&(s=a);break;case"<":case"<=":break;default:throw new Error(`Unexpected operation: ${o.operator}`)}}),s&&(!t||Qh(t,s))&&(t=s)}return t&&n.test(t)?t:null};Yh.exports=zT});var ep=F((cF,Zh)=>{var VT=mn(),XT=(n,e)=>{try{return new VT(n,e).range||"*"}catch{return null}};Zh.exports=XT});var pa=F((uF,ip)=>{var BT=qt(),tp=Is(),{ANY:GT}=tp,QT=mn(),YT=Os(),np=Es(),rp=ca(),JT=la(),ZT=ua(),eR=(n,e,t,r)=>{n=new BT(n,r),e=new QT(e,r);let i,s,o,a,c;switch(t){case">":i=np,s=JT,o=rp,a=">",c=">=";break;case"<":i=rp,s=ZT,o=np,a="<",c="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(YT(n,e,r))return!1;for(let u=0;u<e.set.length;++u){let l=e.set[u],h=null,p=null;if(l.forEach(C=>{C.semver===GT&&(C=new tp(">=0.0.0")),h=h||C,p=p||C,i(C.semver,h.semver,r)?h=C:o(C.semver,p.semver,r)&&(p=C)}),h.operator===a||h.operator===c||(!p.operator||p.operator===a)&&s(n,p.semver))return!1;if(p.operator===c&&o(n,p.semver))return!1}return!0};ip.exports=eR});var op=F((lF,sp)=>{var tR=pa(),nR=(n,e,t)=>tR(n,e,">",t);sp.exports=nR});var cp=F((dF,ap)=>{var rR=pa(),iR=(n,e,t)=>rR(n,e,"<",t);ap.exports=iR});var dp=F((fF,lp)=>{var up=mn(),sR=(n,e,t)=>(n=new up(n,t),e=new up(e,t),n.intersects(e));lp.exports=sR});var hp=F((hF,fp)=>{var oR=Os(),aR=gn();fp.exports=(n,e,t)=>{let r=[],i=null,s=null,o=n.sort((l,h)=>aR(l,h,t));for(let l of o)oR(l,e,t)?(s=l,i||(i=l)):(s&&r.push([i,s]),s=null,i=null);i&&r.push([i,null]);let a=[];for(let[l,h]of r)l===h?a.push(l):!h&&l===o[0]?a.push("*"):h?l===o[0]?a.push(`<=${h}`):a.push(`${l} - ${h}`):a.push(`>=${l}`);let c=a.join(" || "),u=typeof e.raw=="string"?e.raw:String(e);return c.length<u.length?c:e}});var yp=F((pF,vp)=>{var pp=mn(),ga=Is(),{ANY:ou}=ga,Ls=Os(),au=gn(),cR=(n,e,t={})=>{if(n===e)return!0;n=new pp(n,t),e=new pp(e,t);let r=!1;e:for(let i of n.set){for(let s of e.set){let o=uR(i,s,t);if(r=r||o!==null,o)continue e}if(r)return!1}return!0},uR=(n,e,t)=>{if(n===e)return!0;if(n.length===1&&n[0].semver===ou){if(e.length===1&&e[0].semver===ou)return!0;t.includePrerelease?n=[new ga(">=0.0.0-0")]:n=[new ga(">=0.0.0")]}if(e.length===1&&e[0].semver===ou){if(t.includePrerelease)return!0;e=[new ga(">=0.0.0")]}let r=new Set,i,s;for(let C of n)C.operator===">"||C.operator===">="?i=gp(i,C,t):C.operator==="<"||C.operator==="<="?s=mp(s,C,t):r.add(C.semver);if(r.size>1)return null;let o;if(i&&s){if(o=au(i.semver,s.semver,t),o>0)return null;if(o===0&&(i.operator!==">="||s.operator!=="<="))return null}for(let C of r){if(i&&!Ls(C,String(i),t)||s&&!Ls(C,String(s),t))return null;for(let T of e)if(!Ls(C,String(T),t))return!1;return!0}let a,c,u,l,h=s&&!t.includePrerelease&&s.semver.prerelease.length?s.semver:!1,p=i&&!t.includePrerelease&&i.semver.prerelease.length?i.semver:!1;h&&h.prerelease.length===1&&s.operator==="<"&&h.prerelease[0]===0&&(h=!1);for(let C of e){if(l=l||C.operator===">"||C.operator===">=",u=u||C.operator==="<"||C.operator==="<=",i){if(p&&C.semver.prerelease&&C.semver.prerelease.length&&C.semver.major===p.major&&C.semver.minor===p.minor&&C.semver.patch===p.patch&&(p=!1),C.operator===">"||C.operator===">="){if(a=gp(i,C,t),a===C&&a!==i)return!1}else if(i.operator===">="&&!Ls(i.semver,String(C),t))return!1}if(s){if(h&&C.semver.prerelease&&C.semver.prerelease.length&&C.semver.major===h.major&&C.semver.minor===h.minor&&C.semver.patch===h.patch&&(h=!1),C.operator==="<"||C.operator==="<="){if(c=mp(s,C,t),c===C&&c!==s)return!1}else if(s.operator==="<="&&!Ls(s.semver,String(C),t))return!1}if(!C.operator&&(s||i)&&o!==0)return!1}return!(i&&u&&!s&&o!==0||s&&l&&!i&&o!==0||p||h)},gp=(n,e,t)=>{if(!n)return e;let r=au(n.semver,e.semver,t);return r>0?n:r<0||e.operator===">"&&n.operator===">="?e:n},mp=(n,e,t)=>{if(!n)return e;let r=au(n.semver,e.semver,t);return r<0?n:r>0||e.operator==="<"&&n.operator==="<="?e:n};vp.exports=cR});var Cp=F((gF,wp)=>{var cu=Zr();wp.exports={re:cu.re,src:cu.src,tokens:cu.t,SEMVER_SPEC_VERSION:Ss().SEMVER_SPEC_VERSION,SemVer:qt(),compareIdentifiers:ra().compareIdentifiers,rcompareIdentifiers:ra().rcompareIdentifiers,parse:ei(),valid:jf(),clean:Hf(),inc:Kf(),diff:Qf(),major:Jf(),minor:eh(),patch:nh(),prerelease:ih(),compare:gn(),rcompare:oh(),compareLoose:ch(),compareBuild:aa(),sort:fh(),rsort:ph(),gt:Es(),lt:ca(),eq:oa(),neq:Jc(),gte:ua(),lte:la(),cmp:Zc(),coerce:Dh(),Comparator:Is(),Range:mn(),satisfies:Os(),toComparators:zh(),maxSatisfying:Xh(),minSatisfying:Gh(),minVersion:Jh(),validRange:ep(),outside:pa(),gtr:op(),ltr:cp(),intersects:dp(),simplifyRange:hp(),subset:yp()}});var vn=F(rt=>{"use strict";Object.defineProperty(rt,"__esModule",{value:!0});rt.asPromise=rt.thenable=rt.typedArray=rt.stringArray=rt.array=rt.func=rt.error=rt.number=rt.string=rt.boolean=void 0;function lR(n){return n===!0||n===!1}rt.boolean=lR;function bp(n){return typeof n=="string"||n instanceof String}rt.string=bp;function dR(n){return typeof n=="number"||n instanceof Number}rt.number=dR;function fR(n){return n instanceof Error}rt.error=fR;function Dp(n){return typeof n=="function"}rt.func=Dp;function Tp(n){return Array.isArray(n)}rt.array=Tp;function hR(n){return Tp(n)&&n.every(e=>bp(e))}rt.stringArray=hR;function pR(n,e){return Array.isArray(n)&&n.every(e)}rt.typedArray=pR;function Rp(n){return n&&Dp(n.then)}rt.thenable=Rp;function gR(n){return n instanceof Promise?n:Rp(n)?new Promise((e,t)=>{n.then(r=>e(r),r=>t(r))}):Promise.resolve(n)}rt.asPromise=gR});var fr=F(du=>{"use strict";Object.defineProperty(du,"__esModule",{value:!0});var uu;function lu(){if(uu===void 0)throw new Error("No runtime abstraction layer installed");return uu}(function(n){function e(t){if(t===void 0)throw new Error("No runtime abstraction layer provided");uu=t}n.install=e})(lu||(lu={}));du.default=lu});var fu=F(As=>{"use strict";Object.defineProperty(As,"__esModule",{value:!0});As.Disposable=void 0;var mR;(function(n){function e(t){return{dispose:t}}n.create=e})(mR=As.Disposable||(As.Disposable={}))});var _p=F(ma=>{"use strict";Object.defineProperty(ma,"__esModule",{value:!0});ma.AbstractMessageBuffer=void 0;var vR=13,yR=10,wR=`\r
`,Sp=class{constructor(e="utf-8"){this._encoding=e,this._chunks=[],this._totalLength=0}get encoding(){return this._encoding}append(e){let t=typeof e=="string"?this.fromString(e,this._encoding):e;this._chunks.push(t),this._totalLength+=t.byteLength}tryReadHeaders(){if(this._chunks.length===0)return;let e=0,t=0,r=0,i=0;e:for(;t<this._chunks.length;){let c=this._chunks[t];r=0;t:for(;r<c.length;){switch(c[r]){case vR:switch(e){case 0:e=1;break;case 2:e=3;break;default:e=0}break;case yR:switch(e){case 1:e=2;break;case 3:e=4,r++;break e;default:e=0}break;default:e=0}r++}i+=c.byteLength,t++}if(e!==4)return;let s=this._read(i+r),o=new Map,a=this.toString(s,"ascii").split(wR);if(a.length<2)return o;for(let c=0;c<a.length-2;c++){let u=a[c],l=u.indexOf(":");if(l===-1)throw new Error("Message header must separate key and value using :");let h=u.substr(0,l),p=u.substr(l+1).trim();o.set(h,p)}return o}tryReadBody(e){if(!(this._totalLength<e))return this._read(e)}get numberOfBytes(){return this._totalLength}_read(e){if(e===0)return this.emptyBuffer();if(e>this._totalLength)throw new Error("Cannot read so many bytes!");if(this._chunks[0].byteLength===e){let s=this._chunks[0];return this._chunks.shift(),this._totalLength-=e,this.asNative(s)}if(this._chunks[0].byteLength>e){let s=this._chunks[0],o=this.asNative(s,e);return this._chunks[0]=s.slice(e),this._totalLength-=e,o}let t=this.allocNative(e),r=0,i=0;for(;e>0;){let s=this._chunks[i];if(s.byteLength>e){let o=s.slice(0,e);t.set(o,r),r+=e,this._chunks[i]=s.slice(e),this._totalLength-=e,e-=e}else t.set(s,r),r+=s.byteLength,this._chunks.shift(),this._totalLength-=s.byteLength,e-=s.byteLength}return t}};ma.AbstractMessageBuffer=Sp});var qp=F(pu=>{"use strict";Object.defineProperty(pu,"__esModule",{value:!0});var CR=fr(),Pp=require("util"),ii=fu(),bR=_p(),Ms=class extends bR.AbstractMessageBuffer{constructor(e="utf-8"){super(e)}emptyBuffer(){return Ms.emptyBuffer}fromString(e,t){return Buffer.from(e,t)}toString(e,t){return e instanceof Buffer?e.toString(t):new Pp.TextDecoder(t).decode(e)}asNative(e,t){return t===void 0?e instanceof Buffer?e:Buffer.from(e):e instanceof Buffer?e.slice(0,t):Buffer.from(e,0,t)}allocNative(e){return Buffer.allocUnsafe(e)}};Ms.emptyBuffer=Buffer.allocUnsafe(0);var kp=class{constructor(e){this.stream=e}onClose(e){return this.stream.on("close",e),ii.Disposable.create(()=>this.stream.off("close",e))}onError(e){return this.stream.on("error",e),ii.Disposable.create(()=>this.stream.off("error",e))}onEnd(e){return this.stream.on("end",e),ii.Disposable.create(()=>this.stream.off("end",e))}onData(e){return this.stream.on("data",e),ii.Disposable.create(()=>this.stream.off("data",e))}},Ep=class{constructor(e){this.stream=e}onClose(e){return this.stream.on("close",e),ii.Disposable.create(()=>this.stream.off("close",e))}onError(e){return this.stream.on("error",e),ii.Disposable.create(()=>this.stream.off("error",e))}onEnd(e){return this.stream.on("end",e),ii.Disposable.create(()=>this.stream.off("end",e))}write(e,t){return new Promise((r,i)=>{let s=o=>{o==null?r():i(o)};typeof e=="string"?this.stream.write(e,t,s):this.stream.write(e,s)})}end(){this.stream.end()}},xp=Object.freeze({messageBuffer:Object.freeze({create:n=>new Ms(n)}),applicationJson:Object.freeze({encoder:Object.freeze({name:"application/json",encode:(n,e)=>{try{return Promise.resolve(Buffer.from(JSON.stringify(n,void 0,0),e.charset))}catch(t){return Promise.reject(t)}}}),decoder:Object.freeze({name:"application/json",decode:(n,e)=>{try{return n instanceof Buffer?Promise.resolve(JSON.parse(n.toString(e.charset))):Promise.resolve(JSON.parse(new Pp.TextDecoder(e.charset).decode(n)))}catch(t){return Promise.reject(t)}}})}),stream:Object.freeze({asReadableStream:n=>new kp(n),asWritableStream:n=>new Ep(n)}),console,timer:Object.freeze({setTimeout(n,e,...t){let r=setTimeout(n,e,...t);return{dispose:()=>clearTimeout(r)}},setImmediate(n,...e){let t=setImmediate(n,...e);return{dispose:()=>clearImmediate(t)}},setInterval(n,e,...t){let r=setInterval(n,e,...t);return{dispose:()=>clearInterval(r)}}})});function hu(){return xp}(function(n){function e(){CR.default.install(xp)}n.install=e})(hu||(hu={}));pu.default=hu});var Ai=F(Ft=>{"use strict";Object.defineProperty(Ft,"__esModule",{value:!0});Ft.stringArray=Ft.array=Ft.func=Ft.error=Ft.number=Ft.string=Ft.boolean=void 0;function DR(n){return n===!0||n===!1}Ft.boolean=DR;function Ip(n){return typeof n=="string"||n instanceof String}Ft.string=Ip;function TR(n){return typeof n=="number"||n instanceof Number}Ft.number=TR;function RR(n){return n instanceof Error}Ft.error=RR;function SR(n){return typeof n=="function"}Ft.func=SR;function Fp(n){return Array.isArray(n)}Ft.array=Fp;function _R(n){return Fp(n)&&n.every(e=>Ip(e))}Ft.stringArray=_R});var gu=F(J=>{"use strict";Object.defineProperty(J,"__esModule",{value:!0});J.Message=J.NotificationType9=J.NotificationType8=J.NotificationType7=J.NotificationType6=J.NotificationType5=J.NotificationType4=J.NotificationType3=J.NotificationType2=J.NotificationType1=J.NotificationType0=J.NotificationType=J.RequestType9=J.RequestType8=J.RequestType7=J.RequestType6=J.RequestType5=J.RequestType4=J.RequestType3=J.RequestType2=J.RequestType1=J.RequestType=J.RequestType0=J.AbstractMessageSignature=J.ParameterStructures=J.ResponseError=J.ErrorCodes=void 0;var si=Ai(),Np;(function(n){n.ParseError=-32700,n.InvalidRequest=-32600,n.MethodNotFound=-32601,n.InvalidParams=-32602,n.InternalError=-32603,n.jsonrpcReservedErrorRangeStart=-32099,n.serverErrorStart=-32099,n.MessageWriteError=-32099,n.MessageReadError=-32098,n.PendingResponseRejected=-32097,n.ConnectionInactive=-32096,n.ServerNotInitialized=-32002,n.UnknownErrorCode=-32001,n.jsonrpcReservedErrorRangeEnd=-32e3,n.serverErrorEnd=-32e3})(Np=J.ErrorCodes||(J.ErrorCodes={}));var va=class extends Error{constructor(e,t,r){super(t);this.code=si.number(e)?e:Np.UnknownErrorCode,this.data=r,Object.setPrototypeOf(this,va.prototype)}toJson(){let e={code:this.code,message:this.message};return this.data!==void 0&&(e.data=this.data),e}};J.ResponseError=va;var Pt=class{constructor(e){this.kind=e}static is(e){return e===Pt.auto||e===Pt.byName||e===Pt.byPosition}toString(){return this.kind}};J.ParameterStructures=Pt;Pt.auto=new Pt("auto");Pt.byPosition=new Pt("byPosition");Pt.byName=new Pt("byName");var Ge=class{constructor(e,t){this.method=e,this.numberOfParams=t}get parameterStructures(){return Pt.auto}};J.AbstractMessageSignature=Ge;var Op=class extends Ge{constructor(e){super(e,0)}};J.RequestType0=Op;var Lp=class extends Ge{constructor(e,t=Pt.auto){super(e,1);this._parameterStructures=t}get parameterStructures(){return this._parameterStructures}};J.RequestType=Lp;var Ap=class extends Ge{constructor(e,t=Pt.auto){super(e,1);this._parameterStructures=t}get parameterStructures(){return this._parameterStructures}};J.RequestType1=Ap;var Mp=class extends Ge{constructor(e){super(e,2)}};J.RequestType2=Mp;var $p=class extends Ge{constructor(e){super(e,3)}};J.RequestType3=$p;var jp=class extends Ge{constructor(e){super(e,4)}};J.RequestType4=jp;var Wp=class extends Ge{constructor(e){super(e,5)}};J.RequestType5=Wp;var Hp=class extends Ge{constructor(e){super(e,6)}};J.RequestType6=Hp;var Up=class extends Ge{constructor(e){super(e,7)}};J.RequestType7=Up;var Kp=class extends Ge{constructor(e){super(e,8)}};J.RequestType8=Kp;var zp=class extends Ge{constructor(e){super(e,9)}};J.RequestType9=zp;var Vp=class extends Ge{constructor(e,t=Pt.auto){super(e,1);this._parameterStructures=t}get parameterStructures(){return this._parameterStructures}};J.NotificationType=Vp;var Xp=class extends Ge{constructor(e){super(e,0)}};J.NotificationType0=Xp;var Bp=class extends Ge{constructor(e,t=Pt.auto){super(e,1);this._parameterStructures=t}get parameterStructures(){return this._parameterStructures}};J.NotificationType1=Bp;var Gp=class extends Ge{constructor(e){super(e,2)}};J.NotificationType2=Gp;var Qp=class extends Ge{constructor(e){super(e,3)}};J.NotificationType3=Qp;var Yp=class extends Ge{constructor(e){super(e,4)}};J.NotificationType4=Yp;var Jp=class extends Ge{constructor(e){super(e,5)}};J.NotificationType5=Jp;var Zp=class extends Ge{constructor(e){super(e,6)}};J.NotificationType6=Zp;var eg=class extends Ge{constructor(e){super(e,7)}};J.NotificationType7=eg;var tg=class extends Ge{constructor(e){super(e,8)}};J.NotificationType8=tg;var ng=class extends Ge{constructor(e){super(e,9)}};J.NotificationType9=ng;var PR;(function(n){function e(i){let s=i;return s&&si.string(s.method)&&(si.string(s.id)||si.number(s.id))}n.isRequest=e;function t(i){let s=i;return s&&si.string(s.method)&&i.id===void 0}n.isNotification=t;function r(i){let s=i;return s&&(s.result!==void 0||!!s.error)&&(si.string(s.id)||si.number(s.id)||s.id===null)}n.isResponse=r})(PR=J.Message||(J.Message={}))});var vu=F(hr=>{"use strict";var rg;Object.defineProperty(hr,"__esModule",{value:!0});hr.LRUCache=hr.LinkedMap=hr.Touch=void 0;var Wt;(function(n){n.None=0,n.First=1,n.AsOld=n.First,n.Last=2,n.AsNew=n.Last})(Wt=hr.Touch||(hr.Touch={}));var mu=class{constructor(){this[rg]="LinkedMap",this._map=new Map,this._head=void 0,this._tail=void 0,this._size=0,this._state=0}clear(){this._map.clear(),this._head=void 0,this._tail=void 0,this._size=0,this._state++}isEmpty(){return!this._head&&!this._tail}get size(){return this._size}get first(){var e;return(e=this._head)==null?void 0:e.value}get last(){var e;return(e=this._tail)==null?void 0:e.value}has(e){return this._map.has(e)}get(e,t=Wt.None){let r=this._map.get(e);if(!!r)return t!==Wt.None&&this.touch(r,t),r.value}set(e,t,r=Wt.None){let i=this._map.get(e);if(i)i.value=t,r!==Wt.None&&this.touch(i,r);else{switch(i={key:e,value:t,next:void 0,previous:void 0},r){case Wt.None:this.addItemLast(i);break;case Wt.First:this.addItemFirst(i);break;case Wt.Last:this.addItemLast(i);break;default:this.addItemLast(i);break}this._map.set(e,i),this._size++}return this}delete(e){return!!this.remove(e)}remove(e){let t=this._map.get(e);if(!!t)return this._map.delete(e),this.removeItem(t),this._size--,t.value}shift(){if(!this._head&&!this._tail)return;if(!this._head||!this._tail)throw new Error("Invalid list");let e=this._head;return this._map.delete(e.key),this.removeItem(e),this._size--,e.value}forEach(e,t){let r=this._state,i=this._head;for(;i;){if(t?e.bind(t)(i.value,i.key,this):e(i.value,i.key,this),this._state!==r)throw new Error("LinkedMap got modified during iteration.");i=i.next}}keys(){let e=this._state,t=this._head,r={[Symbol.iterator]:()=>r,next:()=>{if(this._state!==e)throw new Error("LinkedMap got modified during iteration.");if(t){let i={value:t.key,done:!1};return t=t.next,i}else return{value:void 0,done:!0}}};return r}values(){let e=this._state,t=this._head,r={[Symbol.iterator]:()=>r,next:()=>{if(this._state!==e)throw new Error("LinkedMap got modified during iteration.");if(t){let i={value:t.value,done:!1};return t=t.next,i}else return{value:void 0,done:!0}}};return r}entries(){let e=this._state,t=this._head,r={[Symbol.iterator]:()=>r,next:()=>{if(this._state!==e)throw new Error("LinkedMap got modified during iteration.");if(t){let i={value:[t.key,t.value],done:!1};return t=t.next,i}else return{value:void 0,done:!0}}};return r}[(rg=Symbol.toStringTag,Symbol.iterator)](){return this.entries()}trimOld(e){if(e>=this.size)return;if(e===0){this.clear();return}let t=this._head,r=this.size;for(;t&&r>e;)this._map.delete(t.key),t=t.next,r--;this._head=t,this._size=r,t&&(t.previous=void 0),this._state++}addItemFirst(e){if(!this._head&&!this._tail)this._tail=e;else if(this._head)e.next=this._head,this._head.previous=e;else throw new Error("Invalid list");this._head=e,this._state++}addItemLast(e){if(!this._head&&!this._tail)this._head=e;else if(this._tail)e.previous=this._tail,this._tail.next=e;else throw new Error("Invalid list");this._tail=e,this._state++}removeItem(e){if(e===this._head&&e===this._tail)this._head=void 0,this._tail=void 0;else if(e===this._head){if(!e.next)throw new Error("Invalid list");e.next.previous=void 0,this._head=e.next}else if(e===this._tail){if(!e.previous)throw new Error("Invalid list");e.previous.next=void 0,this._tail=e.previous}else{let t=e.next,r=e.previous;if(!t||!r)throw new Error("Invalid list");t.previous=r,r.next=t}e.next=void 0,e.previous=void 0,this._state++}touch(e,t){if(!this._head||!this._tail)throw new Error("Invalid list");if(!(t!==Wt.First&&t!==Wt.Last)){if(t===Wt.First){if(e===this._head)return;let r=e.next,i=e.previous;e===this._tail?(i.next=void 0,this._tail=i):(r.previous=i,i.next=r),e.previous=void 0,e.next=this._head,this._head.previous=e,this._head=e,this._state++}else if(t===Wt.Last){if(e===this._tail)return;let r=e.next,i=e.previous;e===this._head?(r.previous=void 0,this._head=r):(r.previous=i,i.next=r),e.next=void 0,e.previous=this._tail,this._tail.next=e,this._tail=e,this._state++}}}toJSON(){let e=[];return this.forEach((t,r)=>{e.push([r,t])}),e}fromJSON(e){this.clear();for(let[t,r]of e)this.set(t,r)}};hr.LinkedMap=mu;var ig=class extends mu{constructor(e,t=1){super();this._limit=e,this._ratio=Math.min(Math.max(0,t),1)}get limit(){return this._limit}set limit(e){this._limit=e,this.checkTrim()}get ratio(){return this._ratio}set ratio(e){this._ratio=Math.min(Math.max(0,e),1),this.checkTrim()}get(e,t=Wt.AsNew){return super.get(e,t)}peek(e){return super.get(e,Wt.None)}set(e,t){return super.set(e,t,Wt.Last),this.checkTrim(),this}checkTrim(){this.size>this._limit&&this.trimOld(Math.round(this._limit*this._ratio))}};hr.LRUCache=ig});var Mi=F(oi=>{"use strict";Object.defineProperty(oi,"__esModule",{value:!0});oi.Emitter=oi.Event=void 0;var kR=fr(),ER;(function(n){let e={dispose(){}};n.None=function(){return e}})(ER=oi.Event||(oi.Event={}));var sg=class{add(e,t=null,r){this._callbacks||(this._callbacks=[],this._contexts=[]),this._callbacks.push(e),this._contexts.push(t),Array.isArray(r)&&r.push({dispose:()=>this.remove(e,t)})}remove(e,t=null){if(!this._callbacks)return;let r=!1;for(let i=0,s=this._callbacks.length;i<s;i++)if(this._callbacks[i]===e)if(this._contexts[i]===t){this._callbacks.splice(i,1),this._contexts.splice(i,1);return}else r=!0;if(r)throw new Error("When adding a listener with a context, you should remove it with the same context")}invoke(...e){if(!this._callbacks)return[];let t=[],r=this._callbacks.slice(0),i=this._contexts.slice(0);for(let s=0,o=r.length;s<o;s++)try{t.push(r[s].apply(i[s],e))}catch(a){(0,kR.default)().console.error(a)}return t}isEmpty(){return!this._callbacks||this._callbacks.length===0}dispose(){this._callbacks=void 0,this._contexts=void 0}},$s=class{constructor(e){this._options=e}get event(){return this._event||(this._event=(e,t,r)=>{this._callbacks||(this._callbacks=new sg),this._options&&this._options.onFirstListenerAdd&&this._callbacks.isEmpty()&&this._options.onFirstListenerAdd(this),this._callbacks.add(e,t);let i={dispose:()=>{!this._callbacks||(this._callbacks.remove(e,t),i.dispose=$s._noop,this._options&&this._options.onLastListenerRemove&&this._callbacks.isEmpty()&&this._options.onLastListenerRemove(this))}};return Array.isArray(r)&&r.push(i),i}),this._event}fire(e){this._callbacks&&this._callbacks.invoke.call(this._callbacks,e)}dispose(){this._callbacks&&(this._callbacks.dispose(),this._callbacks=void 0)}};oi.Emitter=$s;$s._noop=function(){}});var bu=F(ai=>{"use strict";Object.defineProperty(ai,"__esModule",{value:!0});ai.CancellationTokenSource=ai.CancellationToken=void 0;var xR=fr(),qR=Ai(),yu=Mi(),wu;(function(n){n.None=Object.freeze({isCancellationRequested:!1,onCancellationRequested:yu.Event.None}),n.Cancelled=Object.freeze({isCancellationRequested:!0,onCancellationRequested:yu.Event.None});function e(t){let r=t;return r&&(r===n.None||r===n.Cancelled||qR.boolean(r.isCancellationRequested)&&!!r.onCancellationRequested)}n.is=e})(wu=ai.CancellationToken||(ai.CancellationToken={}));var IR=Object.freeze(function(n,e){let t=(0,xR.default)().timer.setTimeout(n.bind(e),0);return{dispose(){t.dispose()}}}),Cu=class{constructor(){this._isCancelled=!1}cancel(){this._isCancelled||(this._isCancelled=!0,this._emitter&&(this._emitter.fire(void 0),this.dispose()))}get isCancellationRequested(){return this._isCancelled}get onCancellationRequested(){return this._isCancelled?IR:(this._emitter||(this._emitter=new yu.Emitter),this._emitter.event)}dispose(){this._emitter&&(this._emitter.dispose(),this._emitter=void 0)}},og=class{get token(){return this._token||(this._token=new Cu),this._token}cancel(){this._token?this._token.cancel():this._token=wu.Cancelled}dispose(){this._token?this._token instanceof Cu&&this._token.dispose():this._token=wu.None}};ai.CancellationTokenSource=og});var cg=F(pr=>{"use strict";Object.defineProperty(pr,"__esModule",{value:!0});pr.ReadableStreamMessageReader=pr.AbstractMessageReader=pr.MessageReader=void 0;var Du=fr(),$i=Ai(),Tu=Mi(),FR;(function(n){function e(t){let r=t;return r&&$i.func(r.listen)&&$i.func(r.dispose)&&$i.func(r.onError)&&$i.func(r.onClose)&&$i.func(r.onPartialMessage)}n.is=e})(FR=pr.MessageReader||(pr.MessageReader={}));var Ru=class{constructor(){this.errorEmitter=new Tu.Emitter,this.closeEmitter=new Tu.Emitter,this.partialMessageEmitter=new Tu.Emitter}dispose(){this.errorEmitter.dispose(),this.closeEmitter.dispose()}get onError(){return this.errorEmitter.event}fireError(e){this.errorEmitter.fire(this.asError(e))}get onClose(){return this.closeEmitter.event}fireClose(){this.closeEmitter.fire(void 0)}get onPartialMessage(){return this.partialMessageEmitter.event}firePartialMessage(e){this.partialMessageEmitter.fire(e)}asError(e){return e instanceof Error?e:new Error(`Reader received error. Reason: ${$i.string(e.message)?e.message:"unknown"}`)}};pr.AbstractMessageReader=Ru;var Su;(function(n){function e(t){let r,i,s,o=new Map,a,c=new Map;if(t===void 0||typeof t=="string")r=t??"utf-8";else{if(r=t.charset??"utf-8",t.contentDecoder!==void 0&&(s=t.contentDecoder,o.set(s.name,s)),t.contentDecoders!==void 0)for(let u of t.contentDecoders)o.set(u.name,u);if(t.contentTypeDecoder!==void 0&&(a=t.contentTypeDecoder,c.set(a.name,a)),t.contentTypeDecoders!==void 0)for(let u of t.contentTypeDecoders)c.set(u.name,u)}return a===void 0&&(a=(0,Du.default)().applicationJson.decoder,c.set(a.name,a)),{charset:r,contentDecoder:s,contentDecoders:o,contentTypeDecoder:a,contentTypeDecoders:c}}n.fromOptions=e})(Su||(Su={}));var ag=class extends Ru{constructor(e,t){super();this.readable=e,this.options=Su.fromOptions(t),this.buffer=(0,Du.default)().messageBuffer.create(this.options.charset),this._partialMessageTimeout=1e4,this.nextMessageLength=-1,this.messageToken=0}set partialMessageTimeout(e){this._partialMessageTimeout=e}get partialMessageTimeout(){return this._partialMessageTimeout}listen(e){this.nextMessageLength=-1,this.messageToken=0,this.partialMessageTimer=void 0,this.callback=e;let t=this.readable.onData(r=>{this.onData(r)});return this.readable.onError(r=>this.fireError(r)),this.readable.onClose(()=>this.fireClose()),t}onData(e){for(this.buffer.append(e);;){if(this.nextMessageLength===-1){let i=this.buffer.tryReadHeaders();if(!i)return;let s=i.get("Content-Length");if(!s)throw new Error("Header must provide a Content-Length property.");let o=parseInt(s);if(isNaN(o))throw new Error("Content-Length value must be a number.");this.nextMessageLength=o}let t=this.buffer.tryReadBody(this.nextMessageLength);if(t===void 0){this.setPartialMessageTimer();return}this.clearPartialMessageTimer(),this.nextMessageLength=-1;let r;this.options.contentDecoder!==void 0?r=this.options.contentDecoder.decode(t):r=Promise.resolve(t),r.then(i=>{this.options.contentTypeDecoder.decode(i,this.options).then(s=>{this.callback(s)},s=>{this.fireError(s)})},i=>{this.fireError(i)})}}clearPartialMessageTimer(){this.partialMessageTimer&&(this.partialMessageTimer.dispose(),this.partialMessageTimer=void 0)}setPartialMessageTimer(){this.clearPartialMessageTimer(),!(this._partialMessageTimeout<=0)&&(this.partialMessageTimer=(0,Du.default)().timer.setTimeout((e,t)=>{this.partialMessageTimer=void 0,e===this.messageToken&&(this.firePartialMessage({messageToken:e,waitingTime:t}),this.setPartialMessageTimer())},this._partialMessageTimeout,this.messageToken,this._partialMessageTimeout))}};pr.ReadableStreamMessageReader=ag});var lg=F(ya=>{"use strict";Object.defineProperty(ya,"__esModule",{value:!0});ya.Semaphore=void 0;var NR=fr(),ug=class{constructor(e=1){if(e<=0)throw new Error("Capacity must be greater than 0");this._capacity=e,this._active=0,this._waiting=[]}lock(e){return new Promise((t,r)=>{this._waiting.push({thunk:e,resolve:t,reject:r}),this.runNext()})}get active(){return this._active}runNext(){this._waiting.length===0||this._active===this._capacity||(0,NR.default)().timer.setImmediate(()=>this.doRunNext())}doRunNext(){if(this._waiting.length===0||this._active===this._capacity)return;let e=this._waiting.shift();if(this._active++,this._active>this._capacity)throw new Error("To many thunks active");try{let t=e.thunk();t instanceof Promise?t.then(r=>{this._active--,e.resolve(r),this.runNext()},r=>{this._active--,e.reject(r),this.runNext()}):(this._active--,e.resolve(t),this.runNext())}catch(t){this._active--,e.reject(t),this.runNext()}}};ya.Semaphore=ug});var gg=F(gr=>{"use strict";Object.defineProperty(gr,"__esModule",{value:!0});gr.WriteableStreamMessageWriter=gr.AbstractMessageWriter=gr.MessageWriter=void 0;var dg=fr(),js=Ai(),OR=lg(),fg=Mi(),LR="Content-Length: ",hg=`\r
`,AR;(function(n){function e(t){let r=t;return r&&js.func(r.dispose)&&js.func(r.onClose)&&js.func(r.onError)&&js.func(r.write)}n.is=e})(AR=gr.MessageWriter||(gr.MessageWriter={}));var _u=class{constructor(){this.errorEmitter=new fg.Emitter,this.closeEmitter=new fg.Emitter}dispose(){this.errorEmitter.dispose(),this.closeEmitter.dispose()}get onError(){return this.errorEmitter.event}fireError(e,t,r){this.errorEmitter.fire([this.asError(e),t,r])}get onClose(){return this.closeEmitter.event}fireClose(){this.closeEmitter.fire(void 0)}asError(e){return e instanceof Error?e:new Error(`Writer received error. Reason: ${js.string(e.message)?e.message:"unknown"}`)}};gr.AbstractMessageWriter=_u;var Pu;(function(n){function e(t){return t===void 0||typeof t=="string"?{charset:t??"utf-8",contentTypeEncoder:(0,dg.default)().applicationJson.encoder}:{charset:t.charset??"utf-8",contentEncoder:t.contentEncoder,contentTypeEncoder:t.contentTypeEncoder??(0,dg.default)().applicationJson.encoder}}n.fromOptions=e})(Pu||(Pu={}));var pg=class extends _u{constructor(e,t){super();this.writable=e,this.options=Pu.fromOptions(t),this.errorCount=0,this.writeSemaphore=new OR.Semaphore(1),this.writable.onError(r=>this.fireError(r)),this.writable.onClose(()=>this.fireClose())}async write(e){return this.writeSemaphore.lock(async()=>this.options.contentTypeEncoder.encode(e,this.options).then(r=>this.options.contentEncoder!==void 0?this.options.contentEncoder.encode(r):r).then(r=>{let i=[];return i.push(LR,r.byteLength.toString(),hg),i.push(hg),this.doWrite(e,i,r)},r=>{throw this.fireError(r),r}))}async doWrite(e,t,r){try{return await this.writable.write(t.join(""),"ascii"),this.writable.write(r)}catch(i){return this.handleError(i,e),Promise.reject(i)}}handleError(e,t){this.errorCount++,this.fireError(e,t,this.errorCount)}end(){this.writable.end()}};gr.WriteableStreamMessageWriter=pg});var Dg=F(oe=>{"use strict";Object.defineProperty(oe,"__esModule",{value:!0});oe.createMessageConnection=oe.ConnectionOptions=oe.CancellationStrategy=oe.CancellationSenderStrategy=oe.CancellationReceiverStrategy=oe.ConnectionStrategy=oe.ConnectionError=oe.ConnectionErrors=oe.LogTraceNotification=oe.SetTraceNotification=oe.TraceFormat=oe.Trace=oe.NullLogger=oe.ProgressType=oe.ProgressToken=void 0;var mg=fr(),yt=Ai(),ie=gu(),vg=vu(),Ws=Mi(),ku=bu(),Hs;(function(n){n.type=new ie.NotificationType("$/cancelRequest")})(Hs||(Hs={}));var yg;(function(n){function e(t){return typeof t=="string"||typeof t=="number"}n.is=e})(yg=oe.ProgressToken||(oe.ProgressToken={}));var Us;(function(n){n.type=new ie.NotificationType("$/progress")})(Us||(Us={}));var wg=class{constructor(){}};oe.ProgressType=wg;var Eu;(function(n){function e(t){return yt.func(t)}n.is=e})(Eu||(Eu={}));oe.NullLogger=Object.freeze({error:()=>{},warn:()=>{},info:()=>{},log:()=>{}});var Ae;(function(n){n[n.Off=0]="Off",n[n.Messages=1]="Messages",n[n.Compact=2]="Compact",n[n.Verbose=3]="Verbose"})(Ae=oe.Trace||(oe.Trace={}));(function(n){function e(r){if(!yt.string(r))return n.Off;switch(r=r.toLowerCase(),r){case"off":return n.Off;case"messages":return n.Messages;case"compact":return n.Compact;case"verbose":return n.Verbose;default:return n.Off}}n.fromString=e;function t(r){switch(r){case n.Off:return"off";case n.Messages:return"messages";case n.Compact:return"compact";case n.Verbose:return"verbose";default:return"off"}}n.toString=t})(Ae=oe.Trace||(oe.Trace={}));var Fn;(function(n){n.Text="text",n.JSON="json"})(Fn=oe.TraceFormat||(oe.TraceFormat={}));(function(n){function e(t){return yt.string(t)?(t=t.toLowerCase(),t==="json"?n.JSON:n.Text):n.Text}n.fromString=e})(Fn=oe.TraceFormat||(oe.TraceFormat={}));var Cg;(function(n){n.type=new ie.NotificationType("$/setTrace")})(Cg=oe.SetTraceNotification||(oe.SetTraceNotification={}));var xu;(function(n){n.type=new ie.NotificationType("$/logTrace")})(xu=oe.LogTraceNotification||(oe.LogTraceNotification={}));var wa;(function(n){n[n.Closed=1]="Closed",n[n.Disposed=2]="Disposed",n[n.AlreadyListening=3]="AlreadyListening"})(wa=oe.ConnectionErrors||(oe.ConnectionErrors={}));var ci=class extends Error{constructor(e,t){super(t);this.code=e,Object.setPrototypeOf(this,ci.prototype)}};oe.ConnectionError=ci;var bg;(function(n){function e(t){let r=t;return r&&yt.func(r.cancelUndispatched)}n.is=e})(bg=oe.ConnectionStrategy||(oe.ConnectionStrategy={}));var qu;(function(n){n.Message=Object.freeze({createCancellationTokenSource(t){return new ku.CancellationTokenSource}});function e(t){let r=t;return r&&yt.func(r.createCancellationTokenSource)}n.is=e})(qu=oe.CancellationReceiverStrategy||(oe.CancellationReceiverStrategy={}));var Iu;(function(n){n.Message=Object.freeze({sendCancellation(t,r){return t.sendNotification(Hs.type,{id:r})},cleanup(t){}});function e(t){let r=t;return r&&yt.func(r.sendCancellation)&&yt.func(r.cleanup)}n.is=e})(Iu=oe.CancellationSenderStrategy||(oe.CancellationSenderStrategy={}));var Fu;(function(n){n.Message=Object.freeze({receiver:qu.Message,sender:Iu.Message});function e(t){let r=t;return r&&qu.is(r.receiver)&&Iu.is(r.sender)}n.is=e})(Fu=oe.CancellationStrategy||(oe.CancellationStrategy={}));var MR;(function(n){function e(t){let r=t;return r&&(Fu.is(r.cancellationStrategy)||bg.is(r.connectionStrategy))}n.is=e})(MR=oe.ConnectionOptions||(oe.ConnectionOptions={}));var Nn;(function(n){n[n.New=1]="New",n[n.Listening=2]="Listening",n[n.Closed=3]="Closed",n[n.Disposed=4]="Disposed"})(Nn||(Nn={}));function $R(n,e,t,r){let i=t!==void 0?t:oe.NullLogger,s=0,o=0,a=0,c="2.0",u,l=new Map,h,p=new Map,C=new Map,T,y=new vg.LinkedMap,R=new Map,S=new Set,v=new Map,b=Ae.Off,P=Fn.Text,N,q=Nn.New,O=new Ws.Emitter,H=new Ws.Emitter,B=new Ws.Emitter,Y=new Ws.Emitter,Z=new Ws.Emitter,Oe=r&&r.cancellationStrategy?r.cancellationStrategy:Fu.Message;function ot(_){if(_===null)throw new Error("Can't send requests with id null since the response can't be correlated.");return"req-"+_.toString()}function Ye(_){return _===null?"res-unknown-"+(++a).toString():"res-"+_.toString()}function He(){return"not-"+(++o).toString()}function de(_,M){ie.Message.isRequest(M)?_.set(ot(M.id),M):ie.Message.isResponse(M)?_.set(Ye(M.id),M):_.set(He(),M)}function Ue(_){}function je(){return q===Nn.Listening}function mt(){return q===Nn.Closed}function Tt(){return q===Nn.Disposed}function nn(){(q===Nn.New||q===Nn.Listening)&&(q=Nn.Closed,H.fire(void 0))}function ut(_){O.fire([_,void 0,void 0])}function Xr(_){O.fire(_)}n.onClose(nn),n.onError(ut),e.onClose(nn),e.onError(Xr);function Rr(){T||y.size===0||(T=(0,mg.default)().timer.setImmediate(()=>{T=void 0,Sr()}))}function Sr(){if(y.size===0)return;let _=y.shift();try{ie.Message.isRequest(_)?ir(_):ie.Message.isNotification(_)?_r(_):ie.Message.isResponse(_)?Br(_):Pr(_)}finally{Rr()}}let rr=_=>{try{if(ie.Message.isNotification(_)&&_.method===Hs.type.method){let M=_.params.id,U=ot(M),X=y.get(U);if(ie.Message.isRequest(X)){let Re=r==null?void 0:r.connectionStrategy,Se=Re&&Re.cancelUndispatched?Re.cancelUndispatched(X,Ue):Ue(X);if(Se&&(Se.error!==void 0||Se.result!==void 0)){y.delete(U),v.delete(M),Se.id=X.id,rn(Se,_.method,Date.now()),e.write(Se).catch(()=>i.error("Sending response for canceled message failed."));return}}let Te=v.get(M);if(Te!==void 0){Te.cancel(),Vn(_);return}else S.add(M)}de(y,_)}finally{Rr()}};function ir(_){if(Tt())return;function M(ge,Ee,me){let g={jsonrpc:c,id:_.id};ge instanceof ie.ResponseError?g.error=ge.toJson():g.result=ge===void 0?null:ge,rn(g,Ee,me),e.write(g).catch(()=>i.error("Sending response failed."))}function U(ge,Ee,me){let g={jsonrpc:c,id:_.id,error:ge.toJson()};rn(g,Ee,me),e.write(g).catch(()=>i.error("Sending response failed."))}function X(ge,Ee,me){ge===void 0&&(ge=null);let g={jsonrpc:c,id:_.id,result:ge};rn(g,Ee,me),e.write(g).catch(()=>i.error("Sending response failed."))}sr(_);let Te=l.get(_.method),Re,Se;Te&&(Re=Te.type,Se=Te.handler);let Ke=Date.now();if(Se||u){let ge=_.id??String(Date.now()),Ee=Oe.receiver.createCancellationTokenSource(ge);_.id!==null&&S.has(_.id)&&Ee.cancel(),_.id!==null&&v.set(ge,Ee);try{let me;if(Se)if(_.params===void 0){if(Re!==void 0&&Re.numberOfParams!==0){U(new ie.ResponseError(ie.ErrorCodes.InvalidParams,`Request ${_.method} defines ${Re.numberOfParams} params but received none.`),_.method,Ke);return}me=Se(Ee.token)}else if(Array.isArray(_.params)){if(Re!==void 0&&Re.parameterStructures===ie.ParameterStructures.byName){U(new ie.ResponseError(ie.ErrorCodes.InvalidParams,`Request ${_.method} defines parameters by name but received parameters by position`),_.method,Ke);return}me=Se(..._.params,Ee.token)}else{if(Re!==void 0&&Re.parameterStructures===ie.ParameterStructures.byPosition){U(new ie.ResponseError(ie.ErrorCodes.InvalidParams,`Request ${_.method} defines parameters by position but received parameters by name`),_.method,Ke);return}me=Se(_.params,Ee.token)}else u&&(me=u(_.method,_.params,Ee.token));let g=me;me?g.then?g.then(A=>{v.delete(ge),M(A,_.method,Ke)},A=>{v.delete(ge),A instanceof ie.ResponseError?U(A,_.method,Ke):A&&yt.string(A.message)?U(new ie.ResponseError(ie.ErrorCodes.InternalError,`Request ${_.method} failed with message: ${A.message}`),_.method,Ke):U(new ie.ResponseError(ie.ErrorCodes.InternalError,`Request ${_.method} failed unexpectedly without providing any details.`),_.method,Ke)}):(v.delete(ge),M(me,_.method,Ke)):(v.delete(ge),X(me,_.method,Ke))}catch(me){v.delete(ge),me instanceof ie.ResponseError?M(me,_.method,Ke):me&&yt.string(me.message)?U(new ie.ResponseError(ie.ErrorCodes.InternalError,`Request ${_.method} failed with message: ${me.message}`),_.method,Ke):U(new ie.ResponseError(ie.ErrorCodes.InternalError,`Request ${_.method} failed unexpectedly without providing any details.`),_.method,Ke)}}else U(new ie.ResponseError(ie.ErrorCodes.MethodNotFound,`Unhandled method ${_.method}`),_.method,Ke)}function Br(_){if(!Tt())if(_.id===null)_.error?i.error(`Received response message without id: Error is: 
${JSON.stringify(_.error,void 0,4)}`):i.error("Received response message without id. No further error information provided.");else{let M=_.id,U=R.get(M);if(sn(_,U),U!==void 0){R.delete(M);try{if(_.error){let X=_.error;U.reject(new ie.ResponseError(X.code,X.message,X.data))}else if(_.result!==void 0)U.resolve(_.result);else throw new Error("Should never happen.")}catch(X){X.message?i.error(`Response handler '${U.method}' failed with message: ${X.message}`):i.error(`Response handler '${U.method}' failed unexpectedly.`)}}}}function _r(_){if(Tt())return;let M,U;if(_.method===Hs.type.method){let X=_.params.id;S.delete(X),Vn(_);return}else{let X=p.get(_.method);X&&(U=X.handler,M=X.type)}if(U||h)try{if(Vn(_),U)if(_.params===void 0)M!==void 0&&M.numberOfParams!==0&&M.parameterStructures!==ie.ParameterStructures.byName&&i.error(`Notification ${_.method} defines ${M.numberOfParams} params but received none.`),U();else if(Array.isArray(_.params)){let X=_.params;_.method===Us.type.method&&X.length===2&&yg.is(X[0])?U({token:X[0],value:X[1]}):(M!==void 0&&(M.parameterStructures===ie.ParameterStructures.byName&&i.error(`Notification ${_.method} defines parameters by name but received parameters by position`),M.numberOfParams!==_.params.length&&i.error(`Notification ${_.method} defines ${M.numberOfParams} params but received ${X.length} arguments`)),U(...X))}else M!==void 0&&M.parameterStructures===ie.ParameterStructures.byPosition&&i.error(`Notification ${_.method} defines parameters by position but received parameters by name`),U(_.params);else h&&h(_.method,_.params)}catch(X){X.message?i.error(`Notification handler '${_.method}' failed with message: ${X.message}`):i.error(`Notification handler '${_.method}' failed unexpectedly.`)}else B.fire(_)}function Pr(_){if(!_){i.error("Received empty message.");return}i.error(`Received message which is neither a response nor a notification message:
${JSON.stringify(_,null,4)}`);let M=_;if(yt.string(M.id)||yt.number(M.id)){let U=M.id,X=R.get(U);X&&X.reject(new Error("The received response has neither a result nor an error property."))}}function xt(_){if(_!=null)switch(b){case Ae.Verbose:return JSON.stringify(_,null,4);case Ae.Compact:return JSON.stringify(_);default:return}}function dn(_){if(!(b===Ae.Off||!N))if(P===Fn.Text){let M;(b===Ae.Verbose||b===Ae.Compact)&&_.params&&(M=`Params: ${xt(_.params)}

`),N.log(`Sending request '${_.method} - (${_.id})'.`,M)}else Vt("send-request",_)}function kr(_){if(!(b===Ae.Off||!N))if(P===Fn.Text){let M;(b===Ae.Verbose||b===Ae.Compact)&&(_.params?M=`Params: ${xt(_.params)}

`:M=`No parameters provided.

`),N.log(`Sending notification '${_.method}'.`,M)}else Vt("send-notification",_)}function rn(_,M,U){if(!(b===Ae.Off||!N))if(P===Fn.Text){let X;(b===Ae.Verbose||b===Ae.Compact)&&(_.error&&_.error.data?X=`Error data: ${xt(_.error.data)}

`:_.result?X=`Result: ${xt(_.result)}

`:_.error===void 0&&(X=`No result returned.

`)),N.log(`Sending response '${M} - (${_.id})'. Processing request took ${Date.now()-U}ms`,X)}else Vt("send-response",_)}function sr(_){if(!(b===Ae.Off||!N))if(P===Fn.Text){let M;(b===Ae.Verbose||b===Ae.Compact)&&_.params&&(M=`Params: ${xt(_.params)}

`),N.log(`Received request '${_.method} - (${_.id})'.`,M)}else Vt("receive-request",_)}function Vn(_){if(!(b===Ae.Off||!N||_.method===xu.type.method))if(P===Fn.Text){let M;(b===Ae.Verbose||b===Ae.Compact)&&(_.params?M=`Params: ${xt(_.params)}

`:M=`No parameters provided.

`),N.log(`Received notification '${_.method}'.`,M)}else Vt("receive-notification",_)}function sn(_,M){if(!(b===Ae.Off||!N))if(P===Fn.Text){let U;if((b===Ae.Verbose||b===Ae.Compact)&&(_.error&&_.error.data?U=`Error data: ${xt(_.error.data)}

`:_.result?U=`Result: ${xt(_.result)}

`:_.error===void 0&&(U=`No result returned.

`)),M){let X=_.error?` Request failed: ${_.error.message} (${_.error.code}).`:"";N.log(`Received response '${M.method} - (${_.id})' in ${Date.now()-M.timerStart}ms.${X}`,U)}else N.log(`Received response ${_.id} without active response promise.`,U)}else Vt("receive-response",_)}function Vt(_,M){if(!N||b===Ae.Off)return;let U={isLSPMessage:!0,type:_,message:M,timestamp:Date.now()};N.log(U)}function lt(){if(mt())throw new ci(wa.Closed,"Connection is closed.");if(Tt())throw new ci(wa.Disposed,"Connection is disposed.")}function Gr(){if(je())throw new ci(wa.AlreadyListening,"Connection is already listening")}function Mt(){if(!je())throw new Error("Call listen() first.")}function on(_){return _===void 0?null:_}function Xn(_){if(_!==null)return _}function or(_){return _!=null&&!Array.isArray(_)&&typeof _=="object"}function ar(_,M){switch(_){case ie.ParameterStructures.auto:return or(M)?Xn(M):[on(M)];case ie.ParameterStructures.byName:if(!or(M))throw new Error("Received parameters by name but param is not an object literal.");return Xn(M);case ie.ParameterStructures.byPosition:return[on(M)];default:throw new Error(`Unknown parameter structure ${_.toString()}`)}}function an(_,M){let U,X=_.numberOfParams;switch(X){case 0:U=void 0;break;case 1:U=ar(_.parameterStructures,M[0]);break;default:U=[];for(let Te=0;Te<M.length&&Te<X;Te++)U.push(on(M[Te]));if(M.length<X)for(let Te=M.length;Te<X;Te++)U.push(null);break}return U}let fn={sendNotification:(_,...M)=>{lt();let U,X;if(yt.string(_)){U=_;let Re=M[0],Se=0,Ke=ie.ParameterStructures.auto;ie.ParameterStructures.is(Re)&&(Se=1,Ke=Re);let ge=M.length,Ee=ge-Se;switch(Ee){case 0:X=void 0;break;case 1:X=ar(Ke,M[Se]);break;default:if(Ke===ie.ParameterStructures.byName)throw new Error(`Received ${Ee} parameters for 'by Name' notification parameter structure.`);X=M.slice(Se,ge).map(me=>on(me));break}}else{let Re=M;U=_.method,X=an(_,Re)}let Te={jsonrpc:c,method:U,params:X};return kr(Te),e.write(Te).catch(()=>i.error("Sending notification failed."))},onNotification:(_,M)=>{lt();let U;return yt.func(_)?h=_:M&&(yt.string(_)?(U=_,p.set(_,{type:void 0,handler:M})):(U=_.method,p.set(_.method,{type:_,handler:M}))),{dispose:()=>{U!==void 0?p.delete(U):h=void 0}}},onProgress:(_,M,U)=>{if(C.has(M))throw new Error(`Progress handler for token ${M} already registered`);return C.set(M,U),{dispose:()=>{C.delete(M)}}},sendProgress:(_,M,U)=>fn.sendNotification(Us.type,{token:M,value:U}),onUnhandledProgress:Y.event,sendRequest:(_,...M)=>{lt(),Mt();let U,X,Te;if(yt.string(_)){U=_;let ge=M[0],Ee=M[M.length-1],me=0,g=ie.ParameterStructures.auto;ie.ParameterStructures.is(ge)&&(me=1,g=ge);let A=M.length;ku.CancellationToken.is(Ee)&&(A=A-1,Te=Ee);let V=A-me;switch(V){case 0:X=void 0;break;case 1:X=ar(g,M[me]);break;default:if(g===ie.ParameterStructures.byName)throw new Error(`Received ${V} parameters for 'by Name' request parameter structure.`);X=M.slice(me,A).map(he=>on(he));break}}else{let ge=M;U=_.method,X=an(_,ge);let Ee=_.numberOfParams;Te=ku.CancellationToken.is(ge[Ee])?ge[Ee]:void 0}let Re=s++,Se;return Te&&(Se=Te.onCancellationRequested(()=>{let ge=Oe.sender.sendCancellation(fn,Re);return ge===void 0?(i.log(`Received no promise from cancellation strategy when cancelling id ${Re}`),Promise.resolve()):ge.catch(()=>{i.log(`Sending cancellation messages for id ${Re} failed`)})})),new Promise((ge,Ee)=>{let me={jsonrpc:c,id:Re,method:U,params:X},g=he=>{ge(he),Oe.sender.cleanup(Re),Se==null||Se.dispose()},A=he=>{Ee(he),Oe.sender.cleanup(Re),Se==null||Se.dispose()},V={method:U,timerStart:Date.now(),resolve:g,reject:A};dn(me);try{e.write(me).catch(()=>i.error("Sending request failed."))}catch(he){V.reject(new ie.ResponseError(ie.ErrorCodes.MessageWriteError,he.message?he.message:"Unknown reason")),V=null}V&&R.set(Re,V)})},onRequest:(_,M)=>{lt();let U=null;return Eu.is(_)?(U=void 0,u=_):yt.string(_)?(U=null,M!==void 0&&(U=_,l.set(_,{handler:M,type:void 0}))):M!==void 0&&(U=_.method,l.set(_.method,{type:_,handler:M})),{dispose:()=>{U!==null&&(U!==void 0?l.delete(U):u=void 0)}}},hasPendingResponse:()=>R.size>0,trace:async(_,M,U)=>{let X=!1,Te=Fn.Text;U!==void 0&&(yt.boolean(U)?X=U:(X=U.sendNotification||!1,Te=U.traceFormat||Fn.Text)),b=_,P=Te,b===Ae.Off?N=void 0:N=M,X&&!mt()&&!Tt()&&await fn.sendNotification(Cg.type,{value:Ae.toString(_)})},onError:O.event,onClose:H.event,onUnhandledNotification:B.event,onDispose:Z.event,end:()=>{e.end()},dispose:()=>{if(Tt())return;q=Nn.Disposed,Z.fire(void 0);let _=new ie.ResponseError(ie.ErrorCodes.PendingResponseRejected,"Pending response rejected since connection got disposed");for(let M of R.values())M.reject(_);R=new Map,v=new Map,S=new Set,y=new vg.LinkedMap,yt.func(e.dispose)&&e.dispose(),yt.func(n.dispose)&&n.dispose()},listen:()=>{lt(),Gr(),q=Nn.Listening,n.listen(rr)},inspect:()=>{(0,mg.default)().console.log("inspect")}};return fn.onNotification(xu.type,_=>{if(b===Ae.Off||!N)return;let M=b===Ae.Verbose||b===Ae.Compact;N.log(_.message,M?_.verbose:void 0)}),fn.onNotification(Us.type,_=>{let M=C.get(_.token);M?M(_.value):Y.fire(_)}),fn}oe.createMessageConnection=$R});var Au=F(j=>{"use strict";Object.defineProperty(j,"__esModule",{value:!0});j.SetTraceNotification=j.TraceFormat=j.Trace=j.ProgressType=j.ProgressToken=j.createMessageConnection=j.NullLogger=j.ConnectionOptions=j.ConnectionStrategy=j.WriteableStreamMessageWriter=j.AbstractMessageWriter=j.MessageWriter=j.ReadableStreamMessageReader=j.AbstractMessageReader=j.MessageReader=j.CancellationToken=j.CancellationTokenSource=j.Emitter=j.Event=j.Disposable=j.LRUCache=j.Touch=j.LinkedMap=j.ParameterStructures=j.NotificationType9=j.NotificationType8=j.NotificationType7=j.NotificationType6=j.NotificationType5=j.NotificationType4=j.NotificationType3=j.NotificationType2=j.NotificationType1=j.NotificationType0=j.NotificationType=j.ErrorCodes=j.ResponseError=j.RequestType9=j.RequestType8=j.RequestType7=j.RequestType6=j.RequestType5=j.RequestType4=j.RequestType3=j.RequestType2=j.RequestType1=j.RequestType0=j.RequestType=j.Message=j.RAL=void 0;j.CancellationStrategy=j.CancellationSenderStrategy=j.CancellationReceiverStrategy=j.ConnectionError=j.ConnectionErrors=j.LogTraceNotification=void 0;var We=gu();Object.defineProperty(j,"Message",{enumerable:!0,get:function(){return We.Message}});Object.defineProperty(j,"RequestType",{enumerable:!0,get:function(){return We.RequestType}});Object.defineProperty(j,"RequestType0",{enumerable:!0,get:function(){return We.RequestType0}});Object.defineProperty(j,"RequestType1",{enumerable:!0,get:function(){return We.RequestType1}});Object.defineProperty(j,"RequestType2",{enumerable:!0,get:function(){return We.RequestType2}});Object.defineProperty(j,"RequestType3",{enumerable:!0,get:function(){return We.RequestType3}});Object.defineProperty(j,"RequestType4",{enumerable:!0,get:function(){return We.RequestType4}});Object.defineProperty(j,"RequestType5",{enumerable:!0,get:function(){return We.RequestType5}});Object.defineProperty(j,"RequestType6",{enumerable:!0,get:function(){return We.RequestType6}});Object.defineProperty(j,"RequestType7",{enumerable:!0,get:function(){return We.RequestType7}});Object.defineProperty(j,"RequestType8",{enumerable:!0,get:function(){return We.RequestType8}});Object.defineProperty(j,"RequestType9",{enumerable:!0,get:function(){return We.RequestType9}});Object.defineProperty(j,"ResponseError",{enumerable:!0,get:function(){return We.ResponseError}});Object.defineProperty(j,"ErrorCodes",{enumerable:!0,get:function(){return We.ErrorCodes}});Object.defineProperty(j,"NotificationType",{enumerable:!0,get:function(){return We.NotificationType}});Object.defineProperty(j,"NotificationType0",{enumerable:!0,get:function(){return We.NotificationType0}});Object.defineProperty(j,"NotificationType1",{enumerable:!0,get:function(){return We.NotificationType1}});Object.defineProperty(j,"NotificationType2",{enumerable:!0,get:function(){return We.NotificationType2}});Object.defineProperty(j,"NotificationType3",{enumerable:!0,get:function(){return We.NotificationType3}});Object.defineProperty(j,"NotificationType4",{enumerable:!0,get:function(){return We.NotificationType4}});Object.defineProperty(j,"NotificationType5",{enumerable:!0,get:function(){return We.NotificationType5}});Object.defineProperty(j,"NotificationType6",{enumerable:!0,get:function(){return We.NotificationType6}});Object.defineProperty(j,"NotificationType7",{enumerable:!0,get:function(){return We.NotificationType7}});Object.defineProperty(j,"NotificationType8",{enumerable:!0,get:function(){return We.NotificationType8}});Object.defineProperty(j,"NotificationType9",{enumerable:!0,get:function(){return We.NotificationType9}});Object.defineProperty(j,"ParameterStructures",{enumerable:!0,get:function(){return We.ParameterStructures}});var Nu=vu();Object.defineProperty(j,"LinkedMap",{enumerable:!0,get:function(){return Nu.LinkedMap}});Object.defineProperty(j,"LRUCache",{enumerable:!0,get:function(){return Nu.LRUCache}});Object.defineProperty(j,"Touch",{enumerable:!0,get:function(){return Nu.Touch}});var jR=fu();Object.defineProperty(j,"Disposable",{enumerable:!0,get:function(){return jR.Disposable}});var Tg=Mi();Object.defineProperty(j,"Event",{enumerable:!0,get:function(){return Tg.Event}});Object.defineProperty(j,"Emitter",{enumerable:!0,get:function(){return Tg.Emitter}});var Rg=bu();Object.defineProperty(j,"CancellationTokenSource",{enumerable:!0,get:function(){return Rg.CancellationTokenSource}});Object.defineProperty(j,"CancellationToken",{enumerable:!0,get:function(){return Rg.CancellationToken}});var Ou=cg();Object.defineProperty(j,"MessageReader",{enumerable:!0,get:function(){return Ou.MessageReader}});Object.defineProperty(j,"AbstractMessageReader",{enumerable:!0,get:function(){return Ou.AbstractMessageReader}});Object.defineProperty(j,"ReadableStreamMessageReader",{enumerable:!0,get:function(){return Ou.ReadableStreamMessageReader}});var Lu=gg();Object.defineProperty(j,"MessageWriter",{enumerable:!0,get:function(){return Lu.MessageWriter}});Object.defineProperty(j,"AbstractMessageWriter",{enumerable:!0,get:function(){return Lu.AbstractMessageWriter}});Object.defineProperty(j,"WriteableStreamMessageWriter",{enumerable:!0,get:function(){return Lu.WriteableStreamMessageWriter}});var Ht=Dg();Object.defineProperty(j,"ConnectionStrategy",{enumerable:!0,get:function(){return Ht.ConnectionStrategy}});Object.defineProperty(j,"ConnectionOptions",{enumerable:!0,get:function(){return Ht.ConnectionOptions}});Object.defineProperty(j,"NullLogger",{enumerable:!0,get:function(){return Ht.NullLogger}});Object.defineProperty(j,"createMessageConnection",{enumerable:!0,get:function(){return Ht.createMessageConnection}});Object.defineProperty(j,"ProgressToken",{enumerable:!0,get:function(){return Ht.ProgressToken}});Object.defineProperty(j,"ProgressType",{enumerable:!0,get:function(){return Ht.ProgressType}});Object.defineProperty(j,"Trace",{enumerable:!0,get:function(){return Ht.Trace}});Object.defineProperty(j,"TraceFormat",{enumerable:!0,get:function(){return Ht.TraceFormat}});Object.defineProperty(j,"SetTraceNotification",{enumerable:!0,get:function(){return Ht.SetTraceNotification}});Object.defineProperty(j,"LogTraceNotification",{enumerable:!0,get:function(){return Ht.LogTraceNotification}});Object.defineProperty(j,"ConnectionErrors",{enumerable:!0,get:function(){return Ht.ConnectionErrors}});Object.defineProperty(j,"ConnectionError",{enumerable:!0,get:function(){return Ht.ConnectionError}});Object.defineProperty(j,"CancellationReceiverStrategy",{enumerable:!0,get:function(){return Ht.CancellationReceiverStrategy}});Object.defineProperty(j,"CancellationSenderStrategy",{enumerable:!0,get:function(){return Ht.CancellationSenderStrategy}});Object.defineProperty(j,"CancellationStrategy",{enumerable:!0,get:function(){return Ht.CancellationStrategy}});var WR=fr();j.RAL=WR.default});var ui=F(xe=>{"use strict";var HR=xe&&xe.__createBinding||(Object.create?function(n,e,t,r){r===void 0&&(r=t);var i=Object.getOwnPropertyDescriptor(e,t);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(n,r,i)}:function(n,e,t,r){r===void 0&&(r=t),n[r]=e[t]}),UR=xe&&xe.__exportStar||function(n,e){for(var t in n)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&HR(e,n,t)};Object.defineProperty(xe,"__esModule",{value:!0});xe.createMessageConnection=xe.createServerSocketTransport=xe.createClientSocketTransport=xe.createServerPipeTransport=xe.createClientPipeTransport=xe.generateRandomPipeName=xe.StreamMessageWriter=xe.StreamMessageReader=xe.SocketMessageWriter=xe.SocketMessageReader=xe.IPCMessageWriter=xe.IPCMessageReader=void 0;var ji=qp();ji.default.install();var Yn=Au(),Sg=require("path"),KR=require("os"),zR=require("crypto"),Ca=require("net");UR(Au(),xe);var _g=class extends Yn.AbstractMessageReader{constructor(e){super();this.process=e;let t=this.process;t.on("error",r=>this.fireError(r)),t.on("close",()=>this.fireClose())}listen(e){return this.process.on("message",e),Yn.Disposable.create(()=>this.process.off("message",e))}};xe.IPCMessageReader=_g;var Pg=class extends Yn.AbstractMessageWriter{constructor(e){super();this.process=e,this.errorCount=0;let t=this.process;t.on("error",r=>this.fireError(r)),t.on("close",()=>this.fireClose)}write(e){try{return typeof this.process.send=="function"&&this.process.send(e,void 0,void 0,t=>{t?(this.errorCount++,this.handleError(t,e)):this.errorCount=0}),Promise.resolve()}catch(t){return this.handleError(t,e),Promise.reject(t)}}handleError(e,t){this.errorCount++,this.fireError(e,t,this.errorCount)}end(){}};xe.IPCMessageWriter=Pg;var Wi=class extends Yn.ReadableStreamMessageReader{constructor(e,t="utf-8"){super((0,ji.default)().stream.asReadableStream(e),t)}};xe.SocketMessageReader=Wi;var Hi=class extends Yn.WriteableStreamMessageWriter{constructor(e,t){super((0,ji.default)().stream.asWritableStream(e),t);this.socket=e}dispose(){super.dispose(),this.socket.destroy()}};xe.SocketMessageWriter=Hi;var Mu=class extends Yn.ReadableStreamMessageReader{constructor(e,t){super((0,ji.default)().stream.asReadableStream(e),t)}};xe.StreamMessageReader=Mu;var $u=class extends Yn.WriteableStreamMessageWriter{constructor(e,t){super((0,ji.default)().stream.asWritableStream(e),t)}};xe.StreamMessageWriter=$u;var kg=process.env.XDG_RUNTIME_DIR,VR=new Map([["linux",107],["darwin",103]]);function XR(){let n=(0,zR.randomBytes)(21).toString("hex");if(process.platform==="win32")return`\\\\.\\pipe\\vscode-jsonrpc-${n}-sock`;let e;kg?e=Sg.join(kg,`vscode-ipc-${n}.sock`):e=Sg.join(KR.tmpdir(),`vscode-${n}.sock`);let t=VR.get(process.platform);return t!==void 0&&e.length>=t&&(0,ji.default)().console.warn(`WARNING: IPC handle "${e}" is longer than ${t} characters.`),e}xe.generateRandomPipeName=XR;function BR(n,e="utf-8"){let t,r=new Promise((i,s)=>{t=i});return new Promise((i,s)=>{let o=(0,Ca.createServer)(a=>{o.close(),t([new Wi(a,e),new Hi(a,e)])});o.on("error",s),o.listen(n,()=>{o.removeListener("error",s),i({onConnected:()=>r})})})}xe.createClientPipeTransport=BR;function GR(n,e="utf-8"){let t=(0,Ca.createConnection)(n);return[new Wi(t,e),new Hi(t,e)]}xe.createServerPipeTransport=GR;function QR(n,e="utf-8"){let t,r=new Promise((i,s)=>{t=i});return new Promise((i,s)=>{let o=(0,Ca.createServer)(a=>{o.close(),t([new Wi(a,e),new Hi(a,e)])});o.on("error",s),o.listen(n,"127.0.0.1",()=>{o.removeListener("error",s),i({onConnected:()=>r})})})}xe.createClientSocketTransport=QR;function YR(n,e="utf-8"){let t=(0,Ca.createConnection)(n,"127.0.0.1");return[new Wi(t,e),new Hi(t,e)]}xe.createServerSocketTransport=YR;function JR(n){let e=n;return e.read!==void 0&&e.addListener!==void 0}function ZR(n){let e=n;return e.write!==void 0&&e.addListener!==void 0}function eS(n,e,t,r){t||(t=Yn.NullLogger);let i=JR(n)?new Mu(n):n,s=ZR(e)?new $u(e):e;return Yn.ConnectionStrategy.is(r)&&(r={connectionStrategy:r}),(0,Yn.createMessageConnection)(i,s,t,r)}xe.createMessageConnection=eS});var ju=F((IF,Eg)=>{"use strict";Eg.exports=ui()});var Da=F((xg,ba)=>{(function(n){if(typeof ba=="object"&&typeof ba.exports=="object"){var e=n(require,xg);e!==void 0&&(ba.exports=e)}else typeof define=="function"&&define.amd&&define(["require","exports"],n)})(function(n,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.TextDocument=e.EOL=e.WorkspaceFolder=e.InlayHint=e.InlayHintLabelPart=e.InlayHintKind=e.InlineValueContext=e.InlineValueEvaluatableExpression=e.InlineValueVariableLookup=e.InlineValueText=e.SemanticTokens=e.SemanticTokenModifiers=e.SemanticTokenTypes=e.SelectionRange=e.DocumentLink=e.FormattingOptions=e.CodeLens=e.CodeAction=e.CodeActionContext=e.CodeActionTriggerKind=e.CodeActionKind=e.DocumentSymbol=e.WorkspaceSymbol=e.SymbolInformation=e.SymbolTag=e.SymbolKind=e.DocumentHighlight=e.DocumentHighlightKind=e.SignatureInformation=e.ParameterInformation=e.Hover=e.MarkedString=e.CompletionList=e.CompletionItem=e.CompletionItemLabelDetails=e.InsertTextMode=e.InsertReplaceEdit=e.CompletionItemTag=e.InsertTextFormat=e.CompletionItemKind=e.MarkupContent=e.MarkupKind=e.TextDocumentItem=e.OptionalVersionedTextDocumentIdentifier=e.VersionedTextDocumentIdentifier=e.TextDocumentIdentifier=e.WorkspaceChange=e.WorkspaceEdit=e.DeleteFile=e.RenameFile=e.CreateFile=e.TextDocumentEdit=e.AnnotatedTextEdit=e.ChangeAnnotationIdentifier=e.ChangeAnnotation=e.TextEdit=e.Command=e.Diagnostic=e.CodeDescription=e.DiagnosticTag=e.DiagnosticSeverity=e.DiagnosticRelatedInformation=e.FoldingRange=e.FoldingRangeKind=e.ColorPresentation=e.ColorInformation=e.Color=e.LocationLink=e.Location=e.Range=e.Position=e.uinteger=e.integer=e.URI=e.DocumentUri=void 0;var t;(function(m){function k(E){return typeof E=="string"}m.is=k})(t=e.DocumentUri||(e.DocumentUri={}));var r;(function(m){function k(E){return typeof E=="string"}m.is=k})(r=e.URI||(e.URI={}));var i;(function(m){m.MIN_VALUE=-2147483648,m.MAX_VALUE=2147483647;function k(E){return typeof E=="number"&&m.MIN_VALUE<=E&&E<=m.MAX_VALUE}m.is=k})(i=e.integer||(e.integer={}));var s;(function(m){m.MIN_VALUE=0,m.MAX_VALUE=2147483647;function k(E){return typeof E=="number"&&m.MIN_VALUE<=E&&E<=m.MAX_VALUE}m.is=k})(s=e.uinteger||(e.uinteger={}));var o;(function(m){function k(D,f){return D===Number.MAX_VALUE&&(D=s.MAX_VALUE),f===Number.MAX_VALUE&&(f=s.MAX_VALUE),{line:D,character:f}}m.create=k;function E(D){var f=D;return x.objectLiteral(f)&&x.uinteger(f.line)&&x.uinteger(f.character)}m.is=E})(o=e.Position||(e.Position={}));var a;(function(m){function k(D,f,L,$){if(x.uinteger(D)&&x.uinteger(f)&&x.uinteger(L)&&x.uinteger($))return{start:o.create(D,f),end:o.create(L,$)};if(o.is(D)&&o.is(f))return{start:D,end:f};throw new Error("Range#create called with invalid arguments[".concat(D,", ").concat(f,", ").concat(L,", ").concat($,"]"))}m.create=k;function E(D){var f=D;return x.objectLiteral(f)&&o.is(f.start)&&o.is(f.end)}m.is=E})(a=e.Range||(e.Range={}));var c;(function(m){function k(D,f){return{uri:D,range:f}}m.create=k;function E(D){var f=D;return x.defined(f)&&a.is(f.range)&&(x.string(f.uri)||x.undefined(f.uri))}m.is=E})(c=e.Location||(e.Location={}));var u;(function(m){function k(D,f,L,$){return{targetUri:D,targetRange:f,targetSelectionRange:L,originSelectionRange:$}}m.create=k;function E(D){var f=D;return x.defined(f)&&a.is(f.targetRange)&&x.string(f.targetUri)&&a.is(f.targetSelectionRange)&&(a.is(f.originSelectionRange)||x.undefined(f.originSelectionRange))}m.is=E})(u=e.LocationLink||(e.LocationLink={}));var l;(function(m){function k(D,f,L,$){return{red:D,green:f,blue:L,alpha:$}}m.create=k;function E(D){var f=D;return x.objectLiteral(f)&&x.numberRange(f.red,0,1)&&x.numberRange(f.green,0,1)&&x.numberRange(f.blue,0,1)&&x.numberRange(f.alpha,0,1)}m.is=E})(l=e.Color||(e.Color={}));var h;(function(m){function k(D,f){return{range:D,color:f}}m.create=k;function E(D){var f=D;return x.objectLiteral(f)&&a.is(f.range)&&l.is(f.color)}m.is=E})(h=e.ColorInformation||(e.ColorInformation={}));var p;(function(m){function k(D,f,L){return{label:D,textEdit:f,additionalTextEdits:L}}m.create=k;function E(D){var f=D;return x.objectLiteral(f)&&x.string(f.label)&&(x.undefined(f.textEdit)||N.is(f))&&(x.undefined(f.additionalTextEdits)||x.typedArray(f.additionalTextEdits,N.is))}m.is=E})(p=e.ColorPresentation||(e.ColorPresentation={}));var C;(function(m){m.Comment="comment",m.Imports="imports",m.Region="region"})(C=e.FoldingRangeKind||(e.FoldingRangeKind={}));var T;(function(m){function k(D,f,L,$,ae,ze){var $e={startLine:D,endLine:f};return x.defined(L)&&($e.startCharacter=L),x.defined($)&&($e.endCharacter=$),x.defined(ae)&&($e.kind=ae),x.defined(ze)&&($e.collapsedText=ze),$e}m.create=k;function E(D){var f=D;return x.objectLiteral(f)&&x.uinteger(f.startLine)&&x.uinteger(f.startLine)&&(x.undefined(f.startCharacter)||x.uinteger(f.startCharacter))&&(x.undefined(f.endCharacter)||x.uinteger(f.endCharacter))&&(x.undefined(f.kind)||x.string(f.kind))}m.is=E})(T=e.FoldingRange||(e.FoldingRange={}));var y;(function(m){function k(D,f){return{location:D,message:f}}m.create=k;function E(D){var f=D;return x.defined(f)&&c.is(f.location)&&x.string(f.message)}m.is=E})(y=e.DiagnosticRelatedInformation||(e.DiagnosticRelatedInformation={}));var R;(function(m){m.Error=1,m.Warning=2,m.Information=3,m.Hint=4})(R=e.DiagnosticSeverity||(e.DiagnosticSeverity={}));var S;(function(m){m.Unnecessary=1,m.Deprecated=2})(S=e.DiagnosticTag||(e.DiagnosticTag={}));var v;(function(m){function k(E){var D=E;return x.objectLiteral(D)&&x.string(D.href)}m.is=k})(v=e.CodeDescription||(e.CodeDescription={}));var b;(function(m){function k(D,f,L,$,ae,ze){var $e={range:D,message:f};return x.defined(L)&&($e.severity=L),x.defined($)&&($e.code=$),x.defined(ae)&&($e.source=ae),x.defined(ze)&&($e.relatedInformation=ze),$e}m.create=k;function E(D){var f,L=D;return x.defined(L)&&a.is(L.range)&&x.string(L.message)&&(x.number(L.severity)||x.undefined(L.severity))&&(x.integer(L.code)||x.string(L.code)||x.undefined(L.code))&&(x.undefined(L.codeDescription)||x.string((f=L.codeDescription)===null||f===void 0?void 0:f.href))&&(x.string(L.source)||x.undefined(L.source))&&(x.undefined(L.relatedInformation)||x.typedArray(L.relatedInformation,y.is))}m.is=E})(b=e.Diagnostic||(e.Diagnostic={}));var P;(function(m){function k(D,f){for(var L=[],$=2;$<arguments.length;$++)L[$-2]=arguments[$];var ae={title:D,command:f};return x.defined(L)&&L.length>0&&(ae.arguments=L),ae}m.create=k;function E(D){var f=D;return x.defined(f)&&x.string(f.title)&&x.string(f.command)}m.is=E})(P=e.Command||(e.Command={}));var N;(function(m){function k(L,$){return{range:L,newText:$}}m.replace=k;function E(L,$){return{range:{start:L,end:L},newText:$}}m.insert=E;function D(L){return{range:L,newText:""}}m.del=D;function f(L){var $=L;return x.objectLiteral($)&&x.string($.newText)&&a.is($.range)}m.is=f})(N=e.TextEdit||(e.TextEdit={}));var q;(function(m){function k(D,f,L){var $={label:D};return f!==void 0&&($.needsConfirmation=f),L!==void 0&&($.description=L),$}m.create=k;function E(D){var f=D;return x.objectLiteral(f)&&x.string(f.label)&&(x.boolean(f.needsConfirmation)||f.needsConfirmation===void 0)&&(x.string(f.description)||f.description===void 0)}m.is=E})(q=e.ChangeAnnotation||(e.ChangeAnnotation={}));var O;(function(m){function k(E){var D=E;return x.string(D)}m.is=k})(O=e.ChangeAnnotationIdentifier||(e.ChangeAnnotationIdentifier={}));var H;(function(m){function k(L,$,ae){return{range:L,newText:$,annotationId:ae}}m.replace=k;function E(L,$,ae){return{range:{start:L,end:L},newText:$,annotationId:ae}}m.insert=E;function D(L,$){return{range:L,newText:"",annotationId:$}}m.del=D;function f(L){var $=L;return N.is($)&&(q.is($.annotationId)||O.is($.annotationId))}m.is=f})(H=e.AnnotatedTextEdit||(e.AnnotatedTextEdit={}));var B;(function(m){function k(D,f){return{textDocument:D,edits:f}}m.create=k;function E(D){var f=D;return x.defined(f)&&mt.is(f.textDocument)&&Array.isArray(f.edits)}m.is=E})(B=e.TextDocumentEdit||(e.TextDocumentEdit={}));var Y;(function(m){function k(D,f,L){var $={kind:"create",uri:D};return f!==void 0&&(f.overwrite!==void 0||f.ignoreIfExists!==void 0)&&($.options=f),L!==void 0&&($.annotationId=L),$}m.create=k;function E(D){var f=D;return f&&f.kind==="create"&&x.string(f.uri)&&(f.options===void 0||(f.options.overwrite===void 0||x.boolean(f.options.overwrite))&&(f.options.ignoreIfExists===void 0||x.boolean(f.options.ignoreIfExists)))&&(f.annotationId===void 0||O.is(f.annotationId))}m.is=E})(Y=e.CreateFile||(e.CreateFile={}));var Z;(function(m){function k(D,f,L,$){var ae={kind:"rename",oldUri:D,newUri:f};return L!==void 0&&(L.overwrite!==void 0||L.ignoreIfExists!==void 0)&&(ae.options=L),$!==void 0&&(ae.annotationId=$),ae}m.create=k;function E(D){var f=D;return f&&f.kind==="rename"&&x.string(f.oldUri)&&x.string(f.newUri)&&(f.options===void 0||(f.options.overwrite===void 0||x.boolean(f.options.overwrite))&&(f.options.ignoreIfExists===void 0||x.boolean(f.options.ignoreIfExists)))&&(f.annotationId===void 0||O.is(f.annotationId))}m.is=E})(Z=e.RenameFile||(e.RenameFile={}));var Oe;(function(m){function k(D,f,L){var $={kind:"delete",uri:D};return f!==void 0&&(f.recursive!==void 0||f.ignoreIfNotExists!==void 0)&&($.options=f),L!==void 0&&($.annotationId=L),$}m.create=k;function E(D){var f=D;return f&&f.kind==="delete"&&x.string(f.uri)&&(f.options===void 0||(f.options.recursive===void 0||x.boolean(f.options.recursive))&&(f.options.ignoreIfNotExists===void 0||x.boolean(f.options.ignoreIfNotExists)))&&(f.annotationId===void 0||O.is(f.annotationId))}m.is=E})(Oe=e.DeleteFile||(e.DeleteFile={}));var ot;(function(m){function k(E){var D=E;return D&&(D.changes!==void 0||D.documentChanges!==void 0)&&(D.documentChanges===void 0||D.documentChanges.every(function(f){return x.string(f.kind)?Y.is(f)||Z.is(f)||Oe.is(f):B.is(f)}))}m.is=k})(ot=e.WorkspaceEdit||(e.WorkspaceEdit={}));var Ye=function(){function m(k,E){this.edits=k,this.changeAnnotations=E}return m.prototype.insert=function(k,E,D){var f,L;if(D===void 0?f=N.insert(k,E):O.is(D)?(L=D,f=H.insert(k,E,D)):(this.assertChangeAnnotations(this.changeAnnotations),L=this.changeAnnotations.manage(D),f=H.insert(k,E,L)),this.edits.push(f),L!==void 0)return L},m.prototype.replace=function(k,E,D){var f,L;if(D===void 0?f=N.replace(k,E):O.is(D)?(L=D,f=H.replace(k,E,D)):(this.assertChangeAnnotations(this.changeAnnotations),L=this.changeAnnotations.manage(D),f=H.replace(k,E,L)),this.edits.push(f),L!==void 0)return L},m.prototype.delete=function(k,E){var D,f;if(E===void 0?D=N.del(k):O.is(E)?(f=E,D=H.del(k,E)):(this.assertChangeAnnotations(this.changeAnnotations),f=this.changeAnnotations.manage(E),D=H.del(k,f)),this.edits.push(D),f!==void 0)return f},m.prototype.add=function(k){this.edits.push(k)},m.prototype.all=function(){return this.edits},m.prototype.clear=function(){this.edits.splice(0,this.edits.length)},m.prototype.assertChangeAnnotations=function(k){if(k===void 0)throw new Error("Text edit change is not configured to manage change annotations.")},m}(),He=function(){function m(k){this._annotations=k===void 0?Object.create(null):k,this._counter=0,this._size=0}return m.prototype.all=function(){return this._annotations},Object.defineProperty(m.prototype,"size",{get:function(){return this._size},enumerable:!1,configurable:!0}),m.prototype.manage=function(k,E){var D;if(O.is(k)?D=k:(D=this.nextId(),E=k),this._annotations[D]!==void 0)throw new Error("Id ".concat(D," is already in use."));if(E===void 0)throw new Error("No annotation provided for id ".concat(D));return this._annotations[D]=E,this._size++,D},m.prototype.nextId=function(){return this._counter++,this._counter.toString()},m}(),de=function(){function m(k){var E=this;this._textEditChanges=Object.create(null),k!==void 0?(this._workspaceEdit=k,k.documentChanges?(this._changeAnnotations=new He(k.changeAnnotations),k.changeAnnotations=this._changeAnnotations.all(),k.documentChanges.forEach(function(D){if(B.is(D)){var f=new Ye(D.edits,E._changeAnnotations);E._textEditChanges[D.textDocument.uri]=f}})):k.changes&&Object.keys(k.changes).forEach(function(D){var f=new Ye(k.changes[D]);E._textEditChanges[D]=f})):this._workspaceEdit={}}return Object.defineProperty(m.prototype,"edit",{get:function(){return this.initDocumentChanges(),this._changeAnnotations!==void 0&&(this._changeAnnotations.size===0?this._workspaceEdit.changeAnnotations=void 0:this._workspaceEdit.changeAnnotations=this._changeAnnotations.all()),this._workspaceEdit},enumerable:!1,configurable:!0}),m.prototype.getTextEditChange=function(k){if(mt.is(k)){if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw new Error("Workspace edit is not configured for document changes.");var E={uri:k.uri,version:k.version},D=this._textEditChanges[E.uri];if(!D){var f=[],L={textDocument:E,edits:f};this._workspaceEdit.documentChanges.push(L),D=new Ye(f,this._changeAnnotations),this._textEditChanges[E.uri]=D}return D}else{if(this.initChanges(),this._workspaceEdit.changes===void 0)throw new Error("Workspace edit is not configured for normal text edit changes.");var D=this._textEditChanges[k];if(!D){var f=[];this._workspaceEdit.changes[k]=f,D=new Ye(f),this._textEditChanges[k]=D}return D}},m.prototype.initDocumentChanges=function(){this._workspaceEdit.documentChanges===void 0&&this._workspaceEdit.changes===void 0&&(this._changeAnnotations=new He,this._workspaceEdit.documentChanges=[],this._workspaceEdit.changeAnnotations=this._changeAnnotations.all())},m.prototype.initChanges=function(){this._workspaceEdit.documentChanges===void 0&&this._workspaceEdit.changes===void 0&&(this._workspaceEdit.changes=Object.create(null))},m.prototype.createFile=function(k,E,D){if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw new Error("Workspace edit is not configured for document changes.");var f;q.is(E)||O.is(E)?f=E:D=E;var L,$;if(f===void 0?L=Y.create(k,D):($=O.is(f)?f:this._changeAnnotations.manage(f),L=Y.create(k,D,$)),this._workspaceEdit.documentChanges.push(L),$!==void 0)return $},m.prototype.renameFile=function(k,E,D,f){if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw new Error("Workspace edit is not configured for document changes.");var L;q.is(D)||O.is(D)?L=D:f=D;var $,ae;if(L===void 0?$=Z.create(k,E,f):(ae=O.is(L)?L:this._changeAnnotations.manage(L),$=Z.create(k,E,f,ae)),this._workspaceEdit.documentChanges.push($),ae!==void 0)return ae},m.prototype.deleteFile=function(k,E,D){if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw new Error("Workspace edit is not configured for document changes.");var f;q.is(E)||O.is(E)?f=E:D=E;var L,$;if(f===void 0?L=Oe.create(k,D):($=O.is(f)?f:this._changeAnnotations.manage(f),L=Oe.create(k,D,$)),this._workspaceEdit.documentChanges.push(L),$!==void 0)return $},m}();e.WorkspaceChange=de;var Ue;(function(m){function k(D){return{uri:D}}m.create=k;function E(D){var f=D;return x.defined(f)&&x.string(f.uri)}m.is=E})(Ue=e.TextDocumentIdentifier||(e.TextDocumentIdentifier={}));var je;(function(m){function k(D,f){return{uri:D,version:f}}m.create=k;function E(D){var f=D;return x.defined(f)&&x.string(f.uri)&&x.integer(f.version)}m.is=E})(je=e.VersionedTextDocumentIdentifier||(e.VersionedTextDocumentIdentifier={}));var mt;(function(m){function k(D,f){return{uri:D,version:f}}m.create=k;function E(D){var f=D;return x.defined(f)&&x.string(f.uri)&&(f.version===null||x.integer(f.version))}m.is=E})(mt=e.OptionalVersionedTextDocumentIdentifier||(e.OptionalVersionedTextDocumentIdentifier={}));var Tt;(function(m){function k(D,f,L,$){return{uri:D,languageId:f,version:L,text:$}}m.create=k;function E(D){var f=D;return x.defined(f)&&x.string(f.uri)&&x.string(f.languageId)&&x.integer(f.version)&&x.string(f.text)}m.is=E})(Tt=e.TextDocumentItem||(e.TextDocumentItem={}));var nn;(function(m){m.PlainText="plaintext",m.Markdown="markdown";function k(E){var D=E;return D===m.PlainText||D===m.Markdown}m.is=k})(nn=e.MarkupKind||(e.MarkupKind={}));var ut;(function(m){function k(E){var D=E;return x.objectLiteral(E)&&nn.is(D.kind)&&x.string(D.value)}m.is=k})(ut=e.MarkupContent||(e.MarkupContent={}));var Xr;(function(m){m.Text=1,m.Method=2,m.Function=3,m.Constructor=4,m.Field=5,m.Variable=6,m.Class=7,m.Interface=8,m.Module=9,m.Property=10,m.Unit=11,m.Value=12,m.Enum=13,m.Keyword=14,m.Snippet=15,m.Color=16,m.File=17,m.Reference=18,m.Folder=19,m.EnumMember=20,m.Constant=21,m.Struct=22,m.Event=23,m.Operator=24,m.TypeParameter=25})(Xr=e.CompletionItemKind||(e.CompletionItemKind={}));var Rr;(function(m){m.PlainText=1,m.Snippet=2})(Rr=e.InsertTextFormat||(e.InsertTextFormat={}));var Sr;(function(m){m.Deprecated=1})(Sr=e.CompletionItemTag||(e.CompletionItemTag={}));var rr;(function(m){function k(D,f,L){return{newText:D,insert:f,replace:L}}m.create=k;function E(D){var f=D;return f&&x.string(f.newText)&&a.is(f.insert)&&a.is(f.replace)}m.is=E})(rr=e.InsertReplaceEdit||(e.InsertReplaceEdit={}));var ir;(function(m){m.asIs=1,m.adjustIndentation=2})(ir=e.InsertTextMode||(e.InsertTextMode={}));var Br;(function(m){function k(E){var D=E;return D&&(x.string(D.detail)||D.detail===void 0)&&(x.string(D.description)||D.description===void 0)}m.is=k})(Br=e.CompletionItemLabelDetails||(e.CompletionItemLabelDetails={}));var _r;(function(m){function k(E){return{label:E}}m.create=k})(_r=e.CompletionItem||(e.CompletionItem={}));var Pr;(function(m){function k(E,D){return{items:E||[],isIncomplete:!!D}}m.create=k})(Pr=e.CompletionList||(e.CompletionList={}));var xt;(function(m){function k(D){return D.replace(/[\\`*_{}[\]()#+\-.!]/g,"\\$&")}m.fromPlainText=k;function E(D){var f=D;return x.string(f)||x.objectLiteral(f)&&x.string(f.language)&&x.string(f.value)}m.is=E})(xt=e.MarkedString||(e.MarkedString={}));var dn;(function(m){function k(E){var D=E;return!!D&&x.objectLiteral(D)&&(ut.is(D.contents)||xt.is(D.contents)||x.typedArray(D.contents,xt.is))&&(E.range===void 0||a.is(E.range))}m.is=k})(dn=e.Hover||(e.Hover={}));var kr;(function(m){function k(E,D){return D?{label:E,documentation:D}:{label:E}}m.create=k})(kr=e.ParameterInformation||(e.ParameterInformation={}));var rn;(function(m){function k(E,D){for(var f=[],L=2;L<arguments.length;L++)f[L-2]=arguments[L];var $={label:E};return x.defined(D)&&($.documentation=D),x.defined(f)?$.parameters=f:$.parameters=[],$}m.create=k})(rn=e.SignatureInformation||(e.SignatureInformation={}));var sr;(function(m){m.Text=1,m.Read=2,m.Write=3})(sr=e.DocumentHighlightKind||(e.DocumentHighlightKind={}));var Vn;(function(m){function k(E,D){var f={range:E};return x.number(D)&&(f.kind=D),f}m.create=k})(Vn=e.DocumentHighlight||(e.DocumentHighlight={}));var sn;(function(m){m.File=1,m.Module=2,m.Namespace=3,m.Package=4,m.Class=5,m.Method=6,m.Property=7,m.Field=8,m.Constructor=9,m.Enum=10,m.Interface=11,m.Function=12,m.Variable=13,m.Constant=14,m.String=15,m.Number=16,m.Boolean=17,m.Array=18,m.Object=19,m.Key=20,m.Null=21,m.EnumMember=22,m.Struct=23,m.Event=24,m.Operator=25,m.TypeParameter=26})(sn=e.SymbolKind||(e.SymbolKind={}));var Vt;(function(m){m.Deprecated=1})(Vt=e.SymbolTag||(e.SymbolTag={}));var lt;(function(m){function k(E,D,f,L,$){var ae={name:E,kind:D,location:{uri:L,range:f}};return $&&(ae.containerName=$),ae}m.create=k})(lt=e.SymbolInformation||(e.SymbolInformation={}));var Gr;(function(m){function k(E,D,f,L){return L!==void 0?{name:E,kind:D,location:{uri:f,range:L}}:{name:E,kind:D,location:{uri:f}}}m.create=k})(Gr=e.WorkspaceSymbol||(e.WorkspaceSymbol={}));var Mt;(function(m){function k(D,f,L,$,ae,ze){var $e={name:D,detail:f,kind:L,range:$,selectionRange:ae};return ze!==void 0&&($e.children=ze),$e}m.create=k;function E(D){var f=D;return f&&x.string(f.name)&&x.number(f.kind)&&a.is(f.range)&&a.is(f.selectionRange)&&(f.detail===void 0||x.string(f.detail))&&(f.deprecated===void 0||x.boolean(f.deprecated))&&(f.children===void 0||Array.isArray(f.children))&&(f.tags===void 0||Array.isArray(f.tags))}m.is=E})(Mt=e.DocumentSymbol||(e.DocumentSymbol={}));var on;(function(m){m.Empty="",m.QuickFix="quickfix",m.Refactor="refactor",m.RefactorExtract="refactor.extract",m.RefactorInline="refactor.inline",m.RefactorRewrite="refactor.rewrite",m.Source="source",m.SourceOrganizeImports="source.organizeImports",m.SourceFixAll="source.fixAll"})(on=e.CodeActionKind||(e.CodeActionKind={}));var Xn;(function(m){m.Invoked=1,m.Automatic=2})(Xn=e.CodeActionTriggerKind||(e.CodeActionTriggerKind={}));var or;(function(m){function k(D,f,L){var $={diagnostics:D};return f!=null&&($.only=f),L!=null&&($.triggerKind=L),$}m.create=k;function E(D){var f=D;return x.defined(f)&&x.typedArray(f.diagnostics,b.is)&&(f.only===void 0||x.typedArray(f.only,x.string))&&(f.triggerKind===void 0||f.triggerKind===Xn.Invoked||f.triggerKind===Xn.Automatic)}m.is=E})(or=e.CodeActionContext||(e.CodeActionContext={}));var ar;(function(m){function k(D,f,L){var $={title:D},ae=!0;return typeof f=="string"?(ae=!1,$.kind=f):P.is(f)?$.command=f:$.edit=f,ae&&L!==void 0&&($.kind=L),$}m.create=k;function E(D){var f=D;return f&&x.string(f.title)&&(f.diagnostics===void 0||x.typedArray(f.diagnostics,b.is))&&(f.kind===void 0||x.string(f.kind))&&(f.edit!==void 0||f.command!==void 0)&&(f.command===void 0||P.is(f.command))&&(f.isPreferred===void 0||x.boolean(f.isPreferred))&&(f.edit===void 0||ot.is(f.edit))}m.is=E})(ar=e.CodeAction||(e.CodeAction={}));var an;(function(m){function k(D,f){var L={range:D};return x.defined(f)&&(L.data=f),L}m.create=k;function E(D){var f=D;return x.defined(f)&&a.is(f.range)&&(x.undefined(f.command)||P.is(f.command))}m.is=E})(an=e.CodeLens||(e.CodeLens={}));var fn;(function(m){function k(D,f){return{tabSize:D,insertSpaces:f}}m.create=k;function E(D){var f=D;return x.defined(f)&&x.uinteger(f.tabSize)&&x.boolean(f.insertSpaces)}m.is=E})(fn=e.FormattingOptions||(e.FormattingOptions={}));var _;(function(m){function k(D,f,L){return{range:D,target:f,data:L}}m.create=k;function E(D){var f=D;return x.defined(f)&&a.is(f.range)&&(x.undefined(f.target)||x.string(f.target))}m.is=E})(_=e.DocumentLink||(e.DocumentLink={}));var M;(function(m){function k(D,f){return{range:D,parent:f}}m.create=k;function E(D){var f=D;return x.objectLiteral(f)&&a.is(f.range)&&(f.parent===void 0||m.is(f.parent))}m.is=E})(M=e.SelectionRange||(e.SelectionRange={}));var U;(function(m){m.namespace="namespace",m.type="type",m.class="class",m.enum="enum",m.interface="interface",m.struct="struct",m.typeParameter="typeParameter",m.parameter="parameter",m.variable="variable",m.property="property",m.enumMember="enumMember",m.event="event",m.function="function",m.method="method",m.macro="macro",m.keyword="keyword",m.modifier="modifier",m.comment="comment",m.string="string",m.number="number",m.regexp="regexp",m.operator="operator",m.decorator="decorator"})(U=e.SemanticTokenTypes||(e.SemanticTokenTypes={}));var X;(function(m){m.declaration="declaration",m.definition="definition",m.readonly="readonly",m.static="static",m.deprecated="deprecated",m.abstract="abstract",m.async="async",m.modification="modification",m.documentation="documentation",m.defaultLibrary="defaultLibrary"})(X=e.SemanticTokenModifiers||(e.SemanticTokenModifiers={}));var Te;(function(m){function k(E){var D=E;return x.objectLiteral(D)&&(D.resultId===void 0||typeof D.resultId=="string")&&Array.isArray(D.data)&&(D.data.length===0||typeof D.data[0]=="number")}m.is=k})(Te=e.SemanticTokens||(e.SemanticTokens={}));var Re;(function(m){function k(D,f){return{range:D,text:f}}m.create=k;function E(D){var f=D;return f!=null&&a.is(f.range)&&x.string(f.text)}m.is=E})(Re=e.InlineValueText||(e.InlineValueText={}));var Se;(function(m){function k(D,f,L){return{range:D,variableName:f,caseSensitiveLookup:L}}m.create=k;function E(D){var f=D;return f!=null&&a.is(f.range)&&x.boolean(f.caseSensitiveLookup)&&(x.string(f.variableName)||f.variableName===void 0)}m.is=E})(Se=e.InlineValueVariableLookup||(e.InlineValueVariableLookup={}));var Ke;(function(m){function k(D,f){return{range:D,expression:f}}m.create=k;function E(D){var f=D;return f!=null&&a.is(f.range)&&(x.string(f.expression)||f.expression===void 0)}m.is=E})(Ke=e.InlineValueEvaluatableExpression||(e.InlineValueEvaluatableExpression={}));var ge;(function(m){function k(D,f){return{frameId:D,stoppedLocation:f}}m.create=k;function E(D){var f=D;return x.defined(f)&&a.is(D.stoppedLocation)}m.is=E})(ge=e.InlineValueContext||(e.InlineValueContext={}));var Ee;(function(m){m.Type=1,m.Parameter=2;function k(E){return E===1||E===2}m.is=k})(Ee=e.InlayHintKind||(e.InlayHintKind={}));var me;(function(m){function k(D){return{value:D}}m.create=k;function E(D){var f=D;return x.objectLiteral(f)&&(f.tooltip===void 0||x.string(f.tooltip)||ut.is(f.tooltip))&&(f.location===void 0||c.is(f.location))&&(f.command===void 0||P.is(f.command))}m.is=E})(me=e.InlayHintLabelPart||(e.InlayHintLabelPart={}));var g;(function(m){function k(D,f,L){var $={position:D,label:f};return L!==void 0&&($.kind=L),$}m.create=k;function E(D){var f=D;return x.objectLiteral(f)&&o.is(f.position)&&(x.string(f.label)||x.typedArray(f.label,me.is))&&(f.kind===void 0||Ee.is(f.kind))&&f.textEdits===void 0||x.typedArray(f.textEdits,N.is)&&(f.tooltip===void 0||x.string(f.tooltip)||ut.is(f.tooltip))&&(f.paddingLeft===void 0||x.boolean(f.paddingLeft))&&(f.paddingRight===void 0||x.boolean(f.paddingRight))}m.is=E})(g=e.InlayHint||(e.InlayHint={}));var A;(function(m){function k(E){var D=E;return x.objectLiteral(D)&&r.is(D.uri)&&x.string(D.name)}m.is=k})(A=e.WorkspaceFolder||(e.WorkspaceFolder={})),e.EOL=[`
`,`\r
`,"\r"];var V;(function(m){function k(L,$,ae,ze){return new he(L,$,ae,ze)}m.create=k;function E(L){var $=L;return!!(x.defined($)&&x.string($.uri)&&(x.undefined($.languageId)||x.string($.languageId))&&x.uinteger($.lineCount)&&x.func($.getText)&&x.func($.positionAt)&&x.func($.offsetAt))}m.is=E;function D(L,$){for(var ae=L.getText(),ze=f($,function(Er,_i){var ms=Er.range.start.line-_i.range.start.line;return ms===0?Er.range.start.character-_i.range.start.character:ms}),$e=ae.length,cn=ze.length-1;cn>=0;cn--){var Xt=ze[cn],kn=L.offsetAt(Xt.range.start),ye=L.offsetAt(Xt.range.end);if(ye<=$e)ae=ae.substring(0,kn)+Xt.newText+ae.substring(ye,ae.length);else throw new Error("Overlapping edit");$e=kn}return ae}m.applyEdits=D;function f(L,$){if(L.length<=1)return L;var ae=L.length/2|0,ze=L.slice(0,ae),$e=L.slice(ae);f(ze,$),f($e,$);for(var cn=0,Xt=0,kn=0;cn<ze.length&&Xt<$e.length;){var ye=$(ze[cn],$e[Xt]);ye<=0?L[kn++]=ze[cn++]:L[kn++]=$e[Xt++]}for(;cn<ze.length;)L[kn++]=ze[cn++];for(;Xt<$e.length;)L[kn++]=$e[Xt++];return L}})(V=e.TextDocument||(e.TextDocument={}));var he=function(){function m(k,E,D,f){this._uri=k,this._languageId=E,this._version=D,this._content=f,this._lineOffsets=void 0}return Object.defineProperty(m.prototype,"uri",{get:function(){return this._uri},enumerable:!1,configurable:!0}),Object.defineProperty(m.prototype,"languageId",{get:function(){return this._languageId},enumerable:!1,configurable:!0}),Object.defineProperty(m.prototype,"version",{get:function(){return this._version},enumerable:!1,configurable:!0}),m.prototype.getText=function(k){if(k){var E=this.offsetAt(k.start),D=this.offsetAt(k.end);return this._content.substring(E,D)}return this._content},m.prototype.update=function(k,E){this._content=k.text,this._version=E,this._lineOffsets=void 0},m.prototype.getLineOffsets=function(){if(this._lineOffsets===void 0){for(var k=[],E=this._content,D=!0,f=0;f<E.length;f++){D&&(k.push(f),D=!1);var L=E.charAt(f);D=L==="\r"||L===`
`,L==="\r"&&f+1<E.length&&E.charAt(f+1)===`
`&&f++}D&&E.length>0&&k.push(E.length),this._lineOffsets=k}return this._lineOffsets},m.prototype.positionAt=function(k){k=Math.max(Math.min(k,this._content.length),0);var E=this.getLineOffsets(),D=0,f=E.length;if(f===0)return o.create(0,k);for(;D<f;){var L=Math.floor((D+f)/2);E[L]>k?f=L:D=L+1}var $=D-1;return o.create($,k-E[$])},m.prototype.offsetAt=function(k){var E=this.getLineOffsets();if(k.line>=E.length)return this._content.length;if(k.line<0)return 0;var D=E[k.line],f=k.line+1<E.length?E[k.line+1]:this._content.length;return Math.max(Math.min(D+k.character,f),D)},Object.defineProperty(m.prototype,"lineCount",{get:function(){return this.getLineOffsets().length},enumerable:!1,configurable:!0}),m}(),x;(function(m){var k=Object.prototype.toString;function E(ye){return typeof ye!="undefined"}m.defined=E;function D(ye){return typeof ye=="undefined"}m.undefined=D;function f(ye){return ye===!0||ye===!1}m.boolean=f;function L(ye){return k.call(ye)==="[object String]"}m.string=L;function $(ye){return k.call(ye)==="[object Number]"}m.number=$;function ae(ye,Er,_i){return k.call(ye)==="[object Number]"&&Er<=ye&&ye<=_i}m.numberRange=ae;function ze(ye){return k.call(ye)==="[object Number]"&&-2147483648<=ye&&ye<=2147483647}m.integer=ze;function $e(ye){return k.call(ye)==="[object Number]"&&0<=ye&&ye<=2147483647}m.uinteger=$e;function cn(ye){return k.call(ye)==="[object Function]"}m.func=cn;function Xt(ye){return ye!==null&&typeof ye=="object"}m.objectLiteral=Xt;function kn(ye,Er){return Array.isArray(ye)&&ye.every(Er)}m.typedArray=kn})(x||(x={}))})});var Je=F(yn=>{"use strict";Object.defineProperty(yn,"__esModule",{value:!0});yn.ProtocolNotificationType=yn.ProtocolNotificationType0=yn.ProtocolRequestType=yn.ProtocolRequestType0=yn.RegistrationType=void 0;var Ui=ui(),qg=class{constructor(e){this.method=e}};yn.RegistrationType=qg;var Ig=class extends Ui.RequestType0{constructor(e){super(e)}};yn.ProtocolRequestType0=Ig;var Fg=class extends Ui.RequestType{constructor(e){super(e,Ui.ParameterStructures.byName)}};yn.ProtocolRequestType=Fg;var Ng=class extends Ui.NotificationType0{constructor(e){super(e)}};yn.ProtocolNotificationType0=Ng;var Og=class extends Ui.NotificationType{constructor(e){super(e,Ui.ParameterStructures.byName)}};yn.ProtocolNotificationType=Og});var Ta=F(ft=>{"use strict";Object.defineProperty(ft,"__esModule",{value:!0});ft.objectLiteral=ft.typedArray=ft.stringArray=ft.array=ft.func=ft.error=ft.number=ft.string=ft.boolean=void 0;function tS(n){return n===!0||n===!1}ft.boolean=tS;function Lg(n){return typeof n=="string"||n instanceof String}ft.string=Lg;function nS(n){return typeof n=="number"||n instanceof Number}ft.number=nS;function rS(n){return n instanceof Error}ft.error=rS;function iS(n){return typeof n=="function"}ft.func=iS;function Ag(n){return Array.isArray(n)}ft.array=Ag;function sS(n){return Ag(n)&&n.every(e=>Lg(e))}ft.stringArray=sS;function oS(n,e){return Array.isArray(n)&&n.every(e)}ft.typedArray=oS;function aS(n){return n!==null&&typeof n=="object"}ft.objectLiteral=aS});var Mg=F(Ks=>{"use strict";Object.defineProperty(Ks,"__esModule",{value:!0});Ks.ImplementationRequest=void 0;var cS=Je(),uS;(function(n){n.method="textDocument/implementation",n.type=new cS.ProtocolRequestType(n.method)})(uS=Ks.ImplementationRequest||(Ks.ImplementationRequest={}))});var $g=F(zs=>{"use strict";Object.defineProperty(zs,"__esModule",{value:!0});zs.TypeDefinitionRequest=void 0;var lS=Je(),dS;(function(n){n.method="textDocument/typeDefinition",n.type=new lS.ProtocolRequestType(n.method)})(dS=zs.TypeDefinitionRequest||(zs.TypeDefinitionRequest={}))});var Wg=F(Lr=>{"use strict";Object.defineProperty(Lr,"__esModule",{value:!0});Lr.DidChangeWorkspaceFoldersNotification=Lr.WorkspaceFoldersRequest=void 0;var jg=Je(),fS;(function(n){n.type=new jg.ProtocolRequestType0("workspace/workspaceFolders")})(fS=Lr.WorkspaceFoldersRequest||(Lr.WorkspaceFoldersRequest={}));var hS;(function(n){n.type=new jg.ProtocolNotificationType("workspace/didChangeWorkspaceFolders")})(hS=Lr.DidChangeWorkspaceFoldersNotification||(Lr.DidChangeWorkspaceFoldersNotification={}))});var Hg=F(Vs=>{"use strict";Object.defineProperty(Vs,"__esModule",{value:!0});Vs.ConfigurationRequest=void 0;var pS=Je(),gS;(function(n){n.type=new pS.ProtocolRequestType("workspace/configuration")})(gS=Vs.ConfigurationRequest||(Vs.ConfigurationRequest={}))});var Kg=F(Ar=>{"use strict";Object.defineProperty(Ar,"__esModule",{value:!0});Ar.ColorPresentationRequest=Ar.DocumentColorRequest=void 0;var Ug=Je(),mS;(function(n){n.method="textDocument/documentColor",n.type=new Ug.ProtocolRequestType(n.method)})(mS=Ar.DocumentColorRequest||(Ar.DocumentColorRequest={}));var vS;(function(n){n.type=new Ug.ProtocolRequestType("textDocument/colorPresentation")})(vS=Ar.ColorPresentationRequest||(Ar.ColorPresentationRequest={}))});var zg=F(Xs=>{"use strict";Object.defineProperty(Xs,"__esModule",{value:!0});Xs.FoldingRangeRequest=void 0;var yS=Je(),wS;(function(n){n.method="textDocument/foldingRange",n.type=new yS.ProtocolRequestType(n.method)})(wS=Xs.FoldingRangeRequest||(Xs.FoldingRangeRequest={}))});var Vg=F(Bs=>{"use strict";Object.defineProperty(Bs,"__esModule",{value:!0});Bs.DeclarationRequest=void 0;var CS=Je(),bS;(function(n){n.method="textDocument/declaration",n.type=new CS.ProtocolRequestType(n.method)})(bS=Bs.DeclarationRequest||(Bs.DeclarationRequest={}))});var Xg=F(Gs=>{"use strict";Object.defineProperty(Gs,"__esModule",{value:!0});Gs.SelectionRangeRequest=void 0;var DS=Je(),TS;(function(n){n.method="textDocument/selectionRange",n.type=new DS.ProtocolRequestType(n.method)})(TS=Gs.SelectionRangeRequest||(Gs.SelectionRangeRequest={}))});var Gg=F(On=>{"use strict";Object.defineProperty(On,"__esModule",{value:!0});On.WorkDoneProgressCancelNotification=On.WorkDoneProgressCreateRequest=On.WorkDoneProgress=void 0;var RS=ui(),Bg=Je(),SS;(function(n){n.type=new RS.ProgressType;function e(t){return t===n.type}n.is=e})(SS=On.WorkDoneProgress||(On.WorkDoneProgress={}));var _S;(function(n){n.method="window/workDoneProgress/create",n.type=new Bg.ProtocolRequestType(n.method)})(_S=On.WorkDoneProgressCreateRequest||(On.WorkDoneProgressCreateRequest={}));var PS;(function(n){n.method="window/workDoneProgress/cancel",n.type=new Bg.ProtocolNotificationType(n.method)})(PS=On.WorkDoneProgressCancelNotification||(On.WorkDoneProgressCancelNotification={}))});var Qg=F(Ln=>{"use strict";Object.defineProperty(Ln,"__esModule",{value:!0});Ln.CallHierarchyOutgoingCallsRequest=Ln.CallHierarchyIncomingCallsRequest=Ln.CallHierarchyPrepareRequest=void 0;var Wu=Je(),kS;(function(n){n.method="textDocument/prepareCallHierarchy",n.type=new Wu.ProtocolRequestType(n.method)})(kS=Ln.CallHierarchyPrepareRequest||(Ln.CallHierarchyPrepareRequest={}));var ES;(function(n){n.method="callHierarchy/incomingCalls",n.type=new Wu.ProtocolRequestType(n.method)})(ES=Ln.CallHierarchyIncomingCallsRequest||(Ln.CallHierarchyIncomingCallsRequest={}));var xS;(function(n){n.method="callHierarchy/outgoingCalls",n.type=new Wu.ProtocolRequestType(n.method)})(xS=Ln.CallHierarchyOutgoingCallsRequest||(Ln.CallHierarchyOutgoingCallsRequest={}))});var Yg=F(ht=>{"use strict";Object.defineProperty(ht,"__esModule",{value:!0});ht.SemanticTokensRefreshRequest=ht.SemanticTokensRangeRequest=ht.SemanticTokensDeltaRequest=ht.SemanticTokensRequest=ht.SemanticTokensRegistrationType=ht.TokenFormat=void 0;var Qs=Je(),qS;(function(n){n.Relative="relative"})(qS=ht.TokenFormat||(ht.TokenFormat={}));var IS;(function(n){n.method="textDocument/semanticTokens",n.type=new Qs.RegistrationType(n.method)})(IS=ht.SemanticTokensRegistrationType||(ht.SemanticTokensRegistrationType={}));var FS;(function(n){n.method="textDocument/semanticTokens/full",n.type=new Qs.ProtocolRequestType(n.method)})(FS=ht.SemanticTokensRequest||(ht.SemanticTokensRequest={}));var NS;(function(n){n.method="textDocument/semanticTokens/full/delta",n.type=new Qs.ProtocolRequestType(n.method)})(NS=ht.SemanticTokensDeltaRequest||(ht.SemanticTokensDeltaRequest={}));var OS;(function(n){n.method="textDocument/semanticTokens/range",n.type=new Qs.ProtocolRequestType(n.method)})(OS=ht.SemanticTokensRangeRequest||(ht.SemanticTokensRangeRequest={}));var LS;(function(n){n.method="workspace/semanticTokens/refresh",n.type=new Qs.ProtocolRequestType0(n.method)})(LS=ht.SemanticTokensRefreshRequest||(ht.SemanticTokensRefreshRequest={}))});var Jg=F(Ys=>{"use strict";Object.defineProperty(Ys,"__esModule",{value:!0});Ys.ShowDocumentRequest=void 0;var AS=Je(),MS;(function(n){n.method="window/showDocument",n.type=new AS.ProtocolRequestType(n.method)})(MS=Ys.ShowDocumentRequest||(Ys.ShowDocumentRequest={}))});var Zg=F(Js=>{"use strict";Object.defineProperty(Js,"__esModule",{value:!0});Js.LinkedEditingRangeRequest=void 0;var $S=Je(),jS;(function(n){n.method="textDocument/linkedEditingRange",n.type=new $S.ProtocolRequestType(n.method)})(jS=Js.LinkedEditingRangeRequest||(Js.LinkedEditingRangeRequest={}))});var em=F(Ze=>{"use strict";Object.defineProperty(Ze,"__esModule",{value:!0});Ze.WillDeleteFilesRequest=Ze.DidDeleteFilesNotification=Ze.DidRenameFilesNotification=Ze.WillRenameFilesRequest=Ze.DidCreateFilesNotification=Ze.WillCreateFilesRequest=Ze.FileOperationPatternKind=void 0;var Ki=Je(),WS;(function(n){n.file="file",n.folder="folder"})(WS=Ze.FileOperationPatternKind||(Ze.FileOperationPatternKind={}));var HS;(function(n){n.method="workspace/willCreateFiles",n.type=new Ki.ProtocolRequestType(n.method)})(HS=Ze.WillCreateFilesRequest||(Ze.WillCreateFilesRequest={}));var US;(function(n){n.method="workspace/didCreateFiles",n.type=new Ki.ProtocolNotificationType(n.method)})(US=Ze.DidCreateFilesNotification||(Ze.DidCreateFilesNotification={}));var KS;(function(n){n.method="workspace/willRenameFiles",n.type=new Ki.ProtocolRequestType(n.method)})(KS=Ze.WillRenameFilesRequest||(Ze.WillRenameFilesRequest={}));var zS;(function(n){n.method="workspace/didRenameFiles",n.type=new Ki.ProtocolNotificationType(n.method)})(zS=Ze.DidRenameFilesNotification||(Ze.DidRenameFilesNotification={}));var VS;(function(n){n.method="workspace/didDeleteFiles",n.type=new Ki.ProtocolNotificationType(n.method)})(VS=Ze.DidDeleteFilesNotification||(Ze.DidDeleteFilesNotification={}));var XS;(function(n){n.method="workspace/willDeleteFiles",n.type=new Ki.ProtocolRequestType(n.method)})(XS=Ze.WillDeleteFilesRequest||(Ze.WillDeleteFilesRequest={}))});var tm=F(An=>{"use strict";Object.defineProperty(An,"__esModule",{value:!0});An.MonikerRequest=An.MonikerKind=An.UniquenessLevel=void 0;var BS=Je(),GS;(function(n){n.document="document",n.project="project",n.group="group",n.scheme="scheme",n.global="global"})(GS=An.UniquenessLevel||(An.UniquenessLevel={}));var QS;(function(n){n.$import="import",n.$export="export",n.local="local"})(QS=An.MonikerKind||(An.MonikerKind={}));var YS;(function(n){n.method="textDocument/moniker",n.type=new BS.ProtocolRequestType(n.method)})(YS=An.MonikerRequest||(An.MonikerRequest={}))});var nm=F(Mn=>{"use strict";Object.defineProperty(Mn,"__esModule",{value:!0});Mn.TypeHierarchySubtypesRequest=Mn.TypeHierarchySupertypesRequest=Mn.TypeHierarchyPrepareRequest=void 0;var Hu=Je(),JS;(function(n){n.method="textDocument/prepareTypeHierarchy",n.type=new Hu.ProtocolRequestType(n.method)})(JS=Mn.TypeHierarchyPrepareRequest||(Mn.TypeHierarchyPrepareRequest={}));var ZS;(function(n){n.method="typeHierarchy/supertypes",n.type=new Hu.ProtocolRequestType(n.method)})(ZS=Mn.TypeHierarchySupertypesRequest||(Mn.TypeHierarchySupertypesRequest={}));var e_;(function(n){n.method="typeHierarchy/subtypes",n.type=new Hu.ProtocolRequestType(n.method)})(e_=Mn.TypeHierarchySubtypesRequest||(Mn.TypeHierarchySubtypesRequest={}))});var im=F(Mr=>{"use strict";Object.defineProperty(Mr,"__esModule",{value:!0});Mr.InlineValueRefreshRequest=Mr.InlineValueRequest=void 0;var rm=Je(),t_;(function(n){n.method="textDocument/inlineValue",n.type=new rm.ProtocolRequestType(n.method)})(t_=Mr.InlineValueRequest||(Mr.InlineValueRequest={}));var n_;(function(n){n.method="workspace/inlineValue/refresh",n.type=new rm.ProtocolRequestType0(n.method)})(n_=Mr.InlineValueRefreshRequest||(Mr.InlineValueRefreshRequest={}))});var sm=F($n=>{"use strict";Object.defineProperty($n,"__esModule",{value:!0});$n.InlayHintRefreshRequest=$n.InlayHintResolveRequest=$n.InlayHintRequest=void 0;var Uu=Je(),r_;(function(n){n.method="textDocument/inlayHint",n.type=new Uu.ProtocolRequestType(n.method)})(r_=$n.InlayHintRequest||($n.InlayHintRequest={}));var i_;(function(n){n.method="inlayHint/resolve",n.type=new Uu.ProtocolRequestType(n.method)})(i_=$n.InlayHintResolveRequest||($n.InlayHintResolveRequest={}));var s_;(function(n){n.method="workspace/inlayHint/refresh",n.type=new Uu.ProtocolRequestType0(n.method)})(s_=$n.InlayHintRefreshRequest||($n.InlayHintRefreshRequest={}))});var am=F(kt=>{"use strict";Object.defineProperty(kt,"__esModule",{value:!0});kt.DiagnosticRefreshRequest=kt.WorkspaceDiagnosticRequest=kt.DocumentDiagnosticRequest=kt.DocumentDiagnosticReportKind=kt.DiagnosticServerCancellationData=void 0;var om=ui(),o_=Ta(),Ku=Je(),a_;(function(n){function e(t){let r=t;return r&&o_.boolean(r.retriggerRequest)}n.is=e})(a_=kt.DiagnosticServerCancellationData||(kt.DiagnosticServerCancellationData={}));var c_;(function(n){n.Full="full",n.Unchanged="unchanged"})(c_=kt.DocumentDiagnosticReportKind||(kt.DocumentDiagnosticReportKind={}));var u_;(function(n){n.method="textDocument/diagnostic",n.type=new Ku.ProtocolRequestType(n.method),n.partialResult=new om.ProgressType})(u_=kt.DocumentDiagnosticRequest||(kt.DocumentDiagnosticRequest={}));var l_;(function(n){n.method="workspace/diagnostic",n.type=new Ku.ProtocolRequestType(n.method),n.partialResult=new om.ProgressType})(l_=kt.WorkspaceDiagnosticRequest||(kt.WorkspaceDiagnosticRequest={}));var d_;(function(n){n.method="workspace/diagnostic/refresh",n.type=new Ku.ProtocolRequestType0(n.method)})(d_=kt.DiagnosticRefreshRequest||(kt.DiagnosticRefreshRequest={}))});var lm=F(ke=>{"use strict";Object.defineProperty(ke,"__esModule",{value:!0});ke.DidCloseNotebookDocumentNotification=ke.DidSaveNotebookDocumentNotification=ke.DidChangeNotebookDocumentNotification=ke.NotebookCellArrayChange=ke.DidOpenNotebookDocumentNotification=ke.NotebookDocumentSyncRegistrationType=ke.NotebookDocument=ke.NotebookCell=ke.ExecutionSummary=ke.NotebookCellKind=void 0;var Zs=Da(),jn=Ta(),eo=Je(),cm;(function(n){n.Markup=1,n.Code=2;function e(t){return t===1||t===2}n.is=e})(cm=ke.NotebookCellKind||(ke.NotebookCellKind={}));var um;(function(n){function e(i,s){let o={executionOrder:i};return(s===!0||s===!1)&&(o.success=s),o}n.create=e;function t(i){let s=i;return jn.objectLiteral(s)&&Zs.uinteger.is(s.executionOrder)&&(s.success===void 0||jn.boolean(s.success))}n.is=t;function r(i,s){return i===s?!0:i==null||s===null||s===void 0?!1:i.executionOrder===s.executionOrder&&i.success===s.success}n.equals=r})(um=ke.ExecutionSummary||(ke.ExecutionSummary={}));var zu;(function(n){function e(s,o){return{kind:s,document:o}}n.create=e;function t(s){let o=s;return jn.objectLiteral(o)&&cm.is(o.kind)&&Zs.DocumentUri.is(o.document)&&(o.metadata===void 0||jn.objectLiteral(o.metadata))}n.is=t;function r(s,o){let a=new Set;return s.document!==o.document&&a.add("document"),s.kind!==o.kind&&a.add("kind"),s.executionSummary!==o.executionSummary&&a.add("executionSummary"),(s.metadata!==void 0||o.metadata!==void 0)&&!i(s.metadata,o.metadata)&&a.add("metadata"),(s.executionSummary!==void 0||o.executionSummary!==void 0)&&!um.equals(s.executionSummary,o.executionSummary)&&a.add("executionSummary"),a}n.diff=r;function i(s,o){if(s===o)return!0;if(s==null||o===null||o===void 0||typeof s!=typeof o||typeof s!="object")return!1;let a=Array.isArray(s),c=Array.isArray(o);if(a!==c)return!1;if(a&&c){if(s.length!==o.length)return!1;for(let u=0;u<s.length;u++)if(!i(s[u],o[u]))return!1}if(jn.objectLiteral(s)&&jn.objectLiteral(o)){let u=Object.keys(s),l=Object.keys(o);if(u.length!==l.length||(u.sort(),l.sort(),!i(u,l)))return!1;for(let h=0;h<u.length;h++){let p=u[h];if(!i(s[p],o[p]))return!1}}return!0}})(zu=ke.NotebookCell||(ke.NotebookCell={}));var f_;(function(n){function e(r,i,s,o){return{uri:r,notebookType:i,version:s,cells:o}}n.create=e;function t(r){let i=r;return jn.objectLiteral(i)&&jn.string(i.uri)&&Zs.integer.is(i.version)&&jn.typedArray(i.cells,zu.is)}n.is=t})(f_=ke.NotebookDocument||(ke.NotebookDocument={}));var h_;(function(n){n.method="notebookDocument/sync",n.type=new eo.RegistrationType(n.method)})(h_=ke.NotebookDocumentSyncRegistrationType||(ke.NotebookDocumentSyncRegistrationType={}));var p_;(function(n){n.method="notebookDocument/didOpen",n.type=new eo.ProtocolNotificationType(n.method)})(p_=ke.DidOpenNotebookDocumentNotification||(ke.DidOpenNotebookDocumentNotification={}));var g_;(function(n){function e(r){let i=r;return jn.objectLiteral(i)&&Zs.uinteger.is(i.start)&&Zs.uinteger.is(i.deleteCount)&&(i.cells===void 0||jn.typedArray(i.cells,zu.is))}n.is=e;function t(r,i,s){let o={start:r,deleteCount:i};return s!==void 0&&(o.cells=s),o}n.create=t})(g_=ke.NotebookCellArrayChange||(ke.NotebookCellArrayChange={}));var m_;(function(n){n.method="notebookDocument/didChange",n.type=new eo.ProtocolNotificationType(n.method)})(m_=ke.DidChangeNotebookDocumentNotification||(ke.DidChangeNotebookDocumentNotification={}));var v_;(function(n){n.method="notebookDocument/didSave",n.type=new eo.ProtocolNotificationType(n.method)})(v_=ke.DidSaveNotebookDocumentNotification||(ke.DidSaveNotebookDocumentNotification={}));var y_;(function(n){n.method="notebookDocument/didClose",n.type=new eo.ProtocolNotificationType(n.method)})(y_=ke.DidCloseNotebookDocumentNotification||(ke.DidCloseNotebookDocumentNotification={}))});var wm=F(w=>{"use strict";Object.defineProperty(w,"__esModule",{value:!0});w.WorkspaceSymbolRequest=w.CodeActionResolveRequest=w.CodeActionRequest=w.DocumentSymbolRequest=w.DocumentHighlightRequest=w.ReferencesRequest=w.DefinitionRequest=w.SignatureHelpRequest=w.SignatureHelpTriggerKind=w.HoverRequest=w.CompletionResolveRequest=w.CompletionRequest=w.CompletionTriggerKind=w.PublishDiagnosticsNotification=w.WatchKind=w.RelativePattern=w.FileChangeType=w.DidChangeWatchedFilesNotification=w.WillSaveTextDocumentWaitUntilRequest=w.WillSaveTextDocumentNotification=w.TextDocumentSaveReason=w.DidSaveTextDocumentNotification=w.DidCloseTextDocumentNotification=w.DidChangeTextDocumentNotification=w.TextDocumentContentChangeEvent=w.DidOpenTextDocumentNotification=w.TextDocumentSyncKind=w.TelemetryEventNotification=w.LogMessageNotification=w.ShowMessageRequest=w.ShowMessageNotification=w.MessageType=w.DidChangeConfigurationNotification=w.ExitNotification=w.ShutdownRequest=w.InitializedNotification=w.InitializeErrorCodes=w.InitializeRequest=w.WorkDoneProgressOptions=w.TextDocumentRegistrationOptions=w.StaticRegistrationOptions=w.PositionEncodingKind=w.FailureHandlingKind=w.ResourceOperationKind=w.UnregistrationRequest=w.RegistrationRequest=w.DocumentSelector=w.NotebookCellTextDocumentFilter=w.NotebookDocumentFilter=w.TextDocumentFilter=void 0;w.TypeHierarchySubtypesRequest=w.TypeHierarchyPrepareRequest=w.MonikerRequest=w.MonikerKind=w.UniquenessLevel=w.WillDeleteFilesRequest=w.DidDeleteFilesNotification=w.WillRenameFilesRequest=w.DidRenameFilesNotification=w.WillCreateFilesRequest=w.DidCreateFilesNotification=w.FileOperationPatternKind=w.LinkedEditingRangeRequest=w.ShowDocumentRequest=w.SemanticTokensRegistrationType=w.SemanticTokensRefreshRequest=w.SemanticTokensRangeRequest=w.SemanticTokensDeltaRequest=w.SemanticTokensRequest=w.TokenFormat=w.CallHierarchyPrepareRequest=w.CallHierarchyOutgoingCallsRequest=w.CallHierarchyIncomingCallsRequest=w.WorkDoneProgressCancelNotification=w.WorkDoneProgressCreateRequest=w.WorkDoneProgress=w.SelectionRangeRequest=w.DeclarationRequest=w.FoldingRangeRequest=w.ColorPresentationRequest=w.DocumentColorRequest=w.ConfigurationRequest=w.DidChangeWorkspaceFoldersNotification=w.WorkspaceFoldersRequest=w.TypeDefinitionRequest=w.ImplementationRequest=w.ApplyWorkspaceEditRequest=w.ExecuteCommandRequest=w.PrepareRenameRequest=w.RenameRequest=w.PrepareSupportDefaultBehavior=w.DocumentOnTypeFormattingRequest=w.DocumentRangeFormattingRequest=w.DocumentFormattingRequest=w.DocumentLinkResolveRequest=w.DocumentLinkRequest=w.CodeLensRefreshRequest=w.CodeLensResolveRequest=w.CodeLensRequest=w.WorkspaceSymbolResolveRequest=void 0;w.DidCloseNotebookDocumentNotification=w.DidSaveNotebookDocumentNotification=w.DidChangeNotebookDocumentNotification=w.NotebookCellArrayChange=w.DidOpenNotebookDocumentNotification=w.NotebookDocumentSyncRegistrationType=w.NotebookDocument=w.NotebookCell=w.ExecutionSummary=w.NotebookCellKind=w.DiagnosticRefreshRequest=w.WorkspaceDiagnosticRequest=w.DocumentDiagnosticRequest=w.DocumentDiagnosticReportKind=w.DiagnosticServerCancellationData=w.InlayHintRefreshRequest=w.InlayHintResolveRequest=w.InlayHintRequest=w.InlineValueRefreshRequest=w.InlineValueRequest=w.TypeHierarchySupertypesRequest=void 0;var ue=Je(),dm=Da(),Et=Ta(),w_=Mg();Object.defineProperty(w,"ImplementationRequest",{enumerable:!0,get:function(){return w_.ImplementationRequest}});var C_=$g();Object.defineProperty(w,"TypeDefinitionRequest",{enumerable:!0,get:function(){return C_.TypeDefinitionRequest}});var fm=Wg();Object.defineProperty(w,"WorkspaceFoldersRequest",{enumerable:!0,get:function(){return fm.WorkspaceFoldersRequest}});Object.defineProperty(w,"DidChangeWorkspaceFoldersNotification",{enumerable:!0,get:function(){return fm.DidChangeWorkspaceFoldersNotification}});var b_=Hg();Object.defineProperty(w,"ConfigurationRequest",{enumerable:!0,get:function(){return b_.ConfigurationRequest}});var hm=Kg();Object.defineProperty(w,"DocumentColorRequest",{enumerable:!0,get:function(){return hm.DocumentColorRequest}});Object.defineProperty(w,"ColorPresentationRequest",{enumerable:!0,get:function(){return hm.ColorPresentationRequest}});var D_=zg();Object.defineProperty(w,"FoldingRangeRequest",{enumerable:!0,get:function(){return D_.FoldingRangeRequest}});var T_=Vg();Object.defineProperty(w,"DeclarationRequest",{enumerable:!0,get:function(){return T_.DeclarationRequest}});var R_=Xg();Object.defineProperty(w,"SelectionRangeRequest",{enumerable:!0,get:function(){return R_.SelectionRangeRequest}});var Vu=Gg();Object.defineProperty(w,"WorkDoneProgress",{enumerable:!0,get:function(){return Vu.WorkDoneProgress}});Object.defineProperty(w,"WorkDoneProgressCreateRequest",{enumerable:!0,get:function(){return Vu.WorkDoneProgressCreateRequest}});Object.defineProperty(w,"WorkDoneProgressCancelNotification",{enumerable:!0,get:function(){return Vu.WorkDoneProgressCancelNotification}});var Xu=Qg();Object.defineProperty(w,"CallHierarchyIncomingCallsRequest",{enumerable:!0,get:function(){return Xu.CallHierarchyIncomingCallsRequest}});Object.defineProperty(w,"CallHierarchyOutgoingCallsRequest",{enumerable:!0,get:function(){return Xu.CallHierarchyOutgoingCallsRequest}});Object.defineProperty(w,"CallHierarchyPrepareRequest",{enumerable:!0,get:function(){return Xu.CallHierarchyPrepareRequest}});var zi=Yg();Object.defineProperty(w,"TokenFormat",{enumerable:!0,get:function(){return zi.TokenFormat}});Object.defineProperty(w,"SemanticTokensRequest",{enumerable:!0,get:function(){return zi.SemanticTokensRequest}});Object.defineProperty(w,"SemanticTokensDeltaRequest",{enumerable:!0,get:function(){return zi.SemanticTokensDeltaRequest}});Object.defineProperty(w,"SemanticTokensRangeRequest",{enumerable:!0,get:function(){return zi.SemanticTokensRangeRequest}});Object.defineProperty(w,"SemanticTokensRefreshRequest",{enumerable:!0,get:function(){return zi.SemanticTokensRefreshRequest}});Object.defineProperty(w,"SemanticTokensRegistrationType",{enumerable:!0,get:function(){return zi.SemanticTokensRegistrationType}});var S_=Jg();Object.defineProperty(w,"ShowDocumentRequest",{enumerable:!0,get:function(){return S_.ShowDocumentRequest}});var __=Zg();Object.defineProperty(w,"LinkedEditingRangeRequest",{enumerable:!0,get:function(){return __.LinkedEditingRangeRequest}});var li=em();Object.defineProperty(w,"FileOperationPatternKind",{enumerable:!0,get:function(){return li.FileOperationPatternKind}});Object.defineProperty(w,"DidCreateFilesNotification",{enumerable:!0,get:function(){return li.DidCreateFilesNotification}});Object.defineProperty(w,"WillCreateFilesRequest",{enumerable:!0,get:function(){return li.WillCreateFilesRequest}});Object.defineProperty(w,"DidRenameFilesNotification",{enumerable:!0,get:function(){return li.DidRenameFilesNotification}});Object.defineProperty(w,"WillRenameFilesRequest",{enumerable:!0,get:function(){return li.WillRenameFilesRequest}});Object.defineProperty(w,"DidDeleteFilesNotification",{enumerable:!0,get:function(){return li.DidDeleteFilesNotification}});Object.defineProperty(w,"WillDeleteFilesRequest",{enumerable:!0,get:function(){return li.WillDeleteFilesRequest}});var Bu=tm();Object.defineProperty(w,"UniquenessLevel",{enumerable:!0,get:function(){return Bu.UniquenessLevel}});Object.defineProperty(w,"MonikerKind",{enumerable:!0,get:function(){return Bu.MonikerKind}});Object.defineProperty(w,"MonikerRequest",{enumerable:!0,get:function(){return Bu.MonikerRequest}});var Gu=nm();Object.defineProperty(w,"TypeHierarchyPrepareRequest",{enumerable:!0,get:function(){return Gu.TypeHierarchyPrepareRequest}});Object.defineProperty(w,"TypeHierarchySubtypesRequest",{enumerable:!0,get:function(){return Gu.TypeHierarchySubtypesRequest}});Object.defineProperty(w,"TypeHierarchySupertypesRequest",{enumerable:!0,get:function(){return Gu.TypeHierarchySupertypesRequest}});var pm=im();Object.defineProperty(w,"InlineValueRequest",{enumerable:!0,get:function(){return pm.InlineValueRequest}});Object.defineProperty(w,"InlineValueRefreshRequest",{enumerable:!0,get:function(){return pm.InlineValueRefreshRequest}});var Qu=sm();Object.defineProperty(w,"InlayHintRequest",{enumerable:!0,get:function(){return Qu.InlayHintRequest}});Object.defineProperty(w,"InlayHintResolveRequest",{enumerable:!0,get:function(){return Qu.InlayHintResolveRequest}});Object.defineProperty(w,"InlayHintRefreshRequest",{enumerable:!0,get:function(){return Qu.InlayHintRefreshRequest}});var to=am();Object.defineProperty(w,"DiagnosticServerCancellationData",{enumerable:!0,get:function(){return to.DiagnosticServerCancellationData}});Object.defineProperty(w,"DocumentDiagnosticReportKind",{enumerable:!0,get:function(){return to.DocumentDiagnosticReportKind}});Object.defineProperty(w,"DocumentDiagnosticRequest",{enumerable:!0,get:function(){return to.DocumentDiagnosticRequest}});Object.defineProperty(w,"WorkspaceDiagnosticRequest",{enumerable:!0,get:function(){return to.WorkspaceDiagnosticRequest}});Object.defineProperty(w,"DiagnosticRefreshRequest",{enumerable:!0,get:function(){return to.DiagnosticRefreshRequest}});var Jn=lm();Object.defineProperty(w,"NotebookCellKind",{enumerable:!0,get:function(){return Jn.NotebookCellKind}});Object.defineProperty(w,"ExecutionSummary",{enumerable:!0,get:function(){return Jn.ExecutionSummary}});Object.defineProperty(w,"NotebookCell",{enumerable:!0,get:function(){return Jn.NotebookCell}});Object.defineProperty(w,"NotebookDocument",{enumerable:!0,get:function(){return Jn.NotebookDocument}});Object.defineProperty(w,"NotebookDocumentSyncRegistrationType",{enumerable:!0,get:function(){return Jn.NotebookDocumentSyncRegistrationType}});Object.defineProperty(w,"DidOpenNotebookDocumentNotification",{enumerable:!0,get:function(){return Jn.DidOpenNotebookDocumentNotification}});Object.defineProperty(w,"NotebookCellArrayChange",{enumerable:!0,get:function(){return Jn.NotebookCellArrayChange}});Object.defineProperty(w,"DidChangeNotebookDocumentNotification",{enumerable:!0,get:function(){return Jn.DidChangeNotebookDocumentNotification}});Object.defineProperty(w,"DidSaveNotebookDocumentNotification",{enumerable:!0,get:function(){return Jn.DidSaveNotebookDocumentNotification}});Object.defineProperty(w,"DidCloseNotebookDocumentNotification",{enumerable:!0,get:function(){return Jn.DidCloseNotebookDocumentNotification}});var gm;(function(n){function e(t){let r=t;return Et.string(r.language)||Et.string(r.scheme)||Et.string(r.pattern)}n.is=e})(gm=w.TextDocumentFilter||(w.TextDocumentFilter={}));var mm;(function(n){function e(t){let r=t;return Et.objectLiteral(r)&&(Et.string(r.notebookType)||Et.string(r.scheme)||Et.string(r.pattern))}n.is=e})(mm=w.NotebookDocumentFilter||(w.NotebookDocumentFilter={}));var vm;(function(n){function e(t){let r=t;return Et.objectLiteral(r)&&(Et.string(r.notebook)||mm.is(r.notebook))&&(r.language===void 0||Et.string(r.language))}n.is=e})(vm=w.NotebookCellTextDocumentFilter||(w.NotebookCellTextDocumentFilter={}));var ym;(function(n){function e(t){if(!Array.isArray(t))return!1;for(let r of t)if(!Et.string(r)&&!gm.is(r)&&!vm.is(r))return!1;return!0}n.is=e})(ym=w.DocumentSelector||(w.DocumentSelector={}));var P_;(function(n){n.type=new ue.ProtocolRequestType("client/registerCapability")})(P_=w.RegistrationRequest||(w.RegistrationRequest={}));var k_;(function(n){n.type=new ue.ProtocolRequestType("client/unregisterCapability")})(k_=w.UnregistrationRequest||(w.UnregistrationRequest={}));var E_;(function(n){n.Create="create",n.Rename="rename",n.Delete="delete"})(E_=w.ResourceOperationKind||(w.ResourceOperationKind={}));var x_;(function(n){n.Abort="abort",n.Transactional="transactional",n.TextOnlyTransactional="textOnlyTransactional",n.Undo="undo"})(x_=w.FailureHandlingKind||(w.FailureHandlingKind={}));var q_;(function(n){n.UTF8="utf-8",n.UTF16="utf-16",n.UTF32="utf-32"})(q_=w.PositionEncodingKind||(w.PositionEncodingKind={}));var I_;(function(n){function e(t){let r=t;return r&&Et.string(r.id)&&r.id.length>0}n.hasId=e})(I_=w.StaticRegistrationOptions||(w.StaticRegistrationOptions={}));var F_;(function(n){function e(t){let r=t;return r&&(r.documentSelector===null||ym.is(r.documentSelector))}n.is=e})(F_=w.TextDocumentRegistrationOptions||(w.TextDocumentRegistrationOptions={}));var N_;(function(n){function e(r){let i=r;return Et.objectLiteral(i)&&(i.workDoneProgress===void 0||Et.boolean(i.workDoneProgress))}n.is=e;function t(r){let i=r;return i&&Et.boolean(i.workDoneProgress)}n.hasWorkDoneProgress=t})(N_=w.WorkDoneProgressOptions||(w.WorkDoneProgressOptions={}));var O_;(function(n){n.type=new ue.ProtocolRequestType("initialize")})(O_=w.InitializeRequest||(w.InitializeRequest={}));var L_;(function(n){n.unknownProtocolVersion=1})(L_=w.InitializeErrorCodes||(w.InitializeErrorCodes={}));var A_;(function(n){n.type=new ue.ProtocolNotificationType("initialized")})(A_=w.InitializedNotification||(w.InitializedNotification={}));var M_;(function(n){n.type=new ue.ProtocolRequestType0("shutdown")})(M_=w.ShutdownRequest||(w.ShutdownRequest={}));var $_;(function(n){n.type=new ue.ProtocolNotificationType0("exit")})($_=w.ExitNotification||(w.ExitNotification={}));var j_;(function(n){n.type=new ue.ProtocolNotificationType("workspace/didChangeConfiguration")})(j_=w.DidChangeConfigurationNotification||(w.DidChangeConfigurationNotification={}));var W_;(function(n){n.Error=1,n.Warning=2,n.Info=3,n.Log=4})(W_=w.MessageType||(w.MessageType={}));var H_;(function(n){n.type=new ue.ProtocolNotificationType("window/showMessage")})(H_=w.ShowMessageNotification||(w.ShowMessageNotification={}));var U_;(function(n){n.type=new ue.ProtocolRequestType("window/showMessageRequest")})(U_=w.ShowMessageRequest||(w.ShowMessageRequest={}));var K_;(function(n){n.type=new ue.ProtocolNotificationType("window/logMessage")})(K_=w.LogMessageNotification||(w.LogMessageNotification={}));var z_;(function(n){n.type=new ue.ProtocolNotificationType("telemetry/event")})(z_=w.TelemetryEventNotification||(w.TelemetryEventNotification={}));var V_;(function(n){n.None=0,n.Full=1,n.Incremental=2})(V_=w.TextDocumentSyncKind||(w.TextDocumentSyncKind={}));var X_;(function(n){n.method="textDocument/didOpen",n.type=new ue.ProtocolNotificationType(n.method)})(X_=w.DidOpenTextDocumentNotification||(w.DidOpenTextDocumentNotification={}));var B_;(function(n){function e(r){let i=r;return i!=null&&typeof i.text=="string"&&i.range!==void 0&&(i.rangeLength===void 0||typeof i.rangeLength=="number")}n.isIncremental=e;function t(r){let i=r;return i!=null&&typeof i.text=="string"&&i.range===void 0&&i.rangeLength===void 0}n.isFull=t})(B_=w.TextDocumentContentChangeEvent||(w.TextDocumentContentChangeEvent={}));var G_;(function(n){n.method="textDocument/didChange",n.type=new ue.ProtocolNotificationType(n.method)})(G_=w.DidChangeTextDocumentNotification||(w.DidChangeTextDocumentNotification={}));var Q_;(function(n){n.method="textDocument/didClose",n.type=new ue.ProtocolNotificationType(n.method)})(Q_=w.DidCloseTextDocumentNotification||(w.DidCloseTextDocumentNotification={}));var Y_;(function(n){n.method="textDocument/didSave",n.type=new ue.ProtocolNotificationType(n.method)})(Y_=w.DidSaveTextDocumentNotification||(w.DidSaveTextDocumentNotification={}));var J_;(function(n){n.Manual=1,n.AfterDelay=2,n.FocusOut=3})(J_=w.TextDocumentSaveReason||(w.TextDocumentSaveReason={}));var Z_;(function(n){n.method="textDocument/willSave",n.type=new ue.ProtocolNotificationType(n.method)})(Z_=w.WillSaveTextDocumentNotification||(w.WillSaveTextDocumentNotification={}));var eP;(function(n){n.method="textDocument/willSaveWaitUntil",n.type=new ue.ProtocolRequestType(n.method)})(eP=w.WillSaveTextDocumentWaitUntilRequest||(w.WillSaveTextDocumentWaitUntilRequest={}));var tP;(function(n){n.type=new ue.ProtocolNotificationType("workspace/didChangeWatchedFiles")})(tP=w.DidChangeWatchedFilesNotification||(w.DidChangeWatchedFilesNotification={}));var nP;(function(n){n.Created=1,n.Changed=2,n.Deleted=3})(nP=w.FileChangeType||(w.FileChangeType={}));var rP;(function(n){function e(t){let r=t;return Et.objectLiteral(r)&&(dm.URI.is(r.baseUri)||dm.WorkspaceFolder.is(r.baseUri))&&Et.string(r.pattern)}n.is=e})(rP=w.RelativePattern||(w.RelativePattern={}));var iP;(function(n){n.Create=1,n.Change=2,n.Delete=4})(iP=w.WatchKind||(w.WatchKind={}));var sP;(function(n){n.type=new ue.ProtocolNotificationType("textDocument/publishDiagnostics")})(sP=w.PublishDiagnosticsNotification||(w.PublishDiagnosticsNotification={}));var oP;(function(n){n.Invoked=1,n.TriggerCharacter=2,n.TriggerForIncompleteCompletions=3})(oP=w.CompletionTriggerKind||(w.CompletionTriggerKind={}));var aP;(function(n){n.method="textDocument/completion",n.type=new ue.ProtocolRequestType(n.method)})(aP=w.CompletionRequest||(w.CompletionRequest={}));var cP;(function(n){n.method="completionItem/resolve",n.type=new ue.ProtocolRequestType(n.method)})(cP=w.CompletionResolveRequest||(w.CompletionResolveRequest={}));var uP;(function(n){n.method="textDocument/hover",n.type=new ue.ProtocolRequestType(n.method)})(uP=w.HoverRequest||(w.HoverRequest={}));var lP;(function(n){n.Invoked=1,n.TriggerCharacter=2,n.ContentChange=3})(lP=w.SignatureHelpTriggerKind||(w.SignatureHelpTriggerKind={}));var dP;(function(n){n.method="textDocument/signatureHelp",n.type=new ue.ProtocolRequestType(n.method)})(dP=w.SignatureHelpRequest||(w.SignatureHelpRequest={}));var fP;(function(n){n.method="textDocument/definition",n.type=new ue.ProtocolRequestType(n.method)})(fP=w.DefinitionRequest||(w.DefinitionRequest={}));var hP;(function(n){n.method="textDocument/references",n.type=new ue.ProtocolRequestType(n.method)})(hP=w.ReferencesRequest||(w.ReferencesRequest={}));var pP;(function(n){n.method="textDocument/documentHighlight",n.type=new ue.ProtocolRequestType(n.method)})(pP=w.DocumentHighlightRequest||(w.DocumentHighlightRequest={}));var gP;(function(n){n.method="textDocument/documentSymbol",n.type=new ue.ProtocolRequestType(n.method)})(gP=w.DocumentSymbolRequest||(w.DocumentSymbolRequest={}));var mP;(function(n){n.method="textDocument/codeAction",n.type=new ue.ProtocolRequestType(n.method)})(mP=w.CodeActionRequest||(w.CodeActionRequest={}));var vP;(function(n){n.method="codeAction/resolve",n.type=new ue.ProtocolRequestType(n.method)})(vP=w.CodeActionResolveRequest||(w.CodeActionResolveRequest={}));var yP;(function(n){n.method="workspace/symbol",n.type=new ue.ProtocolRequestType(n.method)})(yP=w.WorkspaceSymbolRequest||(w.WorkspaceSymbolRequest={}));var wP;(function(n){n.method="workspaceSymbol/resolve",n.type=new ue.ProtocolRequestType(n.method)})(wP=w.WorkspaceSymbolResolveRequest||(w.WorkspaceSymbolResolveRequest={}));var CP;(function(n){n.method="textDocument/codeLens",n.type=new ue.ProtocolRequestType(n.method)})(CP=w.CodeLensRequest||(w.CodeLensRequest={}));var bP;(function(n){n.method="codeLens/resolve",n.type=new ue.ProtocolRequestType(n.method)})(bP=w.CodeLensResolveRequest||(w.CodeLensResolveRequest={}));var DP;(function(n){n.method="workspace/codeLens/refresh",n.type=new ue.ProtocolRequestType0(n.method)})(DP=w.CodeLensRefreshRequest||(w.CodeLensRefreshRequest={}));var TP;(function(n){n.method="textDocument/documentLink",n.type=new ue.ProtocolRequestType(n.method)})(TP=w.DocumentLinkRequest||(w.DocumentLinkRequest={}));var RP;(function(n){n.method="documentLink/resolve",n.type=new ue.ProtocolRequestType(n.method)})(RP=w.DocumentLinkResolveRequest||(w.DocumentLinkResolveRequest={}));var SP;(function(n){n.method="textDocument/formatting",n.type=new ue.ProtocolRequestType(n.method)})(SP=w.DocumentFormattingRequest||(w.DocumentFormattingRequest={}));var _P;(function(n){n.method="textDocument/rangeFormatting",n.type=new ue.ProtocolRequestType(n.method)})(_P=w.DocumentRangeFormattingRequest||(w.DocumentRangeFormattingRequest={}));var PP;(function(n){n.method="textDocument/onTypeFormatting",n.type=new ue.ProtocolRequestType(n.method)})(PP=w.DocumentOnTypeFormattingRequest||(w.DocumentOnTypeFormattingRequest={}));var kP;(function(n){n.Identifier=1})(kP=w.PrepareSupportDefaultBehavior||(w.PrepareSupportDefaultBehavior={}));var EP;(function(n){n.method="textDocument/rename",n.type=new ue.ProtocolRequestType(n.method)})(EP=w.RenameRequest||(w.RenameRequest={}));var xP;(function(n){n.method="textDocument/prepareRename",n.type=new ue.ProtocolRequestType(n.method)})(xP=w.PrepareRenameRequest||(w.PrepareRenameRequest={}));var qP;(function(n){n.type=new ue.ProtocolRequestType("workspace/executeCommand")})(qP=w.ExecuteCommandRequest||(w.ExecuteCommandRequest={}));var IP;(function(n){n.type=new ue.ProtocolRequestType("workspace/applyEdit")})(IP=w.ApplyWorkspaceEditRequest||(w.ApplyWorkspaceEditRequest={}))});var bm=F(Ra=>{"use strict";Object.defineProperty(Ra,"__esModule",{value:!0});Ra.createProtocolConnection=void 0;var Cm=ui();function FP(n,e,t,r){return Cm.ConnectionStrategy.is(r)&&(r={connectionStrategy:r}),(0,Cm.createMessageConnection)(n,e,t,r)}Ra.createProtocolConnection=FP});var Dm=F(Ut=>{"use strict";var NP=Ut&&Ut.__createBinding||(Object.create?function(n,e,t,r){r===void 0&&(r=t);var i=Object.getOwnPropertyDescriptor(e,t);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(n,r,i)}:function(n,e,t,r){r===void 0&&(r=t),n[r]=e[t]}),Sa=Ut&&Ut.__exportStar||function(n,e){for(var t in n)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&NP(e,n,t)};Object.defineProperty(Ut,"__esModule",{value:!0});Ut.LSPErrorCodes=Ut.createProtocolConnection=void 0;Sa(ui(),Ut);Sa(Da(),Ut);Sa(Je(),Ut);Sa(wm(),Ut);var OP=bm();Object.defineProperty(Ut,"createProtocolConnection",{enumerable:!0,get:function(){return OP.createProtocolConnection}});var LP;(function(n){n.lspReservedErrorRangeStart=-32899,n.RequestFailed=-32803,n.ServerCancelled=-32802,n.ContentModified=-32801,n.RequestCancelled=-32800,n.lspReservedErrorRangeEnd=-32800})(LP=Ut.LSPErrorCodes||(Ut.LSPErrorCodes={}))});var ce=F(Zn=>{"use strict";var AP=Zn&&Zn.__createBinding||(Object.create?function(n,e,t,r){r===void 0&&(r=t);var i=Object.getOwnPropertyDescriptor(e,t);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(n,r,i)}:function(n,e,t,r){r===void 0&&(r=t),n[r]=e[t]}),Tm=Zn&&Zn.__exportStar||function(n,e){for(var t in n)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&AP(e,n,t)};Object.defineProperty(Zn,"__esModule",{value:!0});Zn.createProtocolConnection=void 0;var MP=ju();Tm(ju(),Zn);Tm(Dm(),Zn);function $P(n,e,t,r){return(0,MP.createMessageConnection)(n,e,t,r)}Zn.createProtocolConnection=$P});var ro=F(wn=>{"use strict";Object.defineProperty(wn,"__esModule",{value:!0});wn.forEach=wn.mapAsync=wn.map=wn.Semaphore=wn.Delayer=void 0;var no=ce(),Rm=class{constructor(e){this.defaultDelay=e,this.timeout=void 0,this.completionPromise=void 0,this.onSuccess=void 0,this.task=void 0}trigger(e,t=this.defaultDelay){return this.task=e,t>=0&&this.cancelTimeout(),this.completionPromise||(this.completionPromise=new Promise(r=>{this.onSuccess=r}).then(()=>{this.completionPromise=void 0,this.onSuccess=void 0;var r=this.task();return this.task=void 0,r})),(t>=0||this.timeout===void 0)&&(this.timeout=(0,no.RAL)().timer.setTimeout(()=>{this.timeout=void 0,this.onSuccess(void 0)},t>=0?t:this.defaultDelay)),this.completionPromise}forceDelivery(){if(!this.completionPromise)return;this.cancelTimeout();let e=this.task();return this.completionPromise=void 0,this.onSuccess=void 0,this.task=void 0,e}isTriggered(){return this.timeout!==void 0}cancel(){this.cancelTimeout(),this.completionPromise=void 0}cancelTimeout(){this.timeout!==void 0&&(this.timeout.dispose(),this.timeout=void 0)}};wn.Delayer=Rm;var Sm=class{constructor(e=1){if(e<=0)throw new Error("Capacity must be greater than 0");this._capacity=e,this._active=0,this._waiting=[]}lock(e){return new Promise((t,r)=>{this._waiting.push({thunk:e,resolve:t,reject:r}),this.runNext()})}get active(){return this._active}runNext(){this._waiting.length===0||this._active===this._capacity||(0,no.RAL)().timer.setImmediate(()=>this.doRunNext())}doRunNext(){if(this._waiting.length===0||this._active===this._capacity)return;let e=this._waiting.shift();if(this._active++,this._active>this._capacity)throw new Error("To many thunks active");try{let t=e.thunk();t instanceof Promise?t.then(r=>{this._active--,e.resolve(r),this.runNext()},r=>{this._active--,e.reject(r),this.runNext()}):(this._active--,e.resolve(t),this.runNext())}catch(t){this._active--,e.reject(t),this.runNext()}}};wn.Semaphore=Sm;var _m=15,_a=class{constructor(e=_m){this.yieldAfter=Math.max(e,_m),this.startTime=Date.now(),this.counter=0,this.total=0,this.counterInterval=1}start(){this.startTime=Date.now()}shouldYield(){if(++this.counter>=this.counterInterval){let e=Date.now()-this.startTime,t=Math.max(0,this.yieldAfter-e);if(this.total+=this.counter,this.counter=0,e>=this.yieldAfter||t<=1)return this.counterInterval=1,this.total=0,!0;switch(e){case 0:case 1:this.counterInterval=this.total*2;break}}return!1}};async function jP(n,e,t,r){if(n.length===0)return[];let i=new Array(n.length),s=new _a(r==null?void 0:r.yieldAfter);function o(c){s.start();for(let u=c;u<n.length;u++)if(i[u]=e(n[u]),s.shouldYield())return(r==null?void 0:r.yieldCallback)&&r.yieldCallback(),u+1;return-1}let a=o(0);for(;a!==-1&&!(t!==void 0&&t.isCancellationRequested);)a=await new Promise(c=>{(0,no.RAL)().timer.setImmediate(()=>{c(o(a))})});return i}wn.map=jP;async function WP(n,e,t,r){if(n.length===0)return[];let i=new Array(n.length),s=new _a(r==null?void 0:r.yieldAfter);async function o(c){s.start();for(let u=c;u<n.length;u++)if(i[u]=await e(n[u],t),s.shouldYield())return(r==null?void 0:r.yieldCallback)&&r.yieldCallback(),u+1;return-1}let a=await o(0);for(;a!==-1&&!(t!==void 0&&t.isCancellationRequested);)a=await new Promise(c=>{(0,no.RAL)().timer.setImmediate(()=>{c(o(a))})});return i}wn.mapAsync=WP;async function HP(n,e,t,r){if(n.length===0)return;let i=new _a(r==null?void 0:r.yieldAfter);function s(a){i.start();for(let c=a;c<n.length;c++)if(e(n[c]),i.shouldYield())return(r==null?void 0:r.yieldCallback)&&r.yieldCallback(),c+1;return-1}let o=s(0);for(;o!==-1&&!(t!==void 0&&t.isCancellationRequested);)o=await new Promise(a=>{(0,no.RAL)().timer.setImmediate(()=>{a(s(o))})})}wn.forEach=HP});var Ju=F(Yu=>{"use strict";Object.defineProperty(Yu,"__esModule",{value:!0});var UP=require("vscode"),Pm=class extends UP.CompletionItem{constructor(e){super(e)}};Yu.default=Pm});var el=F(Zu=>{"use strict";Object.defineProperty(Zu,"__esModule",{value:!0});var KP=require("vscode"),km=class extends KP.CodeLens{constructor(e){super(e)}};Zu.default=km});var nl=F(tl=>{"use strict";Object.defineProperty(tl,"__esModule",{value:!0});var zP=require("vscode"),Em=class extends zP.DocumentLink{constructor(e,t){super(e,t)}};tl.default=Em});var il=F(rl=>{"use strict";Object.defineProperty(rl,"__esModule",{value:!0});var VP=require("vscode"),xm=class extends VP.CodeAction{constructor(e,t){super(e);this.data=t}};rl.default=xm});var ol=F(di=>{"use strict";Object.defineProperty(di,"__esModule",{value:!0});di.ProtocolDiagnostic=di.DiagnosticCode=void 0;var XP=require("vscode"),sl=vn(),BP;(function(n){function e(t){let r=t;return r!=null&&(sl.number(r.value)||sl.string(r.value))&&sl.string(r.target)}n.is=e})(BP=di.DiagnosticCode||(di.DiagnosticCode={}));var qm=class extends XP.Diagnostic{constructor(e,t,r,i){super(e,t,r);this.data=i,this.hasDiagnosticCode=!1}};di.ProtocolDiagnostic=qm});var cl=F(al=>{"use strict";Object.defineProperty(al,"__esModule",{value:!0});var GP=require("vscode"),Im=class extends GP.CallHierarchyItem{constructor(e,t,r,i,s,o,a){super(e,t,r,i,s,o);a!==void 0&&(this.data=a)}};al.default=Im});var ll=F(ul=>{"use strict";Object.defineProperty(ul,"__esModule",{value:!0});var QP=require("vscode"),Fm=class extends QP.TypeHierarchyItem{constructor(e,t,r,i,s,o,a){super(e,t,r,i,s,o);a!==void 0&&(this.data=a)}};ul.default=Fm});var fl=F(dl=>{"use strict";Object.defineProperty(dl,"__esModule",{value:!0});var Pa=require("vscode"),Nm=class extends Pa.SymbolInformation{constructor(e,t,r,i,s){let o=!(i instanceof Pa.Uri);super(e,t,r,o?i:new Pa.Location(i,new Pa.Range(0,0,0,0)));this.hasRange=o,s!==void 0&&(this.data=s)}};dl.default=Nm});var pl=F(hl=>{"use strict";Object.defineProperty(hl,"__esModule",{value:!0});var YP=require("vscode"),Om=class extends YP.InlayHint{constructor(e,t,r){super(e,t,r)}};hl.default=Om});var Mm=F(ka=>{"use strict";Object.defineProperty(ka,"__esModule",{value:!0});ka.createConverter=void 0;var pt=require("vscode"),fe=ce(),Vi=vn(),Lm=ro(),JP=Ju(),ZP=el(),ek=nl(),tk=il(),Am=ol(),nk=cl(),rk=ll(),ik=fl(),sk=pl(),gl;(function(n){function e(t){let r=t;return r&&!!r.inserting&&!!r.replacing}n.is=e})(gl||(gl={}));function ok(n){let t=n||(g=>g.toString());function r(g){return t(g)}function i(g){return{uri:t(g.uri)}}function s(g){return{uri:t(g.uri),languageId:g.languageId,version:g.version,text:g.getText()}}function o(g){return{uri:t(g.uri),version:g.version}}function a(g){return{textDocument:s(g)}}function c(g){let A=g;return!!A.document&&!!A.contentChanges}function u(g){let A=g;return!!A.uri&&!!A.version}function l(g){if(u(g))return{textDocument:{uri:t(g.uri),version:g.version},contentChanges:[{text:g.getText()}]};if(c(g)){let A=g.document;return{textDocument:{uri:t(A.uri),version:A.version},contentChanges:g.contentChanges.map(he=>{let x=he.range;return{range:{start:{line:x.start.line,character:x.start.character},end:{line:x.end.line,character:x.end.character}},rangeLength:he.rangeLength,text:he.text}})}}else throw Error("Unsupported text document change parameter")}function h(g){return{textDocument:i(g)}}function p(g,A=!1){let V={textDocument:i(g)};return A&&(V.text=g.getText()),V}function C(g){switch(g){case pt.TextDocumentSaveReason.Manual:return fe.TextDocumentSaveReason.Manual;case pt.TextDocumentSaveReason.AfterDelay:return fe.TextDocumentSaveReason.AfterDelay;case pt.TextDocumentSaveReason.FocusOut:return fe.TextDocumentSaveReason.FocusOut}return fe.TextDocumentSaveReason.Manual}function T(g){return{textDocument:i(g.document),reason:C(g.reason)}}function y(g){return{files:g.files.map(A=>({uri:t(A)}))}}function R(g){return{files:g.files.map(A=>({oldUri:t(A.oldUri),newUri:t(A.newUri)}))}}function S(g){return{files:g.files.map(A=>({uri:t(A)}))}}function v(g){return{files:g.files.map(A=>({uri:t(A)}))}}function b(g){return{files:g.files.map(A=>({oldUri:t(A.oldUri),newUri:t(A.newUri)}))}}function P(g){return{files:g.files.map(A=>({uri:t(A)}))}}function N(g,A){return{textDocument:i(g),position:He(A)}}function q(g){switch(g){case pt.CompletionTriggerKind.TriggerCharacter:return fe.CompletionTriggerKind.TriggerCharacter;case pt.CompletionTriggerKind.TriggerForIncompleteCompletions:return fe.CompletionTriggerKind.TriggerForIncompleteCompletions;default:return fe.CompletionTriggerKind.Invoked}}function O(g,A,V){return{textDocument:i(g),position:He(A),context:{triggerKind:q(V.triggerKind),triggerCharacter:V.triggerCharacter}}}function H(g){switch(g){case pt.SignatureHelpTriggerKind.Invoke:return fe.SignatureHelpTriggerKind.Invoked;case pt.SignatureHelpTriggerKind.TriggerCharacter:return fe.SignatureHelpTriggerKind.TriggerCharacter;case pt.SignatureHelpTriggerKind.ContentChange:return fe.SignatureHelpTriggerKind.ContentChange}}function B(g){return{label:g.label}}function Y(g){return g.map(B)}function Z(g){return{label:g.label,parameters:Y(g.parameters)}}function Oe(g){return g.map(Z)}function ot(g){return g===void 0?g:{signatures:Oe(g.signatures),activeSignature:g.activeSignature,activeParameter:g.activeParameter}}function Ye(g,A,V){return{textDocument:i(g),position:He(A),context:{isRetrigger:V.isRetrigger,triggerCharacter:V.triggerCharacter,triggerKind:H(V.triggerKind),activeSignatureHelp:ot(V.activeSignatureHelp)}}}function He(g){return{line:g.line,character:g.character}}function de(g){return g==null?g:{line:g.line>fe.uinteger.MAX_VALUE?fe.uinteger.MAX_VALUE:g.line,character:g.character>fe.uinteger.MAX_VALUE?fe.uinteger.MAX_VALUE:g.character}}function Ue(g,A){return Lm.map(g,de,A)}function je(g){return g==null?g:{start:de(g.start),end:de(g.end)}}function mt(g){return g==null?g:fe.Location.create(r(g.uri),je(g.range))}function Tt(g){switch(g){case pt.DiagnosticSeverity.Error:return fe.DiagnosticSeverity.Error;case pt.DiagnosticSeverity.Warning:return fe.DiagnosticSeverity.Warning;case pt.DiagnosticSeverity.Information:return fe.DiagnosticSeverity.Information;case pt.DiagnosticSeverity.Hint:return fe.DiagnosticSeverity.Hint}}function nn(g){if(!g)return;let A=[];for(let V of g){let he=ut(V);he!==void 0&&A.push(he)}return A.length>0?A:void 0}function ut(g){switch(g){case pt.DiagnosticTag.Unnecessary:return fe.DiagnosticTag.Unnecessary;case pt.DiagnosticTag.Deprecated:return fe.DiagnosticTag.Deprecated;default:return}}function Xr(g){return{message:g.message,location:mt(g.location)}}function Rr(g){return g.map(Xr)}function Sr(g){if(g!=null)return Vi.number(g)||Vi.string(g)?g:{value:g.value,target:r(g.target)}}function rr(g){let A=fe.Diagnostic.create(je(g.range),g.message),V=g instanceof Am.ProtocolDiagnostic?g:void 0;V!==void 0&&V.data!==void 0&&(A.data=V.data);let he=Sr(g.code);return Am.DiagnosticCode.is(he)?V!==void 0&&V.hasDiagnosticCode?A.code=he:(A.code=he.value,A.codeDescription={href:he.target}):A.code=he,Vi.number(g.severity)&&(A.severity=Tt(g.severity)),Array.isArray(g.tags)&&(A.tags=nn(g.tags)),g.relatedInformation&&(A.relatedInformation=Rr(g.relatedInformation)),g.source&&(A.source=g.source),A}function ir(g,A){return g==null?g:Lm.map(g,rr,A)}function Br(g,A){switch(g){case"$string":return A;case fe.MarkupKind.PlainText:return{kind:g,value:A};case fe.MarkupKind.Markdown:return{kind:g,value:A.value};default:return`Unsupported Markup content received. Kind is: ${g}`}}function _r(g){switch(g){case pt.CompletionItemTag.Deprecated:return fe.CompletionItemTag.Deprecated}}function Pr(g){if(g===void 0)return g;let A=[];for(let V of g){let he=_r(V);he!==void 0&&A.push(he)}return A}function xt(g,A){return A!==void 0?A:g+1}function dn(g,A=!1){let V,he;Vi.string(g.label)?V=g.label:(V=g.label.label,A&&(g.label.detail!==void 0||g.label.description!==void 0)&&(he={detail:g.label.detail,description:g.label.description}));let x={label:V};he!==void 0&&(x.labelDetails=he);let m=g instanceof JP.default?g:void 0;g.detail&&(x.detail=g.detail),g.documentation&&(!m||m.documentationFormat==="$string"?x.documentation=g.documentation:x.documentation=Br(m.documentationFormat,g.documentation)),g.filterText&&(x.filterText=g.filterText),kr(x,g),Vi.number(g.kind)&&(x.kind=xt(g.kind,m&&m.originalItemKind)),g.sortText&&(x.sortText=g.sortText),g.additionalTextEdits&&(x.additionalTextEdits=Vn(g.additionalTextEdits)),g.commitCharacters&&(x.commitCharacters=g.commitCharacters.slice()),g.command&&(x.command=an(g.command)),(g.preselect===!0||g.preselect===!1)&&(x.preselect=g.preselect);let k=Pr(g.tags);if(m){if(m.data!==void 0&&(x.data=m.data),m.deprecated===!0||m.deprecated===!1){if(m.deprecated===!0&&k!==void 0&&k.length>0){let E=k.indexOf(pt.CompletionItemTag.Deprecated);E!==-1&&k.splice(E,1)}x.deprecated=m.deprecated}m.insertTextMode!==void 0&&(x.insertTextMode=m.insertTextMode)}return k!==void 0&&k.length>0&&(x.tags=k),x.insertTextMode===void 0&&g.keepWhitespace===!0&&(x.insertTextMode=fe.InsertTextMode.adjustIndentation),x}function kr(g,A){let V=fe.InsertTextFormat.PlainText,he,x;A.textEdit?(he=A.textEdit.newText,x=A.textEdit.range):A.insertText instanceof pt.SnippetString?(V=fe.InsertTextFormat.Snippet,he=A.insertText.value):he=A.insertText,A.range&&(x=A.range),g.insertTextFormat=V,A.fromEdit&&he!==void 0&&x!==void 0?g.textEdit=rn(he,x):g.insertText=he}function rn(g,A){return gl.is(A)?fe.InsertReplaceEdit.create(g,je(A.inserting),je(A.replacing)):{newText:g,range:je(A)}}function sr(g){return{range:je(g.range),newText:g.newText}}function Vn(g){return g==null?g:g.map(sr)}function sn(g){return g<=pt.SymbolKind.TypeParameter?g+1:fe.SymbolKind.Property}function Vt(g){return g}function lt(g){return g.map(Vt)}function Gr(g,A,V){return{textDocument:i(g),position:He(A),context:{includeDeclaration:V.includeDeclaration}}}async function Mt(g,A){let V=fe.CodeAction.create(g.title);if(g instanceof tk.default&&g.data!==void 0&&(V.data=g.data),g.kind!==void 0&&(V.kind=or(g.kind)),g.diagnostics!==void 0&&(V.diagnostics=await ir(g.diagnostics,A)),g.edit!==void 0)throw new Error("VS Code code actions can only be converted to a protocol code action without an edit.");return g.command!==void 0&&(V.command=an(g.command)),g.isPreferred!==void 0&&(V.isPreferred=g.isPreferred),g.disabled!==void 0&&(V.disabled={reason:g.disabled.reason}),V}async function on(g,A){if(g==null)return g;let V;return g.only&&Vi.string(g.only.value)&&(V=[g.only.value]),fe.CodeActionContext.create(await ir(g.diagnostics,A),V,Xn(g.triggerKind))}function Xn(g){switch(g){case pt.CodeActionTriggerKind.Invoke:return fe.CodeActionTriggerKind.Invoked;case pt.CodeActionTriggerKind.Automatic:return fe.CodeActionTriggerKind.Automatic;default:return}}function or(g){if(g!=null)return g.value}function ar(g){return g==null?g:fe.InlineValueContext.create(g.frameId,je(g.stoppedLocation))}function an(g){let A=fe.Command.create(g.title,g.command);return g.arguments&&(A.arguments=g.arguments),A}function fn(g){let A=fe.CodeLens.create(je(g.range));return g.command&&(A.command=an(g.command)),g instanceof ZP.default&&g.data&&(A.data=g.data),A}function _(g,A){let V={tabSize:g.tabSize,insertSpaces:g.insertSpaces};return A.trimTrailingWhitespace&&(V.trimTrailingWhitespace=!0),A.trimFinalNewlines&&(V.trimFinalNewlines=!0),A.insertFinalNewline&&(V.insertFinalNewline=!0),V}function M(g){return{textDocument:i(g)}}function U(g){return{textDocument:i(g)}}function X(g){let A=fe.DocumentLink.create(je(g.range));g.target&&(A.target=r(g.target)),g.tooltip!==void 0&&(A.tooltip=g.tooltip);let V=g instanceof ek.default?g:void 0;return V&&V.data&&(A.data=V.data),A}function Te(g){return{textDocument:i(g)}}function Re(g){let A={name:g.name,kind:sn(g.kind),uri:r(g.uri),range:je(g.range),selectionRange:je(g.selectionRange)};return g.detail!==void 0&&g.detail.length>0&&(A.detail=g.detail),g.tags!==void 0&&(A.tags=lt(g.tags)),g instanceof nk.default&&g.data!==void 0&&(A.data=g.data),A}function Se(g){let A={name:g.name,kind:sn(g.kind),uri:r(g.uri),range:je(g.range),selectionRange:je(g.selectionRange)};return g.detail!==void 0&&g.detail.length>0&&(A.detail=g.detail),g.tags!==void 0&&(A.tags=lt(g.tags)),g instanceof rk.default&&g.data!==void 0&&(A.data=g.data),A}function Ke(g){let A=g instanceof ik.default?{name:g.name,kind:sn(g.kind),location:g.hasRange?mt(g.location):{uri:t(g.location.uri)},data:g.data}:{name:g.name,kind:sn(g.kind),location:mt(g.location)};return g.tags!==void 0&&(A.tags=lt(g.tags)),g.containerName!==""&&(A.containerName=g.containerName),A}function ge(g){let A=typeof g.label=="string"?g.label:g.label.map(Ee),V=fe.InlayHint.create(de(g.position),A);return g.kind!==void 0&&(V.kind=g.kind),g.textEdits!==void 0&&(V.textEdits=Vn(g.textEdits)),g.tooltip!==void 0&&(V.tooltip=me(g.tooltip)),g.paddingLeft!==void 0&&(V.paddingLeft=g.paddingLeft),g.paddingRight!==void 0&&(V.paddingRight=g.paddingRight),g instanceof sk.default&&g.data!==void 0&&(V.data=g.data),V}function Ee(g){let A=fe.InlayHintLabelPart.create(g.value);return g.location!==void 0&&(A.location=mt(g.location)),g.command!==void 0&&(A.command=an(g.command)),g.tooltip!==void 0&&(A.tooltip=me(g.tooltip)),A}function me(g){return typeof g=="string"?g:{kind:fe.MarkupKind.Markdown,value:g.value}}return{asUri:r,asTextDocumentIdentifier:i,asTextDocumentItem:s,asVersionedTextDocumentIdentifier:o,asOpenTextDocumentParams:a,asChangeTextDocumentParams:l,asCloseTextDocumentParams:h,asSaveTextDocumentParams:p,asWillSaveTextDocumentParams:T,asDidCreateFilesParams:y,asDidRenameFilesParams:R,asDidDeleteFilesParams:S,asWillCreateFilesParams:v,asWillRenameFilesParams:b,asWillDeleteFilesParams:P,asTextDocumentPositionParams:N,asCompletionParams:O,asSignatureHelpParams:Ye,asWorkerPosition:He,asRange:je,asPosition:de,asPositions:Ue,asLocation:mt,asDiagnosticSeverity:Tt,asDiagnosticTag:ut,asDiagnostic:rr,asDiagnostics:ir,asCompletionItem:dn,asTextEdit:sr,asSymbolKind:sn,asSymbolTag:Vt,asSymbolTags:lt,asReferenceParams:Gr,asCodeAction:Mt,asCodeActionContext:on,asInlineValueContext:ar,asCommand:an,asCodeLens:fn,asFormattingOptions:_,asDocumentSymbolParams:M,asCodeLensParams:U,asDocumentLink:X,asDocumentLinkParams:Te,asCallHierarchyItem:Re,asTypeHierarchyItem:Se,asInlayHint:ge,asWorkspaceSymbol:Ke}}ka.createConverter=ok});var Wm=F(xa=>{"use strict";Object.defineProperty(xa,"__esModule",{value:!0});xa.createConverter=void 0;var z=require("vscode"),se=ce(),Cn=vn(),qe=ro(),ak=Ju(),ck=el(),uk=nl(),lk=il(),$m=ol(),dk=cl(),fk=ll(),hk=fl(),pk=pl(),jm=ce(),Ea;(function(n){function e(t){let r=t;return r&&Cn.string(r.language)&&Cn.string(r.value)}n.is=e})(Ea||(Ea={}));function gk(n,e,t){let i=n||(d=>z.Uri.parse(d));function s(d){return i(d)}function o(d){let I=[];for(let W of d)if(typeof W=="string")I.push(W);else if(jm.NotebookCellTextDocumentFilter.is(W))if(typeof W.notebook=="string")I.push({notebookType:W.notebook,language:W.language});else{let ee=W.notebook.notebookType??"*";I.push({notebookType:ee,scheme:W.notebook.scheme,pattern:W.notebook.pattern,language:W.language})}else jm.TextDocumentFilter.is(W)&&I.push({language:W.language,scheme:W.scheme,pattern:W.pattern});return I}async function a(d,I){return qe.map(d,u,I)}function c(d){let I=new Array(d.length);for(let W=0;W<d.length;W++)I[W]=u(d[W]);return I}function u(d){let I=new $m.ProtocolDiagnostic(T(d.range),d.message,R(d.severity),d.data);if(d.code!==void 0){if(typeof d.code=="string"||typeof d.code=="number")se.CodeDescription.is(d.codeDescription)?I.code={value:d.code,target:s(d.codeDescription.href)}:I.code=d.code;else if($m.DiagnosticCode.is(d.code)){I.hasDiagnosticCode=!0;let W=d.code;I.code={value:W.value,target:s(W.target)}}}return d.source&&(I.source=d.source),d.relatedInformation&&(I.relatedInformation=l(d.relatedInformation)),Array.isArray(d.tags)&&(I.tags=h(d.tags)),I}function l(d){let I=new Array(d.length);for(let W=0;W<d.length;W++){let ee=d[W];I[W]=new z.DiagnosticRelatedInformation(ut(ee.location),ee.message)}return I}function h(d){if(!d)return;let I=[];for(let W of d){let ee=p(W);ee!==void 0&&I.push(ee)}return I.length>0?I:void 0}function p(d){switch(d){case se.DiagnosticTag.Unnecessary:return z.DiagnosticTag.Unnecessary;case se.DiagnosticTag.Deprecated:return z.DiagnosticTag.Deprecated;default:return}}function C(d){return d?new z.Position(d.line,d.character):void 0}function T(d){return d?new z.Range(d.start.line,d.start.character,d.end.line,d.end.character):void 0}async function y(d,I){return qe.map(d,W=>new z.Range(W.start.line,W.start.character,W.end.line,W.end.character),I)}function R(d){if(d==null)return z.DiagnosticSeverity.Error;switch(d){case se.DiagnosticSeverity.Error:return z.DiagnosticSeverity.Error;case se.DiagnosticSeverity.Warning:return z.DiagnosticSeverity.Warning;case se.DiagnosticSeverity.Information:return z.DiagnosticSeverity.Information;case se.DiagnosticSeverity.Hint:return z.DiagnosticSeverity.Hint}return z.DiagnosticSeverity.Error}function S(d){if(Cn.string(d))return b(d);if(Ea.is(d))return b().appendCodeblock(d.value,d.language);if(Array.isArray(d)){let I=[];for(let W of d){let ee=b();Ea.is(W)?ee.appendCodeblock(W.value,W.language):ee.appendMarkdown(W),I.push(ee)}return I}else return b(d)}function v(d){if(Cn.string(d))return d;switch(d.kind){case se.MarkupKind.Markdown:return b(d.value);case se.MarkupKind.PlainText:return d.value;default:return`Unsupported Markup content received. Kind is: ${d.kind}`}}function b(d){let I;if(d===void 0||typeof d=="string")I=new z.MarkdownString(d);else switch(d.kind){case se.MarkupKind.Markdown:I=new z.MarkdownString(d.value);break;case se.MarkupKind.PlainText:I=new z.MarkdownString,I.appendText(d.value);break;default:I=new z.MarkdownString,I.appendText(`Unsupported Markup content received. Kind is: ${d.kind}`);break}return I.isTrusted=e,I.supportHtml=t,I}function P(d){if(!!d)return new z.Hover(S(d.contents),T(d.range))}async function N(d,I,W){if(!d)return;if(Array.isArray(d))return qe.map(d,Bn=>Y(Bn,I),W);let ee=d,{defaultRange:Rt,commitCharacters:dt}=q(ee,I),Le=await qe.map(ee.items,Bn=>{var Fe,Qr,vs;return Y(Bn,dt,Rt,(Fe=ee.itemDefaults)==null?void 0:Fe.insertTextMode,(Qr=ee.itemDefaults)==null?void 0:Qr.insertTextFormat,(vs=ee.itemDefaults)==null?void 0:vs.data)},W);return new z.CompletionList(Le,ee.isIncomplete)}function q(d,I){var Rt,dt;let W=(Rt=d.itemDefaults)==null?void 0:Rt.editRange,ee=((dt=d.itemDefaults)==null?void 0:dt.commitCharacters)??I;return se.Range.is(W)?{defaultRange:T(W),commitCharacters:ee}:W!==void 0?{defaultRange:{inserting:T(W.insert),replacing:T(W.replace)},commitCharacters:ee}:{defaultRange:void 0,commitCharacters:ee}}function O(d){return se.CompletionItemKind.Text<=d&&d<=se.CompletionItemKind.TypeParameter?[d-1,void 0]:[z.CompletionItemKind.Text,d]}function H(d){switch(d){case se.CompletionItemTag.Deprecated:return z.CompletionItemTag.Deprecated}}function B(d){if(d==null)return[];let I=[];for(let W of d){let ee=H(W);ee!==void 0&&I.push(ee)}return I}function Y(d,I,W,ee,Rt,dt){let Le=B(d.tags),Bn=Z(d),Fe=new ak.default(Bn);d.detail&&(Fe.detail=d.detail),d.documentation&&(Fe.documentation=v(d.documentation),Fe.documentationFormat=Cn.string(d.documentation)?"$string":d.documentation.kind),d.filterText&&(Fe.filterText=d.filterText);let Qr=Oe(d,W,Rt);if(Qr&&(Fe.insertText=Qr.text,Fe.range=Qr.range,Fe.fromEdit=Qr.fromEdit),Cn.number(d.kind)){let[Nb,Jd]=O(d.kind);Fe.kind=Nb,Jd&&(Fe.originalItemKind=Jd)}d.sortText&&(Fe.sortText=d.sortText),d.additionalTextEdits&&(Fe.additionalTextEdits=de(d.additionalTextEdits));let vs=d.commitCharacters!==void 0?Cn.stringArray(d.commitCharacters)?d.commitCharacters:void 0:I;vs&&(Fe.commitCharacters=vs.slice()),d.command&&(Fe.command=lt(d.command)),(d.deprecated===!0||d.deprecated===!1)&&(Fe.deprecated=d.deprecated,d.deprecated===!0&&Le.push(z.CompletionItemTag.Deprecated)),(d.preselect===!0||d.preselect===!1)&&(Fe.preselect=d.preselect);let Yd=d.data??dt;Yd!==void 0&&(Fe.data=Yd),Le.length>0&&(Fe.tags=Le);let $c=d.insertTextMode??ee;return $c!==void 0&&(Fe.insertTextMode=$c,$c===se.InsertTextMode.asIs&&(Fe.keepWhitespace=!0)),Fe}function Z(d){return se.CompletionItemLabelDetails.is(d.labelDetails)?{label:d.label,detail:d.labelDetails.detail,description:d.labelDetails.description}:d.label}function Oe(d,I,W){let ee=d.insertTextFormat??W;if(d.textEdit!==void 0||I!==void 0){let[Rt,dt]=d.textEdit!==void 0?ot(d.textEdit):[I,d.textEditText??d.label];return ee===se.InsertTextFormat.Snippet?{text:new z.SnippetString(dt),range:Rt,fromEdit:!0}:{text:dt,range:Rt,fromEdit:!0}}else return d.insertText?ee===se.InsertTextFormat.Snippet?{text:new z.SnippetString(d.insertText),fromEdit:!1}:{text:d.insertText,fromEdit:!1}:void 0}function ot(d){return se.InsertReplaceEdit.is(d)?[{inserting:T(d.insert),replacing:T(d.replace)},d.newText]:[T(d.range),d.newText]}function Ye(d){if(!!d)return new z.TextEdit(T(d.range),d.newText)}async function He(d,I){if(!!d)return qe.map(d,Ye,I)}function de(d){if(!d)return;let I=new Array(d.length);for(let W=0;W<d.length;W++)I[W]=Ye(d[W]);return I}async function Ue(d,I){if(!d)return;let W=new z.SignatureHelp;return Cn.number(d.activeSignature)?W.activeSignature=d.activeSignature:W.activeSignature=0,Cn.number(d.activeParameter)?W.activeParameter=d.activeParameter:W.activeParameter=0,d.signatures&&(W.signatures=await je(d.signatures,I)),W}async function je(d,I){return qe.mapAsync(d,mt,I)}async function mt(d,I){let W=new z.SignatureInformation(d.label);return d.documentation!==void 0&&(W.documentation=v(d.documentation)),d.parameters!==void 0&&(W.parameters=await Tt(d.parameters,I)),d.activeParameter!==void 0&&(W.activeParameter=d.activeParameter),W}function Tt(d,I){return qe.map(d,nn,I)}function nn(d){let I=new z.ParameterInformation(d.label);return d.documentation&&(I.documentation=v(d.documentation)),I}function ut(d){return d?new z.Location(i(d.uri),T(d.range)):void 0}async function Xr(d,I){if(!!d)return rr(d,I)}async function Rr(d,I){if(!!d)return rr(d,I)}function Sr(d){if(!d)return;let I={targetUri:i(d.targetUri),targetRange:T(d.targetRange),originSelectionRange:T(d.originSelectionRange),targetSelectionRange:T(d.targetSelectionRange)};if(!I.targetSelectionRange)throw new Error("targetSelectionRange must not be undefined or null");return I}async function rr(d,I){if(!!d)if(Cn.array(d)){if(d.length===0)return[];if(se.LocationLink.is(d[0])){let W=d;return qe.map(W,Sr,I)}else{let W=d;return qe.map(W,ut,I)}}else return se.LocationLink.is(d)?[Sr(d)]:ut(d)}async function ir(d,I){if(!!d)return qe.map(d,ut,I)}async function Br(d,I){if(!!d)return qe.map(d,_r,I)}function _r(d){let I=new z.DocumentHighlight(T(d.range));return Cn.number(d.kind)&&(I.kind=Pr(d.kind)),I}function Pr(d){switch(d){case se.DocumentHighlightKind.Text:return z.DocumentHighlightKind.Text;case se.DocumentHighlightKind.Read:return z.DocumentHighlightKind.Read;case se.DocumentHighlightKind.Write:return z.DocumentHighlightKind.Write}return z.DocumentHighlightKind.Text}async function xt(d,I){if(!!d)return qe.map(d,sr,I)}function dn(d){return d<=se.SymbolKind.TypeParameter?d-1:z.SymbolKind.Property}function kr(d){switch(d){case se.SymbolTag.Deprecated:return z.SymbolTag.Deprecated;default:return}}function rn(d){if(d==null)return;let I=[];for(let W of d){let ee=kr(W);ee!==void 0&&I.push(ee)}return I.length===0?void 0:I}function sr(d){let I=d.data,W=d.location,ee=W.range===void 0||I!==void 0?new hk.default(d.name,dn(d.kind),d.containerName??"",W.range===void 0?i(W.uri):new z.Location(i(d.location.uri),T(W.range)),I):new z.SymbolInformation(d.name,dn(d.kind),d.containerName??"",new z.Location(i(d.location.uri),T(W.range)));return Vt(ee,d),ee}async function Vn(d,I){if(d!=null)return qe.map(d,sn,I)}function sn(d){let I=new z.DocumentSymbol(d.name,d.detail||"",dn(d.kind),T(d.range),T(d.selectionRange));if(Vt(I,d),d.children!==void 0&&d.children.length>0){let W=[];for(let ee of d.children)W.push(sn(ee));I.children=W}return I}function Vt(d,I){d.tags=rn(I.tags),I.deprecated&&(d.tags?d.tags.includes(z.SymbolTag.Deprecated)||(d.tags=d.tags.concat(z.SymbolTag.Deprecated)):d.tags=[z.SymbolTag.Deprecated])}function lt(d){let I={title:d.title,command:d.command};return d.arguments&&(I.arguments=d.arguments),I}async function Gr(d,I){if(!!d)return qe.map(d,lt,I)}let Mt=new Map;Mt.set(se.CodeActionKind.Empty,z.CodeActionKind.Empty),Mt.set(se.CodeActionKind.QuickFix,z.CodeActionKind.QuickFix),Mt.set(se.CodeActionKind.Refactor,z.CodeActionKind.Refactor),Mt.set(se.CodeActionKind.RefactorExtract,z.CodeActionKind.RefactorExtract),Mt.set(se.CodeActionKind.RefactorInline,z.CodeActionKind.RefactorInline),Mt.set(se.CodeActionKind.RefactorRewrite,z.CodeActionKind.RefactorRewrite),Mt.set(se.CodeActionKind.Source,z.CodeActionKind.Source),Mt.set(se.CodeActionKind.SourceOrganizeImports,z.CodeActionKind.SourceOrganizeImports);function on(d){if(d==null)return;let I=Mt.get(d);if(I)return I;let W=d.split(".");I=z.CodeActionKind.Empty;for(let ee of W)I=I.append(ee);return I}function Xn(d){if(d!=null)return d.map(I=>on(I))}async function or(d,I){if(d==null)return;let W=new lk.default(d.title,d.data);return d.kind!==void 0&&(W.kind=on(d.kind)),d.diagnostics!==void 0&&(W.diagnostics=c(d.diagnostics)),d.edit!==void 0&&(W.edit=await _(d.edit,I)),d.command!==void 0&&(W.command=lt(d.command)),d.isPreferred!==void 0&&(W.isPreferred=d.isPreferred),d.disabled!==void 0&&(W.disabled={reason:d.disabled.reason}),W}function ar(d,I){return qe.mapAsync(d,async W=>se.Command.is(W)?lt(W):or(W,I),I)}function an(d){if(!d)return;let I=new ck.default(T(d.range));return d.command&&(I.command=lt(d.command)),d.data!==void 0&&d.data!==null&&(I.data=d.data),I}async function fn(d,I){if(!!d)return qe.map(d,an,I)}async function _(d,I){if(!d)return;let W=new Map;if(d.changeAnnotations!==void 0){let dt=d.changeAnnotations;await qe.forEach(Object.keys(dt),Le=>{let Bn=M(dt[Le]);W.set(Le,Bn)},I)}let ee=dt=>{if(dt!==void 0)return W.get(dt)},Rt=new z.WorkspaceEdit;if(d.documentChanges){let dt=d.documentChanges;await qe.forEach(dt,Le=>{if(se.CreateFile.is(Le))Rt.createFile(i(Le.uri),Le.options,ee(Le.annotationId));else if(se.RenameFile.is(Le))Rt.renameFile(i(Le.oldUri),i(Le.newUri),Le.options,ee(Le.annotationId));else if(se.DeleteFile.is(Le))Rt.deleteFile(i(Le.uri),Le.options,ee(Le.annotationId));else if(se.TextDocumentEdit.is(Le)){let Bn=i(Le.textDocument.uri);for(let Fe of Le.edits)se.AnnotatedTextEdit.is(Fe)?Rt.replace(Bn,T(Fe.range),Fe.newText,ee(Fe.annotationId)):Rt.replace(Bn,T(Fe.range),Fe.newText)}else throw new Error(`Unknown workspace edit change received:
${JSON.stringify(Le,void 0,4)}`)},I)}else if(d.changes){let dt=d.changes;await qe.forEach(Object.keys(dt),Le=>{Rt.set(i(Le),de(dt[Le]))},I)}return Rt}function M(d){if(d!==void 0)return{label:d.label,needsConfirmation:!!d.needsConfirmation,description:d.description}}function U(d){let I=T(d.range),W=d.target?s(d.target):void 0,ee=new uk.default(I,W);return d.tooltip!==void 0&&(ee.tooltip=d.tooltip),d.data!==void 0&&d.data!==null&&(ee.data=d.data),ee}async function X(d,I){if(!!d)return qe.map(d,U,I)}function Te(d){return new z.Color(d.red,d.green,d.blue,d.alpha)}function Re(d){return new z.ColorInformation(T(d.range),Te(d.color))}async function Se(d,I){if(!!d)return qe.map(d,Re,I)}function Ke(d){let I=new z.ColorPresentation(d.label);return I.additionalTextEdits=de(d.additionalTextEdits),d.textEdit&&(I.textEdit=Ye(d.textEdit)),I}async function ge(d,I){if(!!d)return qe.map(d,Ke,I)}function Ee(d){if(d)switch(d){case se.FoldingRangeKind.Comment:return z.FoldingRangeKind.Comment;case se.FoldingRangeKind.Imports:return z.FoldingRangeKind.Imports;case se.FoldingRangeKind.Region:return z.FoldingRangeKind.Region}}function me(d){return new z.FoldingRange(d.startLine,d.endLine,Ee(d.kind))}async function g(d,I){if(!!d)return qe.map(d,me,I)}function A(d){return new z.SelectionRange(T(d.range),d.parent?A(d.parent):void 0)}async function V(d,I){return Array.isArray(d)?qe.map(d,A,I):[]}function he(d){return se.InlineValueText.is(d)?new z.InlineValueText(T(d.range),d.text):se.InlineValueVariableLookup.is(d)?new z.InlineValueVariableLookup(T(d.range),d.variableName,d.caseSensitiveLookup):new z.InlineValueEvaluatableExpression(T(d.range),d.expression)}async function x(d,I){return Array.isArray(d)?qe.map(d,he,I):[]}async function m(d,I){let W=typeof d.label=="string"?d.label:await qe.map(d.label,k,I),ee=new pk.default(C(d.position),W);return d.kind!==void 0&&(ee.kind=d.kind),d.textEdits!==void 0&&(ee.textEdits=await He(d.textEdits,I)),d.tooltip!==void 0&&(ee.tooltip=E(d.tooltip)),d.paddingLeft!==void 0&&(ee.paddingLeft=d.paddingLeft),d.paddingRight!==void 0&&(ee.paddingRight=d.paddingRight),d.data!==void 0&&(ee.data=d.data),ee}function k(d){let I=new z.InlayHintLabelPart(d.value);return d.location!==void 0&&(I.location=ut(d.location)),d.tooltip!==void 0&&(I.tooltip=E(d.tooltip)),d.command!==void 0&&(I.command=lt(d.command)),I}function E(d){return typeof d=="string"?d:b(d)}async function D(d,I){if(!!Array.isArray(d))return qe.mapAsync(d,m,I)}function f(d){if(d===null)return;let I=new dk.default(dn(d.kind),d.name,d.detail||"",s(d.uri),T(d.range),T(d.selectionRange),d.data);return d.tags!==void 0&&(I.tags=rn(d.tags)),I}async function L(d,I){if(d!==null)return qe.map(d,f,I)}async function $(d,I){return new z.CallHierarchyIncomingCall(f(d.from),await y(d.fromRanges,I))}async function ae(d,I){if(d!==null)return qe.mapAsync(d,$,I)}async function ze(d,I){return new z.CallHierarchyOutgoingCall(f(d.to),await y(d.fromRanges,I))}async function $e(d,I){if(d!==null)return qe.mapAsync(d,ze,I)}async function cn(d,I){if(d!=null)return new z.SemanticTokens(new Uint32Array(d.data),d.resultId)}function Xt(d){return new z.SemanticTokensEdit(d.start,d.deleteCount,d.data!==void 0?new Uint32Array(d.data):void 0)}async function kn(d,I){if(d!=null)return new z.SemanticTokensEdits(d.edits.map(Xt),d.resultId)}function ye(d){return d}async function Er(d,I){if(d!=null)return new z.LinkedEditingRanges(await y(d.ranges,I),_i(d.wordPattern))}function _i(d){if(d!=null)return new RegExp(d)}function ms(d){if(d===null)return;let I=new fk.default(dn(d.kind),d.name,d.detail||"",s(d.uri),T(d.range),T(d.selectionRange),d.data);return d.tags!==void 0&&(I.tags=rn(d.tags)),I}async function Ib(d,I){if(d!==null)return qe.map(d,ms,I)}function Fb(d){if(Cn.string(d))return d;if(se.RelativePattern.is(d)){if(se.URI.is(d.baseUri))return new z.RelativePattern(s(d.baseUri),d.pattern);if(se.WorkspaceFolder.is(d.baseUri)){let I=z.workspace.getWorkspaceFolder(s(d.baseUri.uri));return I!==void 0?new z.RelativePattern(I,d.pattern):void 0}}}return{asUri:s,asDocumentSelector:o,asDiagnostics:a,asDiagnostic:u,asRange:T,asRanges:y,asPosition:C,asDiagnosticSeverity:R,asDiagnosticTag:p,asHover:P,asCompletionResult:N,asCompletionItem:Y,asTextEdit:Ye,asTextEdits:He,asSignatureHelp:Ue,asSignatureInformations:je,asSignatureInformation:mt,asParameterInformations:Tt,asParameterInformation:nn,asDeclarationResult:Xr,asDefinitionResult:Rr,asLocation:ut,asReferences:ir,asDocumentHighlights:Br,asDocumentHighlight:_r,asDocumentHighlightKind:Pr,asSymbolKind:dn,asSymbolTag:kr,asSymbolTags:rn,asSymbolInformations:xt,asSymbolInformation:sr,asDocumentSymbols:Vn,asDocumentSymbol:sn,asCommand:lt,asCommands:Gr,asCodeAction:or,asCodeActionKind:on,asCodeActionKinds:Xn,asCodeActionResult:ar,asCodeLens:an,asCodeLenses:fn,asWorkspaceEdit:_,asDocumentLink:U,asDocumentLinks:X,asFoldingRangeKind:Ee,asFoldingRange:me,asFoldingRanges:g,asColor:Te,asColorInformation:Re,asColorInformations:Se,asColorPresentation:Ke,asColorPresentations:ge,asSelectionRange:A,asSelectionRanges:V,asInlineValue:he,asInlineValues:x,asInlayHint:m,asInlayHints:D,asSemanticTokensLegend:ye,asSemanticTokens:cn,asSemanticTokensEdit:Xt,asSemanticTokensEdits:kn,asCallHierarchyItem:f,asCallHierarchyItems:L,asCallHierarchyIncomingCall:$,asCallHierarchyIncomingCalls:ae,asCallHierarchyOutgoingCall:ze,asCallHierarchyOutgoingCalls:$e,asLinkedEditingRanges:Er,asTypeHierarchyItem:ms,asTypeHierarchyItems:Ib,asGlobPattern:Fb}}xa.createConverter=gk});var et=F(bn=>{"use strict";Object.defineProperty(bn,"__esModule",{value:!0});bn.generateUuid=bn.parse=bn.isUUID=bn.v4=bn.empty=void 0;var qa=class{constructor(e){this._value=e}asHex(){return this._value}equals(e){return this.asHex()===e.asHex()}},ve=class extends qa{constructor(){super([ve._randomHex(),ve._randomHex(),ve._randomHex(),ve._randomHex(),ve._randomHex(),ve._randomHex(),ve._randomHex(),ve._randomHex(),"-",ve._randomHex(),ve._randomHex(),ve._randomHex(),ve._randomHex(),"-","4",ve._randomHex(),ve._randomHex(),ve._randomHex(),"-",ve._oneOf(ve._timeHighBits),ve._randomHex(),ve._randomHex(),ve._randomHex(),"-",ve._randomHex(),ve._randomHex(),ve._randomHex(),ve._randomHex(),ve._randomHex(),ve._randomHex(),ve._randomHex(),ve._randomHex(),ve._randomHex(),ve._randomHex(),ve._randomHex(),ve._randomHex()].join(""))}static _oneOf(e){return e[Math.floor(e.length*Math.random())]}static _randomHex(){return ve._oneOf(ve._chars)}};ve._chars=["0","1","2","3","4","5","6","6","7","8","9","a","b","c","d","e","f"];ve._timeHighBits=["8","9","a","b"];bn.empty=new qa("00000000-0000-0000-0000-000000000000");function Hm(){return new ve}bn.v4=Hm;var mk=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i;function Um(n){return mk.test(n)}bn.isUUID=Um;function vk(n){if(!Um(n))throw new Error("invalid uuid");return new qa(n)}bn.parse=vk;function yk(){return Hm().asHex()}bn.generateUuid=yk});var ml=F(Ia=>{"use strict";Object.defineProperty(Ia,"__esModule",{value:!0});Ia.ProgressPart=void 0;var Km=require("vscode"),zm=ce(),Vm=vn(),Xm=class{constructor(e,t,r){this._client=e,this._token=t,this._reported=0,this._infinite=!1,this._lspProgressDisposable=this._client.onProgress(zm.WorkDoneProgress.type,this._token,i=>{switch(i.kind){case"begin":this.begin(i);break;case"report":this.report(i);break;case"end":this.done(),r&&r(this);break}})}begin(e){this._infinite=e.percentage===void 0,this._lspProgressDisposable!==void 0&&Km.window.withProgress({location:Km.ProgressLocation.Window,cancellable:e.cancellable,title:e.title},async(t,r)=>{if(this._lspProgressDisposable!==void 0)return this._progress=t,this._cancellationToken=r,this._tokenDisposable=this._cancellationToken.onCancellationRequested(()=>{this._client.sendNotification(zm.WorkDoneProgressCancelNotification.type,{token:this._token})}),this.report(e),new Promise((i,s)=>{this._resolve=i,this._reject=s})})}report(e){if(this._infinite&&Vm.string(e.message))this._progress!==void 0&&this._progress.report({message:e.message});else if(Vm.number(e.percentage)){let t=Math.max(0,Math.min(e.percentage,100)),r=Math.max(0,t-this._reported);this._reported+=r,this._progress!==void 0&&this._progress.report({message:e.message,increment:r})}}cancel(){this.cleanup(),this._reject!==void 0&&(this._reject(),this._resolve=void 0,this._reject=void 0)}done(){this.cleanup(),this._resolve!==void 0&&(this._resolve(),this._resolve=void 0,this._reject=void 0)}cleanup(){this._lspProgressDisposable!==void 0&&(this._lspProgressDisposable.dispose(),this._lspProgressDisposable=void 0),this._tokenDisposable!==void 0&&(this._tokenDisposable.dispose(),this._tokenDisposable=void 0),this._progress=void 0,this._cancellationToken=void 0}};Ia.ProgressPart=Xm});var be=F(gt=>{"use strict";Object.defineProperty(gt,"__esModule",{value:!0});gt.WorkspaceFeature=gt.TextDocumentLanguageFeature=gt.TextDocumentEventFeature=gt.DynamicDocumentFeature=gt.DynamicFeature=gt.StaticFeature=gt.ensure=gt.LSPCancellationError=void 0;var fi=require("vscode"),vl=ce(),Kt=vn(),Bm=et(),Gm=class extends fi.CancellationError{constructor(e){super();this.data=e}};gt.LSPCancellationError=Gm;function wk(n,e){return n[e]===void 0&&(n[e]={}),n[e]}gt.ensure=wk;var Ck;(function(n){function e(t){let r=t;return r!=null&&Kt.func(r.fillClientCapabilities)&&Kt.func(r.initialize)&&Kt.func(r.getState)&&Kt.func(r.dispose)&&(r.fillInitializeParams===void 0||Kt.func(r.fillInitializeParams))}n.is=e})(Ck=gt.StaticFeature||(gt.StaticFeature={}));var bk;(function(n){function e(t){let r=t;return r!=null&&Kt.func(r.fillClientCapabilities)&&Kt.func(r.initialize)&&Kt.func(r.getState)&&Kt.func(r.dispose)&&(r.fillInitializeParams===void 0||Kt.func(r.fillInitializeParams))&&Kt.func(r.register)&&Kt.func(r.unregister)&&r.registrationType!==void 0}n.is=e})(bk=gt.DynamicFeature||(gt.DynamicFeature={}));var Fa=class{constructor(e){this._client=e}getState(){let e=this.getDocumentSelectors(),t=0;for(let i of e){t++;for(let s of fi.workspace.textDocuments)if(fi.languages.match(i,s)>0)return{kind:"document",id:this.registrationType.method,registrations:!0,matches:!0}}let r=t>0;return{kind:"document",id:this.registrationType.method,registrations:r,matches:!1}}};gt.DynamicDocumentFeature=Fa;var Qm=class extends Fa{constructor(e,t,r,i,s,o,a){super(e);this._event=t,this._type=r,this._middleware=i,this._createParams=s,this._textDocument=o,this._selectorFilter=a,this._selectors=new Map,this._onNotificationSent=new fi.EventEmitter}static textDocumentFilter(e,t){for(let r of e)if(fi.languages.match(r,t)>0)return!0;return!1}getStateInfo(){return[this._selectors.values(),!1]}getDocumentSelectors(){return this._selectors.values()}register(e){!e.registerOptions.documentSelector||(this._listener||(this._listener=this._event(t=>{this.callback(t).catch(r=>{this._client.error(`Sending document notification ${this._type.method} failed.`,r)})})),this._selectors.set(e.id,this._client.protocol2CodeConverter.asDocumentSelector(e.registerOptions.documentSelector)))}async callback(e){let t=async r=>{let i=this._createParams(r);await this._client.sendNotification(this._type,i).catch(),this.notificationSent(r,this._type,i)};if(this.matches(e)){let r=this._middleware();return r?r(e,i=>t(i)):t(e)}}matches(e){return this._client.hasDedicatedTextSynchronizationFeature(this._textDocument(e))?!1:!this._selectorFilter||this._selectorFilter(this._selectors.values(),e)}get onNotificationSent(){return this._onNotificationSent.event}notificationSent(e,t,r){this._onNotificationSent.fire({original:e,type:t,params:r})}unregister(e){this._selectors.delete(e),this._selectors.size===0&&this._listener&&(this._listener.dispose(),this._listener=void 0)}dispose(){this._selectors.clear(),this._onNotificationSent.dispose(),this._listener&&(this._listener.dispose(),this._listener=void 0)}getProvider(e){for(let t of this._selectors.values())if(fi.languages.match(t,e)>0)return{send:r=>this.callback(r)}}};gt.TextDocumentEventFeature=Qm;var Ym=class extends Fa{constructor(e,t){super(e);this._registrationType=t,this._registrations=new Map}*getDocumentSelectors(){for(let e of this._registrations.values()){let t=e.data.registerOptions.documentSelector;t!==null&&(yield this._client.protocol2CodeConverter.asDocumentSelector(t))}}get registrationType(){return this._registrationType}register(e){if(!e.registerOptions.documentSelector)return;let t=this.registerLanguageProvider(e.registerOptions,e.id);this._registrations.set(e.id,{disposable:t[0],data:e,provider:t[1]})}unregister(e){let t=this._registrations.get(e);t!==void 0&&t.disposable.dispose()}dispose(){this._registrations.forEach(e=>{e.disposable.dispose()}),this._registrations.clear()}getRegistration(e,t){if(t){if(vl.TextDocumentRegistrationOptions.is(t)){let r=vl.StaticRegistrationOptions.hasId(t)?t.id:Bm.generateUuid(),i=t.documentSelector||e;if(i)return[r,Object.assign({},t,{documentSelector:i})]}else if(Kt.boolean(t)&&t===!0||vl.WorkDoneProgressOptions.is(t)){if(!e)return[void 0,void 0];let r=Kt.boolean(t)&&t===!0?{documentSelector:e}:Object.assign({},t,{documentSelector:e});return[Bm.generateUuid(),r]}}else return[void 0,void 0];return[void 0,void 0]}getRegistrationOptions(e,t){if(!(!e||!t))return Kt.boolean(t)&&t===!0?{documentSelector:e}:Object.assign({},t,{documentSelector:e})}getProvider(e){for(let t of this._registrations.values()){let r=t.data.registerOptions.documentSelector;if(r!==null&&fi.languages.match(this._client.protocol2CodeConverter.asDocumentSelector(r),e)>0)return t.provider}}getAllProviders(){let e=[];for(let t of this._registrations.values())e.push(t.provider);return e}};gt.TextDocumentLanguageFeature=Ym;var Jm=class{constructor(e,t){this._client=e,this._registrationType=t,this._registrations=new Map}getState(){let e=this._registrations.size>0;return{kind:"workspace",id:this._registrationType.method,registrations:e}}get registrationType(){return this._registrationType}register(e){let t=this.registerLanguageProvider(e.registerOptions);this._registrations.set(e.id,{disposable:t[0],provider:t[1]})}unregister(e){let t=this._registrations.get(e);t!==void 0&&t.disposable.dispose()}dispose(){this._registrations.forEach(e=>{e.disposable.dispose()}),this._registrations.clear()}getProviders(){let e=[];for(let t of this._registrations.values())e.push(t.provider);return e}};gt.WorkspaceFeature=Jm});var ev=F((CN,Zm)=>{Zm.exports=function(n,e){for(var t=[],r=0;r<n.length;r++){var i=e(n[r],r);Dk(i)?t.push.apply(t,i):t.push(i)}return t};var Dk=Array.isArray||function(n){return Object.prototype.toString.call(n)==="[object Array]"}});var sv=F((bN,iv)=>{"use strict";iv.exports=tv;function tv(n,e,t){n instanceof RegExp&&(n=nv(n,t)),e instanceof RegExp&&(e=nv(e,t));var r=rv(n,e,t);return r&&{start:r[0],end:r[1],pre:t.slice(0,r[0]),body:t.slice(r[0]+n.length,r[1]),post:t.slice(r[1]+e.length)}}function nv(n,e){var t=e.match(n);return t?t[0]:null}tv.range=rv;function rv(n,e,t){var r,i,s,o,a,c=t.indexOf(n),u=t.indexOf(e,c+1),l=c;if(c>=0&&u>0){if(n===e)return[c,u];for(r=[],s=t.length;l>=0&&!a;)l==c?(r.push(l),c=t.indexOf(n,l+1)):r.length==1?a=[r.pop(),u]:(i=r.pop(),i<s&&(s=i,o=u),u=t.indexOf(e,l+1)),l=c<u&&c>=0?c:u;r.length&&(a=[s,o])}return a}});var hv=F((DN,fv)=>{var Tk=ev(),ov=sv();fv.exports=_k;var av="\0SLASH"+Math.random()+"\0",cv="\0OPEN"+Math.random()+"\0",yl="\0CLOSE"+Math.random()+"\0",uv="\0COMMA"+Math.random()+"\0",lv="\0PERIOD"+Math.random()+"\0";function wl(n){return parseInt(n,10)==n?parseInt(n,10):n.charCodeAt(0)}function Rk(n){return n.split("\\\\").join(av).split("\\{").join(cv).split("\\}").join(yl).split("\\,").join(uv).split("\\.").join(lv)}function Sk(n){return n.split(av).join("\\").split(cv).join("{").split(yl).join("}").split(uv).join(",").split(lv).join(".")}function dv(n){if(!n)return[""];var e=[],t=ov("{","}",n);if(!t)return n.split(",");var r=t.pre,i=t.body,s=t.post,o=r.split(",");o[o.length-1]+="{"+i+"}";var a=dv(s);return s.length&&(o[o.length-1]+=a.shift(),o.push.apply(o,a)),e.push.apply(e,o),e}function _k(n){return n?(n.substr(0,2)==="{}"&&(n="\\{\\}"+n.substr(2)),Xi(Rk(n),!0).map(Sk)):[]}function Pk(n){return"{"+n+"}"}function kk(n){return/^-?0\d/.test(n)}function Ek(n,e){return n<=e}function xk(n,e){return n>=e}function Xi(n,e){var t=[],r=ov("{","}",n);if(!r||/\$$/.test(r.pre))return[n];var i=/^-?\d+\.\.-?\d+(?:\.\.-?\d+)?$/.test(r.body),s=/^[a-zA-Z]\.\.[a-zA-Z](?:\.\.-?\d+)?$/.test(r.body),o=i||s,a=r.body.indexOf(",")>=0;if(!o&&!a)return r.post.match(/,.*\}/)?(n=r.pre+"{"+r.body+yl+r.post,Xi(n)):[n];var c;if(o)c=r.body.split(/\.\./);else if(c=dv(r.body),c.length===1&&(c=Xi(c[0],!1).map(Pk),c.length===1)){var l=r.post.length?Xi(r.post,!1):[""];return l.map(function(Z){return r.pre+c[0]+Z})}var u=r.pre,l=r.post.length?Xi(r.post,!1):[""],h;if(o){var p=wl(c[0]),C=wl(c[1]),T=Math.max(c[0].length,c[1].length),y=c.length==3?Math.abs(wl(c[2])):1,R=Ek,S=C<p;S&&(y*=-1,R=xk);var v=c.some(kk);h=[];for(var b=p;R(b,C);b+=y){var P;if(s)P=String.fromCharCode(b),P==="\\"&&(P="");else if(P=String(b),v){var N=T-P.length;if(N>0){var q=new Array(N+1).join("0");b<0?P="-"+q+P.slice(1):P=q+P}}h.push(P)}}else h=Tk(c,function(Y){return Xi(Y,!1)});for(var O=0;O<h.length;O++)for(var H=0;H<l.length;H++){var B=u+h[O]+l[H];(!e||o||B)&&t.push(B)}return t}});var Oa=F((TN,wv)=>{wv.exports=Dn;Dn.Minimatch=bt;var io={sep:"/"};try{io=require("path")}catch{}var Cl=Dn.GLOBSTAR=bt.GLOBSTAR={},qk=hv(),pv={"!":{open:"(?:(?!(?:",close:"))[^/]*?)"},"?":{open:"(?:",close:")?"},"+":{open:"(?:",close:")+"},"*":{open:"(?:",close:")*"},"@":{open:"(?:",close:")"}},bl="[^/]",Dl=bl+"*?",Ik="(?:(?!(?:\\/|^)(?:\\.{1,2})($|\\/)).)*?",Fk="(?:(?!(?:\\/|^)\\.).)*?",gv=Nk("().*{}+?[]^$\\!");function Nk(n){return n.split("").reduce(function(e,t){return e[t]=!0,e},{})}var mv=/\/+/;Dn.filter=Ok;function Ok(n,e){return e=e||{},function(t,r,i){return Dn(t,n,e)}}function vv(n,e){n=n||{},e=e||{};var t={};return Object.keys(e).forEach(function(r){t[r]=e[r]}),Object.keys(n).forEach(function(r){t[r]=n[r]}),t}Dn.defaults=function(n){if(!n||!Object.keys(n).length)return Dn;var e=Dn,t=function(i,s,o){return e.minimatch(i,s,vv(n,o))};return t.Minimatch=function(i,s){return new e.Minimatch(i,vv(n,s))},t};bt.defaults=function(n){return!n||!Object.keys(n).length?bt:Dn.defaults(n).Minimatch};function Dn(n,e,t){if(typeof e!="string")throw new TypeError("glob pattern string required");return t||(t={}),!t.nocomment&&e.charAt(0)==="#"?!1:e.trim()===""?n==="":new bt(e,t).match(n)}function bt(n,e){if(!(this instanceof bt))return new bt(n,e);if(typeof n!="string")throw new TypeError("glob pattern string required");e||(e={}),n=n.trim(),io.sep!=="/"&&(n=n.split(io.sep).join("/")),this.options=e,this.set=[],this.pattern=n,this.regexp=null,this.negate=!1,this.comment=!1,this.empty=!1,this.make()}bt.prototype.debug=function(){};bt.prototype.make=Lk;function Lk(){if(!this._made){var n=this.pattern,e=this.options;if(!e.nocomment&&n.charAt(0)==="#"){this.comment=!0;return}if(!n){this.empty=!0;return}this.parseNegate();var t=this.globSet=this.braceExpand();e.debug&&(this.debug=console.error),this.debug(this.pattern,t),t=this.globParts=t.map(function(r){return r.split(mv)}),this.debug(this.pattern,t),t=t.map(function(r,i,s){return r.map(this.parse,this)},this),this.debug(this.pattern,t),t=t.filter(function(r){return r.indexOf(!1)===-1}),this.debug(this.pattern,t),this.set=t}}bt.prototype.parseNegate=Ak;function Ak(){var n=this.pattern,e=!1,t=this.options,r=0;if(!t.nonegate){for(var i=0,s=n.length;i<s&&n.charAt(i)==="!";i++)e=!e,r++;r&&(this.pattern=n.substr(r)),this.negate=e}}Dn.braceExpand=function(n,e){return yv(n,e)};bt.prototype.braceExpand=yv;function yv(n,e){if(e||(this instanceof bt?e=this.options:e={}),n=typeof n=="undefined"?this.pattern:n,typeof n=="undefined")throw new TypeError("undefined pattern");return e.nobrace||!n.match(/\{.*\}/)?[n]:qk(n)}bt.prototype.parse=Mk;var Na={};function Mk(n,e){if(n.length>1024*64)throw new TypeError("pattern is too long");var t=this.options;if(!t.noglobstar&&n==="**")return Cl;if(n==="")return"";var r="",i=!!t.nocase,s=!1,o=[],a=[],c,u=!1,l=-1,h=-1,p=n.charAt(0)==="."?"":t.dot?"(?!(?:^|\\/)\\.{1,2}(?:$|\\/))":"(?!\\.)",C=this;function T(){if(c){switch(c){case"*":r+=Dl,i=!0;break;case"?":r+=bl,i=!0;break;default:r+="\\"+c;break}C.debug("clearStateChar %j %j",c,r),c=!1}}for(var y=0,R=n.length,S;y<R&&(S=n.charAt(y));y++){if(this.debug("%s	%s %s %j",n,y,r,S),s&&gv[S]){r+="\\"+S,s=!1;continue}switch(S){case"/":return!1;case"\\":T(),s=!0;continue;case"?":case"*":case"+":case"@":case"!":if(this.debug("%s	%s %s %j <-- stateChar",n,y,r,S),u){this.debug("  in class"),S==="!"&&y===h+1&&(S="^"),r+=S;continue}C.debug("call clearStateChar %j",c),T(),c=S,t.noext&&T();continue;case"(":if(u){r+="(";continue}if(!c){r+="\\(";continue}o.push({type:c,start:y-1,reStart:r.length,open:pv[c].open,close:pv[c].close}),r+=c==="!"?"(?:(?!(?:":"(?:",this.debug("plType %j %j",c,r),c=!1;continue;case")":if(u||!o.length){r+="\\)";continue}T(),i=!0;var v=o.pop();r+=v.close,v.type==="!"&&a.push(v),v.reEnd=r.length;continue;case"|":if(u||!o.length||s){r+="\\|",s=!1;continue}T(),r+="|";continue;case"[":if(T(),u){r+="\\"+S;continue}u=!0,h=y,l=r.length,r+=S;continue;case"]":if(y===h+1||!u){r+="\\"+S,s=!1;continue}if(u){var b=n.substring(h+1,y);try{RegExp("["+b+"]")}catch{var P=this.parse(b,Na);r=r.substr(0,l)+"\\["+P[0]+"\\]",i=i||P[1],u=!1;continue}}i=!0,u=!1,r+=S;continue;default:T(),s?s=!1:gv[S]&&!(S==="^"&&u)&&(r+="\\"),r+=S}}for(u&&(b=n.substr(h+1),P=this.parse(b,Na),r=r.substr(0,l)+"\\["+P[0],i=i||P[1]),v=o.pop();v;v=o.pop()){var N=r.slice(v.reStart+v.open.length);this.debug("setting tail",r,v),N=N.replace(/((?:\\{2}){0,64})(\\?)\|/g,function(Tt,nn,ut){return ut||(ut="\\"),nn+nn+ut+"|"}),this.debug(`tail=%j
   %s`,N,N,v,r);var q=v.type==="*"?Dl:v.type==="?"?bl:"\\"+v.type;i=!0,r=r.slice(0,v.reStart)+q+"\\("+N}T(),s&&(r+="\\\\");var O=!1;switch(r.charAt(0)){case".":case"[":case"(":O=!0}for(var H=a.length-1;H>-1;H--){var B=a[H],Y=r.slice(0,B.reStart),Z=r.slice(B.reStart,B.reEnd-8),Oe=r.slice(B.reEnd-8,B.reEnd),ot=r.slice(B.reEnd);Oe+=ot;var Ye=Y.split("(").length-1,He=ot;for(y=0;y<Ye;y++)He=He.replace(/\)[+*?]?/,"");ot=He;var de="";ot===""&&e!==Na&&(de="$");var Ue=Y+Z+ot+de+Oe;r=Ue}if(r!==""&&i&&(r="(?=.)"+r),O&&(r=p+r),e===Na)return[r,i];if(!i)return Wk(n);var je=t.nocase?"i":"";try{var mt=new RegExp("^"+r+"$",je)}catch{return new RegExp("$.")}return mt._glob=n,mt._src=r,mt}Dn.makeRe=function(n,e){return new bt(n,e||{}).makeRe()};bt.prototype.makeRe=$k;function $k(){if(this.regexp||this.regexp===!1)return this.regexp;var n=this.set;if(!n.length)return this.regexp=!1,this.regexp;var e=this.options,t=e.noglobstar?Dl:e.dot?Ik:Fk,r=e.nocase?"i":"",i=n.map(function(s){return s.map(function(o){return o===Cl?t:typeof o=="string"?Hk(o):o._src}).join("\\/")}).join("|");i="^(?:"+i+")$",this.negate&&(i="^(?!"+i+").*$");try{this.regexp=new RegExp(i,r)}catch{this.regexp=!1}return this.regexp}Dn.match=function(n,e,t){t=t||{};var r=new bt(e,t);return n=n.filter(function(i){return r.match(i)}),r.options.nonull&&!n.length&&n.push(e),n};bt.prototype.match=jk;function jk(n,e){if(this.debug("match",n,this.pattern),this.comment)return!1;if(this.empty)return n==="";if(n==="/"&&e)return!0;var t=this.options;io.sep!=="/"&&(n=n.split(io.sep).join("/")),n=n.split(mv),this.debug(this.pattern,"split",n);var r=this.set;this.debug(this.pattern,"set",r);var i,s;for(s=n.length-1;s>=0&&(i=n[s],!i);s--);for(s=0;s<r.length;s++){var o=r[s],a=n;t.matchBase&&o.length===1&&(a=[i]);var c=this.matchOne(a,o,e);if(c)return t.flipNegate?!0:!this.negate}return t.flipNegate?!1:this.negate}bt.prototype.matchOne=function(n,e,t){var r=this.options;this.debug("matchOne",{this:this,file:n,pattern:e}),this.debug("matchOne",n.length,e.length);for(var i=0,s=0,o=n.length,a=e.length;i<o&&s<a;i++,s++){this.debug("matchOne loop");var c=e[s],u=n[i];if(this.debug(e,c,u),c===!1)return!1;if(c===Cl){this.debug("GLOBSTAR",[e,c,u]);var l=i,h=s+1;if(h===a){for(this.debug("** at the end");i<o;i++)if(n[i]==="."||n[i]===".."||!r.dot&&n[i].charAt(0)===".")return!1;return!0}for(;l<o;){var p=n[l];if(this.debug(`
globstar while`,n,l,e,h,p),this.matchOne(n.slice(l),e.slice(h),t))return this.debug("globstar found match!",l,o,p),!0;if(p==="."||p===".."||!r.dot&&p.charAt(0)==="."){this.debug("dot detected!",n,l,e,h);break}this.debug("globstar swallow a segment, and continue"),l++}return!!(t&&(this.debug(`
>>> no match, partial?`,n,l,e,h),l===o))}var C;if(typeof c=="string"?(r.nocase?C=u.toLowerCase()===c.toLowerCase():C=u===c,this.debug("string match",c,u,C)):(C=u.match(c),this.debug("pattern match",c,u,C)),!C)return!1}if(i===o&&s===a)return!0;if(i===o)return t;if(s===a){var T=i===o-1&&n[i]==="";return T}throw new Error("wtf?")};function Wk(n){return n.replace(/\\(.)/g,"$1")}function Hk(n){return n.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")}});var Sl=F(er=>{"use strict";Object.defineProperty(er,"__esModule",{value:!0});er.DiagnosticFeature=er.DiagnosticPullMode=er.vsdiag=void 0;var Uk=Oa(),we=require("vscode"),it=ce(),Kk=et(),Tl=be();function La(n,e){return n[e]===void 0&&(n[e]={}),n[e]}var Wn;(function(n){let e;(function(t){t.full="full",t.unChanged="unChanged"})(e=n.DocumentDiagnosticReportKind||(n.DocumentDiagnosticReportKind={}))})(Wn=er.vsdiag||(er.vsdiag={}));var Rl;(function(n){n.onType="onType",n.onSave="onSave"})(Rl=er.DiagnosticPullMode||(er.DiagnosticPullMode={}));var Nt;(function(n){n.active="open",n.reschedule="reschedule",n.outDated="drop"})(Nt||(Nt={}));var Cv=class{constructor(){this.open=new Set;let e=()=>{this.open.clear();for(let t of we.window.tabGroups.all)for(let r of t.tabs){let i=r.input;i instanceof we.TabInputText?this.open.add(i.uri.toString()):i instanceof we.TabInputTextDiff&&this.open.add(i.modified.toString())}};e(),we.window.tabGroups.onDidChangeTabGroups!==void 0?this.disposable=we.window.tabGroups.onDidChangeTabGroups(e):this.disposable={dispose:()=>{}}}dispose(){this.disposable.dispose()}isActive(e){var t,r;return e instanceof we.Uri?((t=we.window.activeTextEditor)==null?void 0:t.document.uri)===e:((r=we.window.activeTextEditor)==null?void 0:r.document)===e}isVisible(e){let t=e instanceof we.Uri?e:e.uri;return this.open.has(t.toString())}getTabResources(){let e=[];for(let t of we.window.tabGroups.all)for(let r of t.tabs){let i=r.input;i instanceof we.TabInputText?e.push(i.uri):i instanceof we.TabInputTextDiff&&e.push(i.modified)}return e}},Gt;(function(n){n[n.document=1]="document",n[n.workspace=2]="workspace"})(Gt||(Gt={}));var bv=class{constructor(){this.documentPullStates=new Map,this.workspacePullStates=new Map}track(e,t,r){let i=e===Gt.document?this.documentPullStates:this.workspacePullStates,[s,o,a]=t instanceof we.Uri?[t.toString(),t,r]:[t.uri.toString(),t.uri,t.version],c=i.get(s);return c===void 0&&(c={document:o,pulledVersion:a,resultId:void 0},i.set(s,c)),c}update(e,t,r,i){let s=e===Gt.document?this.documentPullStates:this.workspacePullStates,[o,a,c,u]=t instanceof we.Uri?[t.toString(),t,r,i]:[t.uri.toString(),t.uri,t.version,r],l=s.get(o);l===void 0?(l={document:a,pulledVersion:c,resultId:u},s.set(o,l)):(l.pulledVersion=c,l.resultId=u)}unTrack(e,t){let r=t instanceof we.Uri?t.toString():t.uri.toString();(e===Gt.document?this.documentPullStates:this.workspacePullStates).delete(r)}tracks(e,t){let r=t instanceof we.Uri?t.toString():t.uri.toString();return(e===Gt.document?this.documentPullStates:this.workspacePullStates).has(r)}getResultId(e,t){var s;let r=t instanceof we.Uri?t.toString():t.uri.toString();return(s=(e===Gt.document?this.documentPullStates:this.workspacePullStates).get(r))==null?void 0:s.resultId}getAllResultIds(){let e=[];for(let[t,r]of this.workspacePullStates)this.documentPullStates.has(t)&&(r=this.documentPullStates.get(t)),r.resultId!==void 0&&e.push({uri:t,value:r.resultId});return e}},Dv=class{constructor(e,t,r){this.client=e,this.tabs=t,this.options=r,this.isDisposed=!1,this.onDidChangeDiagnosticsEmitter=new we.EventEmitter,this.provider=this.createProvider(),this.diagnostics=we.languages.createDiagnosticCollection(r.identifier),this.openRequests=new Map,this.documentStates=new bv,this.workspaceErrorCounter=0}knows(e,t){return this.documentStates.tracks(e,t)}pull(e,t){if(this.isDisposed)return;let r=e instanceof we.Uri?e:e.uri;this.pullAsync(e).then(()=>{t&&t()},i=>{this.client.error(`Document pull failed for text document ${r.toString()}`,i,!1)})}async pullAsync(e,t){if(this.isDisposed)return;let r=e instanceof we.Uri,i=r?e:e.uri,s=i.toString();t=r?t:e.version;let o=this.openRequests.get(s),a=r?this.documentStates.track(Gt.document,e,t):this.documentStates.track(Gt.document,e);if(o===void 0){let c=new we.CancellationTokenSource;this.openRequests.set(s,{state:Nt.active,document:e,version:t,tokenSource:c});let u,l;try{u=await this.provider.provideDiagnostics(e,a.resultId,c.token)??{kind:Wn.DocumentDiagnosticReportKind.full,items:[]}}catch(h){if(h instanceof Tl.LSPCancellationError&&it.DiagnosticServerCancellationData.is(h.data)&&h.data.retriggerRequest===!1&&(l={state:Nt.outDated,document:e}),l===void 0&&h instanceof we.CancellationError)l={state:Nt.reschedule,document:e};else throw h}if(l=l??this.openRequests.get(s),l===void 0){this.client.error(`Lost request state in diagnostic pull model. Clearing diagnostics for ${s}`),this.diagnostics.delete(i);return}if(this.openRequests.delete(s),!this.tabs.isVisible(e)){this.documentStates.unTrack(Gt.document,e);return}if(l.state===Nt.outDated)return;u!==void 0&&(u.kind===Wn.DocumentDiagnosticReportKind.full&&this.diagnostics.set(i,u.items),a.pulledVersion=t,a.resultId=u.resultId),l.state===Nt.reschedule&&this.pull(e)}else o.state===Nt.active?(o.tokenSource.cancel(),this.openRequests.set(s,{state:Nt.reschedule,document:o.document})):o.state===Nt.outDated&&this.openRequests.set(s,{state:Nt.reschedule,document:o.document})}cleanupPull(e){let t=e instanceof we.Uri?e:e.uri,r=t.toString(),i=this.openRequests.get(r);this.options.workspaceDiagnostics||this.options.interFileDependencies?i!==void 0?this.openRequests.set(r,{state:Nt.reschedule,document:e}):this.pull(e):(i!==void 0&&(i.state===Nt.active&&i.tokenSource.cancel(),this.openRequests.set(r,{state:Nt.outDated,document:e})),this.diagnostics.delete(t))}pullWorkspace(){this.isDisposed||this.pullWorkspaceAsync().then(()=>{this.workspaceTimeout=(0,it.RAL)().timer.setTimeout(()=>{this.pullWorkspace()},2e3)},e=>{!(e instanceof Tl.LSPCancellationError)&&!it.DiagnosticServerCancellationData.is(e.data)&&(this.client.error("Workspace diagnostic pull failed.",e,!1),this.workspaceErrorCounter++),this.workspaceErrorCounter<=5&&(this.workspaceTimeout=(0,it.RAL)().timer.setTimeout(()=>{this.pullWorkspace()},2e3))})}async pullWorkspaceAsync(){if(!this.provider.provideWorkspaceDiagnostics||this.isDisposed)return;this.workspaceCancellation!==void 0&&(this.workspaceCancellation.cancel(),this.workspaceCancellation=void 0),this.workspaceCancellation=new we.CancellationTokenSource;let e=this.documentStates.getAllResultIds().map(t=>({uri:this.client.protocol2CodeConverter.asUri(t.uri),value:t.value}));await this.provider.provideWorkspaceDiagnostics(e,this.workspaceCancellation.token,t=>{if(!(!t||this.isDisposed))for(let r of t.items)r.kind===Wn.DocumentDiagnosticReportKind.full&&(this.documentStates.tracks(Gt.document,r.uri)||this.diagnostics.set(r.uri,r.items)),this.documentStates.update(Gt.workspace,r.uri,r.version??void 0,r.resultId)})}createProvider(){let e={onDidChangeDiagnostics:this.onDidChangeDiagnosticsEmitter.event,provideDiagnostics:(t,r,i)=>{let s=(a,c,u)=>{let l={identifier:this.options.identifier,textDocument:{uri:this.client.code2ProtocolConverter.asUri(a instanceof we.Uri?a:a.uri)},previousResultId:c};return this.isDisposed===!0||!this.client.isRunning()?{kind:Wn.DocumentDiagnosticReportKind.full,items:[]}:this.client.sendRequest(it.DocumentDiagnosticRequest.type,l,u).then(async h=>h==null||this.isDisposed||u.isCancellationRequested?{kind:Wn.DocumentDiagnosticReportKind.full,items:[]}:h.kind===it.DocumentDiagnosticReportKind.Full?{kind:Wn.DocumentDiagnosticReportKind.full,resultId:h.resultId,items:await this.client.protocol2CodeConverter.asDiagnostics(h.items,u)}:{kind:Wn.DocumentDiagnosticReportKind.unChanged,resultId:h.resultId},h=>this.client.handleFailedRequest(it.DocumentDiagnosticRequest.type,u,h,{kind:Wn.DocumentDiagnosticReportKind.full,items:[]}))},o=this.client.middleware;return o.provideDiagnostics?o.provideDiagnostics(t,r,i,s):s(t,r,i)}};return this.options.workspaceDiagnostics&&(e.provideWorkspaceDiagnostics=(t,r,i)=>{let s=async u=>u.kind===it.DocumentDiagnosticReportKind.Full?{kind:Wn.DocumentDiagnosticReportKind.full,uri:this.client.protocol2CodeConverter.asUri(u.uri),resultId:u.resultId,version:u.version,items:await this.client.protocol2CodeConverter.asDiagnostics(u.items,r)}:{kind:Wn.DocumentDiagnosticReportKind.unChanged,uri:this.client.protocol2CodeConverter.asUri(u.uri),resultId:u.resultId,version:u.version},o=u=>{let l=[];for(let h of u)l.push({uri:this.client.code2ProtocolConverter.asUri(h.uri),value:h.value});return l},a=(u,l)=>{let h=(0,Kk.generateUuid)(),p=this.client.onProgress(it.WorkspaceDiagnosticRequest.partialResult,h,async T=>{if(T==null){i(null);return}let y={items:[]};for(let R of T.items)try{y.items.push(await s(R))}catch(S){this.client.error("Converting workspace diagnostics failed.",S)}i(y)}),C={identifier:this.options.identifier,previousResultIds:o(u),partialResultToken:h};return this.isDisposed===!0||!this.client.isRunning()?{items:[]}:this.client.sendRequest(it.WorkspaceDiagnosticRequest.type,C,l).then(async T=>{if(l.isCancellationRequested)return{items:[]};let y={items:[]};for(let R of T.items)y.items.push(await s(R));return p.dispose(),i(y),{items:[]}},T=>(p.dispose(),this.client.handleFailedRequest(it.DocumentDiagnosticRequest.type,l,T,{items:[]})))},c=this.client.middleware;return c.provideWorkspaceDiagnostics?c.provideWorkspaceDiagnostics(t,r,i,a):a(t,r,i)}),e}dispose(){var e,t;this.isDisposed=!0,(e=this.workspaceCancellation)==null||e.cancel(),(t=this.workspaceTimeout)==null||t.dispose();for(let[r,i]of this.openRequests)i.state===Nt.active&&i.tokenSource.cancel(),this.openRequests.set(r,{state:Nt.outDated,document:i.document})}},Tv=class{constructor(e){this.diagnosticRequestor=e,this.documents=new it.LinkedMap,this.isDisposed=!1}add(e){if(this.isDisposed===!0)return;let t=e instanceof we.Uri?e.toString():e.uri.toString();this.documents.has(t)||(this.documents.set(t,e,it.Touch.Last),this.trigger())}remove(e){let t=e instanceof we.Uri?e.toString():e.uri.toString();this.documents.has(t)&&(this.documents.delete(t),this.diagnosticRequestor.pull(e)),this.documents.size===0?this.stop():e===this.endDocument&&(this.endDocument=this.documents.last)}trigger(){if(this.isDisposed!==!0){if(this.intervalHandle!==void 0){this.endDocument=this.documents.last;return}this.endDocument=this.documents.last,this.intervalHandle=(0,it.RAL)().timer.setInterval(()=>{let e=this.documents.first;if(e!==void 0){let t=e instanceof we.Uri?e.toString():e.uri.toString();this.diagnosticRequestor.pull(e),this.documents.set(t,e,it.Touch.Last),e===this.endDocument&&this.stop()}},200)}}dispose(){this.isDisposed=!0,this.stop(),this.documents.clear()}stop(){var e;(e=this.intervalHandle)==null||e.dispose(),this.intervalHandle=void 0,this.endDocument=void 0}},Rv=class{constructor(e,t,r){var T;let i=e.clientOptions.diagnosticPullOptions??{onChange:!0,onSave:!1},s=e.protocol2CodeConverter.asDocumentSelector(r.documentSelector),o=[],a=y=>{let R=r.documentSelector;if(i.match!==void 0)return i.match(R,y);for(let S of R)if(!!it.TextDocumentFilter.is(S)){if(typeof S=="string"||S.language!==void 0&&S.language!=="*"||S.scheme!==void 0&&S.scheme!=="*"&&S.scheme!==y.scheme)return!1;if(S.pattern!==void 0){let v=new Uk.Minimatch(S.pattern,{noext:!0});if(!v.makeRe()||!v.match(y.fsPath))return!1}}return!0},c=y=>y instanceof we.Uri?a(y):we.languages.match(s,y)>0&&t.isVisible(y),u=y=>{var R;return y instanceof we.Uri?((R=this.activeTextDocument)==null?void 0:R.uri.toString())===y.toString():this.activeTextDocument===y};this.diagnosticRequestor=new Dv(e,t,r),this.backgroundScheduler=new Tv(this.diagnosticRequestor);let l=y=>{!c(y)||!r.interFileDependencies||u(y)||this.backgroundScheduler.add(y)};this.activeTextDocument=(T=we.window.activeTextEditor)==null?void 0:T.document,we.window.onDidChangeActiveTextEditor(y=>{let R=this.activeTextDocument;this.activeTextDocument=y==null?void 0:y.document,R!==void 0&&l(R),this.activeTextDocument!==void 0&&this.backgroundScheduler.remove(this.activeTextDocument)});let h=e.getFeature(it.DidOpenTextDocumentNotification.method);o.push(h.onNotificationSent(y=>{let R=y.original;c(R)&&this.diagnosticRequestor.pull(R,()=>{l(R)})}));let p=new Set;for(let y of we.workspace.textDocuments)c(y)&&(this.diagnosticRequestor.pull(y,()=>{l(y)}),p.add(y.uri.toString()));if(i.onTabs===!0)for(let y of t.getTabResources())!p.has(y.toString())&&c(y)&&this.diagnosticRequestor.pull(y,()=>{l(y)});if(i.onChange===!0){let y=e.getFeature(it.DidChangeTextDocumentNotification.method);o.push(y.onNotificationSent(async R=>{let S=R.original.document;(i.filter===void 0||!i.filter(S,Rl.onType))&&this.diagnosticRequestor.knows(Gt.document,S)&&R.original.contentChanges.length>0&&this.diagnosticRequestor.pull(S,()=>{this.backgroundScheduler.trigger()})}))}if(i.onSave===!0){let y=e.getFeature(it.DidSaveTextDocumentNotification.method);o.push(y.onNotificationSent(R=>{let S=R.original;(i.filter===void 0||!i.filter(S,Rl.onSave))&&this.diagnosticRequestor.knows(Gt.document,S)&&this.diagnosticRequestor.pull(R.original,()=>{this.backgroundScheduler.trigger()})}))}let C=e.getFeature(it.DidCloseTextDocumentNotification.method);o.push(C.onNotificationSent(y=>{let R=y.original;this.diagnosticRequestor.cleanupPull(R),this.backgroundScheduler.remove(R)})),this.diagnosticRequestor.onDidChangeDiagnosticsEmitter.event(()=>{for(let y of we.workspace.textDocuments)c(y)&&this.diagnosticRequestor.pull(y)}),r.workspaceDiagnostics===!0&&r.identifier!=="da348dc5-c30a-4515-9d98-31ff3be38d14"&&this.diagnosticRequestor.pullWorkspace(),this.disposable=we.Disposable.from(...o,this.backgroundScheduler,this.diagnosticRequestor)}get onDidChangeDiagnosticsEmitter(){return this.diagnosticRequestor.onDidChangeDiagnosticsEmitter}get diagnostics(){return this.diagnosticRequestor.provider}},Sv=class extends Tl.TextDocumentLanguageFeature{constructor(e){super(e,it.DocumentDiagnosticRequest.type)}fillClientCapabilities(e){let t=La(La(e,"textDocument"),"diagnostic");t.dynamicRegistration=!0,t.relatedDocumentSupport=!1,La(La(e,"workspace"),"diagnostics").refreshSupport=!0}initialize(e,t){this._client.onRequest(it.DiagnosticRefreshRequest.type,async()=>{for(let o of this.getAllProviders())o.onDidChangeDiagnosticsEmitter.fire()});let[i,s]=this.getRegistration(t,e.diagnosticProvider);!i||!s||this.register({id:i,registerOptions:s})}dispose(){this.tabs!==void 0&&(this.tabs.dispose(),this.tabs=void 0),super.dispose()}registerLanguageProvider(e){this.tabs===void 0&&(this.tabs=new Cv);let t=new Rv(this._client,this.tabs,e);return[t.disposable,t]}};er.DiagnosticFeature=Sv});var kv=F($a=>{"use strict";Object.defineProperty($a,"__esModule",{value:!0});$a.NotebookDocumentSyncFeature=void 0;var Ot=require("vscode"),zk=Oa(),mr=ce(),Vk=et(),_v=vn();function Pv(n,e){return n[e]===void 0&&(n[e]={}),n[e]}var Bi;(function(n){let e;(function(t){function r(p,C){return{version:p.version,uri:C.asUri(p.uri)}}t.asVersionedNotebookDocumentIdentifier=r;function i(p,C,T){let y=mr.NotebookDocument.create(T.asUri(p.uri),p.notebookType,p.version,s(C,T));return Object.keys(p.metadata).length>0&&(y.metadata=o(p.metadata)),y}t.asNotebookDocument=i;function s(p,C){return p.map(T=>a(T,C))}t.asNotebookCells=s;function o(p){return u(new Set,p)}t.asMetadata=o;function a(p,C){let T=mr.NotebookCell.create(c(p.kind),C.asUri(p.document.uri));return Object.keys(p.metadata).length>0&&(T.metadata=o(p.metadata)),p.executionSummary!==void 0&&_v.number(p.executionSummary.executionOrder)&&_v.boolean(p.executionSummary.success)&&(T.executionSummary={executionOrder:p.executionSummary.executionOrder,success:p.executionSummary.success}),T}t.asNotebookCell=a;function c(p){switch(p){case Ot.NotebookCellKind.Markup:return mr.NotebookCellKind.Markup;case Ot.NotebookCellKind.Code:return mr.NotebookCellKind.Code}}function u(p,C){if(p.has(C))throw new Error("Can't deep copy cyclic structures.");if(Array.isArray(C)){let T=[];for(let y of C)if(y!==null&&typeof y=="object"||Array.isArray(y))T.push(u(p,y));else{if(y instanceof RegExp)throw new Error("Can't transfer regular expressions to the server");T.push(y)}return T}else{let T=Object.keys(C),y=Object.create(null);for(let R of T){let S=C[R];if(S!==null&&typeof S=="object"||Array.isArray(S))y[R]=u(p,S);else{if(S instanceof RegExp)throw new Error("Can't transfer regular expressions to the server");y[R]=S}}return y}}function l(p,C){let T=C.asChangeTextDocumentParams(p);return{document:T.textDocument,changes:T.contentChanges}}t.asTextContentChange=l;function h(p,C){let T=Object.create(null);if(p.metadata&&(T.metadata=n.c2p.asMetadata(p.metadata)),p.cells!==void 0){let y=Object.create(null),R=p.cells;R.structure&&(y.structure={array:{start:R.structure.array.start,deleteCount:R.structure.array.deleteCount,cells:R.structure.array.cells!==void 0?R.structure.array.cells.map(S=>n.c2p.asNotebookCell(S,C)):void 0},didOpen:R.structure.didOpen!==void 0?R.structure.didOpen.map(S=>C.asOpenTextDocumentParams(S.document).textDocument):void 0,didClose:R.structure.didClose!==void 0?R.structure.didClose.map(S=>C.asCloseTextDocumentParams(S.document).textDocument):void 0}),R.data!==void 0&&(y.data=R.data.map(S=>n.c2p.asNotebookCell(S,C))),R.textContent!==void 0&&(y.textContent=R.textContent.map(S=>n.c2p.asTextContentChange(S,C))),Object.keys(y).length>0&&(T.cells=y)}return T}t.asNotebookDocumentChangeEvent=h})(e=n.c2p||(n.c2p={}))})(Bi||(Bi={}));var _l;(function(n){function e(a,c,u){let l=a.length,h=c.length,p=0;for(;p<h&&p<l&&t(a[p],c[p],u);)p++;if(p<h&&p<l){let C=l-1,T=h-1;for(;C>=0&&T>=0&&t(a[C],c[T],u);)C--,T--;let y=C+1-p,R=p===T+1?void 0:c.slice(p,T+1);return R!==void 0?{start:p,deleteCount:y,cells:R}:{start:p,deleteCount:y}}else return p<h?{start:p,deleteCount:0,cells:c.slice(p)}:p<l?{start:p,deleteCount:l-p}:void 0}n.computeDiff=e;function t(a,c,u=!0){return a.kind!==c.kind||a.document.uri.toString()!==c.document.uri.toString()||a.document.languageId!==c.document.languageId||!r(a.executionSummary,c.executionSummary)?!1:!u||u&&s(a.metadata,c.metadata)}function r(a,c){return a===c?!0:a===void 0||c===void 0?!1:a.executionOrder===c.executionOrder&&a.success===c.success&&i(a.timing,c.timing)}function i(a,c){return a===c?!0:a===void 0||c===void 0?!1:a.startTime===c.startTime&&a.endTime===c.endTime}function s(a,c){if(a===c)return!0;if(a==null||c===null||c===void 0||typeof a!=typeof c||typeof a!="object")return!1;let u=Array.isArray(a),l=Array.isArray(c);if(u!==l)return!1;if(u&&l){if(a.length!==c.length)return!1;for(let h=0;h<a.length;h++)if(!s(a[h],c[h]))return!1}if(o(a)&&o(c)){let h=Object.keys(a),p=Object.keys(c);if(h.length!==p.length||(h.sort(),p.sort(),!s(h,p)))return!1;for(let C=0;C<h.length;C++){let T=h[C];if(!s(a[T],c[T]))return!1}return!0}return!1}function o(a){return a!==null&&typeof a=="object"}n.isObjectLiteral=o})(_l||(_l={}));var Pl;(function(n){function e(t,r){if(typeof t=="string")return t==="*"||r.notebookType===t;if(t.notebookType!==void 0&&t.notebookType!=="*"&&r.notebookType!==t.notebookType)return!1;let i=r.uri;if(t.scheme!==void 0&&t.scheme!=="*"&&i.scheme!==t.scheme)return!1;if(t.pattern!==void 0){let s=new zk.Minimatch(t.pattern,{noext:!0});if(!s.makeRe()||!s.match(i.fsPath))return!1}return!0}n.matchNotebook=e})(Pl||(Pl={}));var Aa;(function(n){function e(r){var o,a,c;let i=r.notebookSelector,s=[];for(let u of i){let l=(typeof u.notebook=="string"?u.notebook:(o=u.notebook)==null?void 0:o.notebookType)??"*",h=typeof u.notebook=="string"||(a=u.notebook)==null?void 0:a.scheme,p=typeof u.notebook=="string"||(c=u.notebook)==null?void 0:c.pattern;if(u.cells!==void 0)for(let C of u.cells)s.push(t(l,h,p,C.language));else s.push(t(l,h,p,void 0))}return s}n.asDocumentSelector=e;function t(r,i,s,o){return i===void 0&&s===void 0?{notebook:r,language:o}:{notebook:{notebookType:r,scheme:i,pattern:s},language:o}}})(Aa||(Aa={}));var Ma;(function(n){function e(t){return{cells:t,uris:new Set(t.map(r=>r.document.uri.toString()))}}n.create=e})(Ma||(Ma={}));var so=class{constructor(e,t){this.client=e,this.options=t,this.notebookSyncInfo=new Map,this.notebookDidOpen=new Set,this.disposables=[],this.selector=e.protocol2CodeConverter.asDocumentSelector(Aa.asDocumentSelector(t)),Ot.workspace.onDidOpenNotebookDocument(r=>{this.notebookDidOpen.add(r.uri.toString()),this.didOpen(r)},void 0,this.disposables);for(let r of Ot.workspace.notebookDocuments)this.notebookDidOpen.add(r.uri.toString()),this.didOpen(r);Ot.workspace.onDidChangeNotebookDocument(r=>this.didChangeNotebookDocument(r),void 0,this.disposables),this.options.save===!0&&Ot.workspace.onDidSaveNotebookDocument(r=>this.didSave(r),void 0,this.disposables),Ot.workspace.onDidCloseNotebookDocument(r=>{this.didClose(r),this.notebookDidOpen.delete(r.uri.toString())},void 0,this.disposables)}getState(){for(let e of Ot.workspace.notebookDocuments)if(this.getMatchingCells(e)!==void 0)return{kind:"document",id:"$internal",registrations:!0,matches:!0};return{kind:"document",id:"$internal",registrations:!0,matches:!1}}get mode(){return"notebook"}handles(e){return Ot.languages.match(this.selector,e)>0}didOpenNotebookCellTextDocument(e,t){if(Ot.languages.match(this.selector,t.document)===0||!this.notebookDidOpen.has(e.uri.toString()))return;let r=this.notebookSyncInfo.get(e.uri.toString()),i=this.cellMatches(e,t);if(r!==void 0){let s=r.uris.has(t.document.uri.toString());if(i&&s||!i&&!s)return;if(i){let o=this.getMatchingCells(e);if(o!==void 0){let a=this.asNotebookDocumentChangeEvent(e,void 0,r,o);a!==void 0&&this.doSendChange(a,o).catch(()=>{})}}}else i&&this.doSendOpen(e,[t]).catch(()=>{})}didChangeNotebookCellTextDocument(e,t){Ot.languages.match(this.selector,t.document)!==0&&this.doSendChange({notebook:e,cells:{textContent:[t]}},void 0).catch(()=>{})}didCloseNotebookCellTextDocument(e,t){let r=this.notebookSyncInfo.get(e.uri.toString());if(r===void 0)return;let i=t.document.uri,s=r.cells.findIndex(o=>o.document.uri.toString()===i.toString());if(s!==-1)if(s===0&&r.cells.length===1)this.doSendClose(e,r.cells).catch(()=>{});else{let o=r.cells.slice(),a=o.splice(s,1);this.doSendChange({notebook:e,cells:{structure:{array:{start:s,deleteCount:1},didClose:a}}},o).catch(()=>{})}}dispose(){for(let e of this.disposables)e.dispose()}didOpen(e,t=this.getMatchingCells(e),r=this.notebookSyncInfo.get(e.uri.toString())){if(r!==void 0)if(t!==void 0){let i=this.asNotebookDocumentChangeEvent(e,void 0,r,t);i!==void 0&&this.doSendChange(i,t).catch(()=>{})}else this.doSendClose(e,[]).catch(()=>{});else{if(t===void 0)return;this.doSendOpen(e,t).catch(()=>{})}}didChangeNotebookDocument(e){let t=e.notebook,r=this.notebookSyncInfo.get(t.uri.toString());if(r===void 0){if(e.contentChanges.length===0)return;let i=this.getMatchingCells(t);if(i===void 0)return;this.didOpen(t,i,r)}else{let i=this.getMatchingCells(t);if(i===void 0){this.didClose(t,r);return}let s=this.asNotebookDocumentChangeEvent(e.notebook,e,r,i);s!==void 0&&this.doSendChange(s,i).catch(()=>{})}}didSave(e){this.notebookSyncInfo.get(e.uri.toString())!==void 0&&this.doSendSave(e).catch(()=>{})}didClose(e,t=this.notebookSyncInfo.get(e.uri.toString())){if(t===void 0)return;let r=e.getCells().filter(i=>t.uris.has(i.document.uri.toString()));this.doSendClose(e,r).catch(()=>{})}async sendDidOpenNotebookDocument(e){let t=this.getMatchingCells(e);if(t!==void 0)return this.doSendOpen(e,t)}async doSendOpen(e,t){var s;let r=async(o,a)=>{let c=Bi.c2p.asNotebookDocument(o,a,this.client.code2ProtocolConverter),u=a.map(l=>this.client.code2ProtocolConverter.asTextDocumentItem(l.document));try{await this.client.sendNotification(mr.DidOpenNotebookDocumentNotification.type,{notebookDocument:c,cellTextDocuments:u})}catch(l){throw this.client.error("Sending DidOpenNotebookDocumentNotification failed",l),l}},i=(s=this.client.middleware)==null?void 0:s.notebooks;return this.notebookSyncInfo.set(e.uri.toString(),Ma.create(t)),(i==null?void 0:i.didOpen)!==void 0?i.didOpen(e,t,r):r(e,t)}async sendDidChangeNotebookDocument(e){return this.doSendChange(e,void 0)}async doSendChange(e,t=this.getMatchingCells(e.notebook)){var s,o;let r=async a=>{try{await this.client.sendNotification(mr.DidChangeNotebookDocumentNotification.type,{notebookDocument:Bi.c2p.asVersionedNotebookDocumentIdentifier(a.notebook,this.client.code2ProtocolConverter),change:Bi.c2p.asNotebookDocumentChangeEvent(a,this.client.code2ProtocolConverter)})}catch(c){throw this.client.error("Sending DidChangeNotebookDocumentNotification failed",c),c}},i=(s=this.client.middleware)==null?void 0:s.notebooks;return((o=e.cells)==null?void 0:o.structure)!==void 0&&this.notebookSyncInfo.set(e.notebook.uri.toString(),Ma.create(t??[])),(i==null?void 0:i.didChange)!==void 0?i==null?void 0:i.didChange(e,r):r(e)}async sendDidSaveNotebookDocument(e){return this.doSendSave(e)}async doSendSave(e){var i;let t=async s=>{try{await this.client.sendNotification(mr.DidSaveNotebookDocumentNotification.type,{notebookDocument:{uri:this.client.code2ProtocolConverter.asUri(s.uri)}})}catch(o){throw this.client.error("Sending DidSaveNotebookDocumentNotification failed",o),o}},r=(i=this.client.middleware)==null?void 0:i.notebooks;return(r==null?void 0:r.didSave)!==void 0?r.didSave(e,t):t(e)}async sendDidCloseNotebookDocument(e){return this.doSendClose(e,this.getMatchingCells(e)??[])}async doSendClose(e,t){var s;let r=async(o,a)=>{try{await this.client.sendNotification(mr.DidCloseNotebookDocumentNotification.type,{notebookDocument:{uri:this.client.code2ProtocolConverter.asUri(o.uri)},cellTextDocuments:a.map(c=>this.client.code2ProtocolConverter.asTextDocumentIdentifier(c.document))})}catch(c){throw this.client.error("Sending DidCloseNotebookDocumentNotification failed",c),c}},i=(s=this.client.middleware)==null?void 0:s.notebooks;return this.notebookSyncInfo.delete(e.uri.toString()),(i==null?void 0:i.didClose)!==void 0?i.didClose(e,t,r):r(e,t)}asNotebookDocumentChangeEvent(e,t,r,i){if(t!==void 0&&t.notebook!==e)throw new Error("Notebook must be identical");let s={notebook:e};(t==null?void 0:t.metadata)!==void 0&&(s.metadata=Bi.c2p.asMetadata(t.metadata));let o;if((t==null?void 0:t.cellChanges)!==void 0&&t.cellChanges.length>0){let a=[];o=new Set(i.map(c=>c.document.uri.toString()));for(let c of t.cellChanges)o.has(c.cell.document.uri.toString())&&(c.executionSummary!==void 0||c.metadata!==void 0)&&a.push(c.cell);a.length>0&&(s.cells=s.cells??{},s.cells.data=a)}if(((t==null?void 0:t.contentChanges)!==void 0&&t.contentChanges.length>0||t===void 0)&&r!==void 0&&i!==void 0){let a=r.cells,c=i,u=_l.computeDiff(a,c,!1),l,h;if(u!==void 0){l=u.cells===void 0?new Map:new Map(u.cells.map(T=>[T.document.uri.toString(),T])),h=u.deleteCount===0?new Map:new Map(a.slice(u.start,u.start+u.deleteCount).map(T=>[T.document.uri.toString(),T]));for(let T of Array.from(h.keys()))l.has(T)&&(h.delete(T),l.delete(T));s.cells=s.cells??{};let p=[],C=[];if(l.size>0||h.size>0){for(let T of l.values())p.push(T);for(let T of h.values())C.push(T)}s.cells.structure={array:u,didOpen:p,didClose:C}}}return Object.keys(s).length>1?s:void 0}getMatchingCells(e,t=e.getCells()){if(this.options.notebookSelector!==void 0){for(let r of this.options.notebookSelector)if(r.notebook===void 0){if(r.cells===void 0)return;let i=this.filterCells(e,t,r.cells);return i.length===0?void 0:i}else if(Pl.matchNotebook(r.notebook,e))return r.cells===void 0?t:this.filterCells(e,t,r.cells)}}cellMatches(e,t){let r=this.getMatchingCells(e,[t]);return r!==void 0&&r[0]===t}filterCells(e,t,r){var s;let i=t.filter(o=>{let a=o.document.languageId;return r.some(c=>c.language==="*"||a===c.language)});return typeof((s=this.client.clientOptions.notebookDocumentOptions)==null?void 0:s.filterCells)=="function"?this.client.clientOptions.notebookDocumentOptions.filterCells(e,t):i}},$r=class{constructor(e){this.client=e,this.registrations=new Map,this.registrationType=mr.NotebookDocumentSyncRegistrationType.type,Ot.workspace.onDidOpenTextDocument(t=>{if(t.uri.scheme!==$r.CellScheme)return;let[r,i]=this.findNotebookDocumentAndCell(t);if(!(r===void 0||i===void 0))for(let s of this.registrations.values())s instanceof so&&s.didOpenNotebookCellTextDocument(r,i)}),Ot.workspace.onDidChangeTextDocument(t=>{if(t.contentChanges.length===0)return;let r=t.document;if(r.uri.scheme!==$r.CellScheme)return;let[i]=this.findNotebookDocumentAndCell(r);if(i!==void 0)for(let s of this.registrations.values())s instanceof so&&s.didChangeNotebookCellTextDocument(i,t)}),Ot.workspace.onDidCloseTextDocument(t=>{if(t.uri.scheme!==$r.CellScheme)return;let[r,i]=this.findNotebookDocumentAndCell(t);if(!(r===void 0||i===void 0))for(let s of this.registrations.values())s instanceof so&&s.didCloseNotebookCellTextDocument(r,i)})}getState(){if(this.registrations.size===0)return{kind:"document",id:this.registrationType.method,registrations:!1,matches:!1};for(let e of this.registrations.values()){let t=e.getState();if(t.kind==="document"&&t.registrations===!0&&t.matches===!0)return{kind:"document",id:this.registrationType.method,registrations:!0,matches:!0}}return{kind:"document",id:this.registrationType.method,registrations:!0,matches:!1}}fillClientCapabilities(e){let t=Pv(Pv(e,"notebookDocument"),"synchronization");t.dynamicRegistration=!0,t.executionSummarySupport=!0}preInitialize(e){let t=e.notebookDocumentSync;t!==void 0&&(this.dedicatedChannel=this.client.protocol2CodeConverter.asDocumentSelector(Aa.asDocumentSelector(t)))}initialize(e){let t=e.notebookDocumentSync;if(t===void 0)return;let r=t.id??Vk.generateUuid();this.register({id:r,registerOptions:t})}register(e){let t=new so(this.client,e.registerOptions);this.registrations.set(e.id,t)}unregister(e){let t=this.registrations.get(e);t&&t.dispose()}dispose(){for(let e of this.registrations.values())e.dispose();this.registrations.clear()}handles(e){if(e.uri.scheme!==$r.CellScheme)return!1;if(this.dedicatedChannel!==void 0&&Ot.languages.match(this.dedicatedChannel,e)>0)return!0;for(let t of this.registrations.values())if(t.handles(e))return!0;return!1}getProvider(e){for(let t of this.registrations.values())if(t.handles(e.document))return t}findNotebookDocumentAndCell(e){let t=e.uri.toString();for(let r of Ot.workspace.notebookDocuments)for(let i of r.getCells())if(i.document.uri.toString()===t)return[r,i];return[void 0,void 0]}};$a.NotebookDocumentSyncFeature=$r;$r.CellScheme="vscode-notebook-cell"});var kl=F(jr=>{"use strict";Object.defineProperty(jr,"__esModule",{value:!0});jr.SyncConfigurationFeature=jr.toJSONObject=jr.ConfigurationFeature=void 0;var Gi=require("vscode"),oo=ce(),Xk=vn(),Bk=et(),Ev=be(),xv=class{constructor(e){this._client=e}getState(){return{kind:"static"}}fillClientCapabilities(e){e.workspace=e.workspace||{},e.workspace.configuration=!0}initialize(){let e=this._client;e.onRequest(oo.ConfigurationRequest.type,(t,r)=>{let i=o=>{let a=[];for(let c of o.items){let u=c.scopeUri!==void 0&&c.scopeUri!==null?this._client.protocol2CodeConverter.asUri(c.scopeUri):void 0;a.push(this.getConfiguration(u,c.section!==null?c.section:void 0))}return a},s=e.middleware.workspace;return s&&s.configuration?s.configuration(t,r,i):i(t,r)})}getConfiguration(e,t){let r=null;if(t){let i=t.lastIndexOf(".");if(i===-1)r=hi(Gi.workspace.getConfiguration(void 0,e).get(t));else{let s=Gi.workspace.getConfiguration(t.substr(0,i),e);s&&(r=hi(s.get(t.substr(i+1))))}}else{let i=Gi.workspace.getConfiguration(void 0,e);r={};for(let s of Object.keys(i))i.has(s)&&(r[s]=hi(i.get(s)))}return r===void 0&&(r=null),r}dispose(){}};jr.ConfigurationFeature=xv;function hi(n){if(n){if(Array.isArray(n))return n.map(hi);if(typeof n=="object"){let e=Object.create(null);for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=hi(n[t]));return e}}return n}jr.toJSONObject=hi;var qv=class{constructor(e){this._client=e,this._listeners=new Map}getState(){return{kind:"workspace",id:this.registrationType.method,registrations:this._listeners.size>0}}get registrationType(){return oo.DidChangeConfigurationNotification.type}fillClientCapabilities(e){(0,Ev.ensure)((0,Ev.ensure)(e,"workspace"),"didChangeConfiguration").dynamicRegistration=!0}initialize(){var t;let e=(t=this._client.clientOptions.synchronize)==null?void 0:t.configurationSection;e!==void 0&&this.register({id:Bk.generateUuid(),registerOptions:{section:e}})}register(e){let t=Gi.workspace.onDidChangeConfiguration(r=>{this.onDidChangeConfiguration(e.registerOptions.section,r)});this._listeners.set(e.id,t),e.registerOptions.section!==void 0&&this.onDidChangeConfiguration(e.registerOptions.section,void 0)}unregister(e){let t=this._listeners.get(e);t&&(this._listeners.delete(e),t.dispose())}dispose(){for(let e of this._listeners.values())e.dispose();this._listeners.clear()}onDidChangeConfiguration(e,t){var o;let r;if(Xk.string(e)?r=[e]:r=e,r!==void 0&&t!==void 0&&!r.some(c=>t.affectsConfiguration(c)))return;let i=async a=>a===void 0?this._client.sendNotification(oo.DidChangeConfigurationNotification.type,{settings:null}):this._client.sendNotification(oo.DidChangeConfigurationNotification.type,{settings:this.extractSettingsInformation(a)}),s=(o=this._client.middleware.workspace)==null?void 0:o.didChangeConfiguration;(s?s(r,i):i(r)).catch(a=>{this._client.error(`Sending notification ${oo.DidChangeConfigurationNotification.type.method} failed`,a)})}extractSettingsInformation(e){function t(s,o){let a=s;for(let c=0;c<o.length-1;c++){let u=a[o[c]];u||(u=Object.create(null),a[o[c]]=u),a=u}return a}let r=this._client.clientOptions.workspaceFolder?this._client.clientOptions.workspaceFolder.uri:void 0,i=Object.create(null);for(let s=0;s<e.length;s++){let o=e[s],a=o.indexOf("."),c=null;if(a>=0?c=Gi.workspace.getConfiguration(o.substr(0,a),r).get(o.substr(a+1)):c=Gi.workspace.getConfiguration(void 0,r).get(o),c){let u=e[s].split(".");t(i,u)[u[u.length-1]]=hi(c)}}return i}};jr.SyncConfigurationFeature=qv});var Mv=F(Qt=>{"use strict";Object.defineProperty(Qt,"__esModule",{value:!0});Qt.DidSaveTextDocumentFeature=Qt.WillSaveWaitUntilFeature=Qt.WillSaveFeature=Qt.DidChangeTextDocumentFeature=Qt.DidCloseTextDocumentFeature=Qt.DidOpenTextDocumentFeature=void 0;var Tn=require("vscode"),wt=ce(),tt=be(),Gk=ro(),Qi=et(),Iv=class extends tt.TextDocumentEventFeature{constructor(e,t){super(e,Tn.workspace.onDidOpenTextDocument,wt.DidOpenTextDocumentNotification.type,()=>e.middleware.didOpen,r=>e.code2ProtocolConverter.asOpenTextDocumentParams(r),r=>r,tt.TextDocumentEventFeature.textDocumentFilter);this._syncedDocuments=t}get openDocuments(){return this._syncedDocuments.values()}fillClientCapabilities(e){(0,tt.ensure)((0,tt.ensure)(e,"textDocument"),"synchronization").dynamicRegistration=!0}initialize(e,t){let r=e.resolvedTextDocumentSync;t&&r&&r.openClose&&this.register({id:Qi.generateUuid(),registerOptions:{documentSelector:t}})}get registrationType(){return wt.DidOpenTextDocumentNotification.type}register(e){if(super.register(e),!e.registerOptions.documentSelector)return;let t=this._client.protocol2CodeConverter.asDocumentSelector(e.registerOptions.documentSelector);Tn.workspace.textDocuments.forEach(r=>{let i=r.uri.toString();if(!this._syncedDocuments.has(i)&&Tn.languages.match(t,r)>0&&!this._client.hasDedicatedTextSynchronizationFeature(r)){let s=this._client.middleware,o=a=>this._client.sendNotification(this._type,this._createParams(a));(s.didOpen?s.didOpen(r,o):o(r)).catch(a=>{this._client.error(`Sending document notification ${this._type.method} failed`,a)}),this._syncedDocuments.set(i,r)}})}notificationSent(e,t,r){super.notificationSent(e,t,r),this._syncedDocuments.set(e.uri.toString(),e)}};Qt.DidOpenTextDocumentFeature=Iv;var Fv=class extends tt.TextDocumentEventFeature{constructor(e,t){super(e,Tn.workspace.onDidCloseTextDocument,wt.DidCloseTextDocumentNotification.type,()=>e.middleware.didClose,r=>e.code2ProtocolConverter.asCloseTextDocumentParams(r),r=>r,tt.TextDocumentEventFeature.textDocumentFilter);this._syncedDocuments=t}get registrationType(){return wt.DidCloseTextDocumentNotification.type}fillClientCapabilities(e){(0,tt.ensure)((0,tt.ensure)(e,"textDocument"),"synchronization").dynamicRegistration=!0}initialize(e,t){let r=e.resolvedTextDocumentSync;t&&r&&r.openClose&&this.register({id:Qi.generateUuid(),registerOptions:{documentSelector:t}})}notificationSent(e,t,r){super.notificationSent(e,t,r),this._syncedDocuments.delete(e.uri.toString())}unregister(e){let t=this._selectors.get(e);super.unregister(e);let r=this._selectors.values();this._syncedDocuments.forEach(i=>{if(Tn.languages.match(t,i)>0&&!this._selectorFilter(r,i)&&!this._client.hasDedicatedTextSynchronizationFeature(i)){let s=this._client.middleware,o=a=>this._client.sendNotification(this._type,this._createParams(a));this._syncedDocuments.delete(i.uri.toString()),(s.didClose?s.didClose(i,o):o(i)).catch(a=>{this._client.error(`Sending document notification ${this._type.method} failed`,a)})}})}};Qt.DidCloseTextDocumentFeature=Fv;var Nv=class extends tt.DynamicDocumentFeature{constructor(e){super(e);this._forcingDelivery=!1,this._changeData=new Map,this._onNotificationSent=new Tn.EventEmitter}get registrationType(){return wt.DidChangeTextDocumentNotification.type}fillClientCapabilities(e){(0,tt.ensure)((0,tt.ensure)(e,"textDocument"),"synchronization").dynamicRegistration=!0}initialize(e,t){let r=e.resolvedTextDocumentSync;t&&r&&r.change!==void 0&&r.change!==wt.TextDocumentSyncKind.None&&this.register({id:Qi.generateUuid(),registerOptions:Object.assign({},{documentSelector:t},{syncKind:r.change})})}register(e){!e.registerOptions.documentSelector||(this._listener||(this._listener=Tn.workspace.onDidChangeTextDocument(this.callback,this)),this._changeData.set(e.id,{syncKind:e.registerOptions.syncKind,documentSelector:this._client.protocol2CodeConverter.asDocumentSelector(e.registerOptions.documentSelector)}))}*getDocumentSelectors(){for(let e of this._changeData.values())yield e.documentSelector}async callback(e){if(e.contentChanges.length===0)return;let t=[];for(let r of this._changeData.values())if(Tn.languages.match(r.documentSelector,e.document)>0&&!this._client.hasDedicatedTextSynchronizationFeature(e.document)){let i=this._client.middleware;if(r.syncKind===wt.TextDocumentSyncKind.Incremental){let s=async o=>{let a=this._client.code2ProtocolConverter.asChangeTextDocumentParams(o);await this._client.sendNotification(wt.DidChangeTextDocumentNotification.type,a),this.notificationSent(o,wt.DidChangeTextDocumentNotification.type,a)};t.push(i.didChange?i.didChange(e,o=>s(o)):s(e))}else if(r.syncKind===wt.TextDocumentSyncKind.Full){let s=async o=>{let a=async c=>{let u=this._client.code2ProtocolConverter.asChangeTextDocumentParams(c.document);await this._client.sendNotification(wt.DidChangeTextDocumentNotification.type,u),this.notificationSent(c,wt.DidChangeTextDocumentNotification.type,u)};return this._changeDelayer?(this._changeDelayer.uri!==o.document.uri.toString()&&(this.forceDelivery(),this._changeDelayer.uri=o.document.uri.toString()),this._changeDelayer.delayer.trigger(()=>a(o))):(this._changeDelayer={uri:o.document.uri.toString(),delayer:new Gk.Delayer(200)},this._changeDelayer.delayer.trigger(()=>a(o),-1))};t.push(i.didChange?i.didChange(e,o=>s(o)):s(e))}}return Promise.all(t).then(void 0,r=>{throw this._client.error(`Sending document notification ${wt.DidChangeTextDocumentNotification.type.method} failed`,r),r})}get onNotificationSent(){return this._onNotificationSent.event}notificationSent(e,t,r){this._onNotificationSent.fire({original:e,type:t,params:r})}unregister(e){this._changeData.delete(e),this._changeData.size===0&&this._listener&&(this._listener.dispose(),this._listener=void 0)}dispose(){this._changeDelayer!==void 0&&this._changeDelayer.delayer.cancel(),this._changeDelayer=void 0,this._forcingDelivery=!1,this._changeData.clear(),this._listener&&(this._listener.dispose(),this._listener=void 0)}forceDelivery(){if(!(this._forcingDelivery||!this._changeDelayer))try{this._forcingDelivery=!0,this._changeDelayer.delayer.forceDelivery()}finally{this._forcingDelivery=!1}}getProvider(e){for(let t of this._changeData.values())if(Tn.languages.match(t.documentSelector,e)>0)return{send:r=>this.callback(r)}}};Qt.DidChangeTextDocumentFeature=Nv;var Ov=class extends tt.TextDocumentEventFeature{constructor(e){super(e,Tn.workspace.onWillSaveTextDocument,wt.WillSaveTextDocumentNotification.type,()=>e.middleware.willSave,t=>e.code2ProtocolConverter.asWillSaveTextDocumentParams(t),t=>t.document,(t,r)=>tt.TextDocumentEventFeature.textDocumentFilter(t,r.document))}get registrationType(){return wt.WillSaveTextDocumentNotification.type}fillClientCapabilities(e){let t=(0,tt.ensure)((0,tt.ensure)(e,"textDocument"),"synchronization");t.willSave=!0}initialize(e,t){let r=e.resolvedTextDocumentSync;t&&r&&r.willSave&&this.register({id:Qi.generateUuid(),registerOptions:{documentSelector:t}})}};Qt.WillSaveFeature=Ov;var Lv=class extends tt.DynamicDocumentFeature{constructor(e){super(e);this._selectors=new Map}getDocumentSelectors(){return this._selectors.values()}get registrationType(){return wt.WillSaveTextDocumentWaitUntilRequest.type}fillClientCapabilities(e){let t=(0,tt.ensure)((0,tt.ensure)(e,"textDocument"),"synchronization");t.willSaveWaitUntil=!0}initialize(e,t){let r=e.resolvedTextDocumentSync;t&&r&&r.willSaveWaitUntil&&this.register({id:Qi.generateUuid(),registerOptions:{documentSelector:t}})}register(e){!e.registerOptions.documentSelector||(this._listener||(this._listener=Tn.workspace.onWillSaveTextDocument(this.callback,this)),this._selectors.set(e.id,this._client.protocol2CodeConverter.asDocumentSelector(e.registerOptions.documentSelector)))}callback(e){if(tt.TextDocumentEventFeature.textDocumentFilter(this._selectors.values(),e.document)&&!this._client.hasDedicatedTextSynchronizationFeature(e.document)){let t=this._client.middleware,r=i=>this._client.sendRequest(wt.WillSaveTextDocumentWaitUntilRequest.type,this._client.code2ProtocolConverter.asWillSaveTextDocumentParams(i)).then(async s=>{let o=await this._client.protocol2CodeConverter.asTextEdits(s);return o===void 0?[]:o});e.waitUntil(t.willSaveWaitUntil?t.willSaveWaitUntil(e,r):r(e))}}unregister(e){this._selectors.delete(e),this._selectors.size===0&&this._listener&&(this._listener.dispose(),this._listener=void 0)}dispose(){this._selectors.clear(),this._listener&&(this._listener.dispose(),this._listener=void 0)}};Qt.WillSaveWaitUntilFeature=Lv;var Av=class extends tt.TextDocumentEventFeature{constructor(e){super(e,Tn.workspace.onDidSaveTextDocument,wt.DidSaveTextDocumentNotification.type,()=>e.middleware.didSave,t=>e.code2ProtocolConverter.asSaveTextDocumentParams(t,this._includeText),t=>t,tt.TextDocumentEventFeature.textDocumentFilter);this._includeText=!1}get registrationType(){return wt.DidSaveTextDocumentNotification.type}fillClientCapabilities(e){(0,tt.ensure)((0,tt.ensure)(e,"textDocument"),"synchronization").didSave=!0}initialize(e,t){let r=e.resolvedTextDocumentSync;if(t&&r&&r.save){let i=typeof r.save=="boolean"?{includeText:!1}:{includeText:!!r.save.includeText};this.register({id:Qi.generateUuid(),registerOptions:Object.assign({},{documentSelector:t},i)})}}register(e){this._includeText=!!e.registerOptions.includeText,super.register(e)}};Qt.DidSaveTextDocumentFeature=Av});var jv=F(ja=>{"use strict";Object.defineProperty(ja,"__esModule",{value:!0});ja.CompletionItemFeature=void 0;var Qk=require("vscode"),Ce=ce(),El=be(),Yk=et(),Jk=[Ce.CompletionItemKind.Text,Ce.CompletionItemKind.Method,Ce.CompletionItemKind.Function,Ce.CompletionItemKind.Constructor,Ce.CompletionItemKind.Field,Ce.CompletionItemKind.Variable,Ce.CompletionItemKind.Class,Ce.CompletionItemKind.Interface,Ce.CompletionItemKind.Module,Ce.CompletionItemKind.Property,Ce.CompletionItemKind.Unit,Ce.CompletionItemKind.Value,Ce.CompletionItemKind.Enum,Ce.CompletionItemKind.Keyword,Ce.CompletionItemKind.Snippet,Ce.CompletionItemKind.Color,Ce.CompletionItemKind.File,Ce.CompletionItemKind.Reference,Ce.CompletionItemKind.Folder,Ce.CompletionItemKind.EnumMember,Ce.CompletionItemKind.Constant,Ce.CompletionItemKind.Struct,Ce.CompletionItemKind.Event,Ce.CompletionItemKind.Operator,Ce.CompletionItemKind.TypeParameter],$v=class extends El.TextDocumentLanguageFeature{constructor(e){super(e,Ce.CompletionRequest.type);this.labelDetailsSupport=new Map}fillClientCapabilities(e){let t=(0,El.ensure)((0,El.ensure)(e,"textDocument"),"completion");t.dynamicRegistration=!0,t.contextSupport=!0,t.completionItem={snippetSupport:!0,commitCharactersSupport:!0,documentationFormat:[Ce.MarkupKind.Markdown,Ce.MarkupKind.PlainText],deprecatedSupport:!0,preselectSupport:!0,tagSupport:{valueSet:[Ce.CompletionItemTag.Deprecated]},insertReplaceSupport:!0,resolveSupport:{properties:["documentation","detail","additionalTextEdits"]},insertTextModeSupport:{valueSet:[Ce.InsertTextMode.asIs,Ce.InsertTextMode.adjustIndentation]},labelDetailsSupport:!0},t.insertTextMode=Ce.InsertTextMode.adjustIndentation,t.completionItemKind={valueSet:Jk},t.completionList={itemDefaults:["commitCharacters","editRange","insertTextFormat","insertTextMode"]}}initialize(e,t){let r=this.getRegistrationOptions(t,e.completionProvider);!r||this.register({id:Yk.generateUuid(),registerOptions:r})}registerLanguageProvider(e,t){var a;this.labelDetailsSupport.set(t,!!((a=e.completionItem)==null?void 0:a.labelDetailsSupport));let r=e.triggerCharacters??[],i=e.allCommitCharacters,s=e.documentSelector,o={provideCompletionItems:(c,u,l,h)=>{let p=this._client,C=this._client.middleware,T=(y,R,S,v)=>p.sendRequest(Ce.CompletionRequest.type,p.code2ProtocolConverter.asCompletionParams(y,R,S),v).then(b=>v.isCancellationRequested?null:p.protocol2CodeConverter.asCompletionResult(b,i,v),b=>p.handleFailedRequest(Ce.CompletionRequest.type,v,b,null));return C.provideCompletionItem?C.provideCompletionItem(c,u,h,l,T):T(c,u,h,l)},resolveCompletionItem:e.resolveProvider?(c,u)=>{let l=this._client,h=this._client.middleware,p=(C,T)=>l.sendRequest(Ce.CompletionResolveRequest.type,l.code2ProtocolConverter.asCompletionItem(C,!!this.labelDetailsSupport.get(t)),T).then(y=>T.isCancellationRequested?null:l.protocol2CodeConverter.asCompletionItem(y),y=>l.handleFailedRequest(Ce.CompletionResolveRequest.type,T,y,C));return h.resolveCompletionItem?h.resolveCompletionItem(c,u,p):p(c,u)}:void 0};return[Qk.languages.registerCompletionItemProvider(this._client.protocol2CodeConverter.asDocumentSelector(s),o,...r),o]}};ja.CompletionItemFeature=$v});var Hv=F(Wa=>{"use strict";Object.defineProperty(Wa,"__esModule",{value:!0});Wa.HoverFeature=void 0;var Zk=require("vscode"),ao=ce(),xl=be(),eE=et(),Wv=class extends xl.TextDocumentLanguageFeature{constructor(e){super(e,ao.HoverRequest.type)}fillClientCapabilities(e){let t=(0,xl.ensure)((0,xl.ensure)(e,"textDocument"),"hover");t.dynamicRegistration=!0,t.contentFormat=[ao.MarkupKind.Markdown,ao.MarkupKind.PlainText]}initialize(e,t){let r=this.getRegistrationOptions(t,e.hoverProvider);!r||this.register({id:eE.generateUuid(),registerOptions:r})}registerLanguageProvider(e){let t=e.documentSelector,r={provideHover:(i,s,o)=>{let a=this._client,c=(l,h,p)=>a.sendRequest(ao.HoverRequest.type,a.code2ProtocolConverter.asTextDocumentPositionParams(l,h),p).then(C=>p.isCancellationRequested?null:a.protocol2CodeConverter.asHover(C),C=>a.handleFailedRequest(ao.HoverRequest.type,p,C,null)),u=a.middleware;return u.provideHover?u.provideHover(i,s,o,c):c(i,s,o)}};return[this.registerProvider(t,r),r]}registerProvider(e,t){return Zk.languages.registerHoverProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),t)}};Wa.HoverFeature=Wv});var Kv=F(Ha=>{"use strict";Object.defineProperty(Ha,"__esModule",{value:!0});Ha.DefinitionFeature=void 0;var tE=require("vscode"),ql=ce(),Il=be(),nE=et(),Uv=class extends Il.TextDocumentLanguageFeature{constructor(e){super(e,ql.DefinitionRequest.type)}fillClientCapabilities(e){let t=(0,Il.ensure)((0,Il.ensure)(e,"textDocument"),"definition");t.dynamicRegistration=!0,t.linkSupport=!0}initialize(e,t){let r=this.getRegistrationOptions(t,e.definitionProvider);!r||this.register({id:nE.generateUuid(),registerOptions:r})}registerLanguageProvider(e){let t=e.documentSelector,r={provideDefinition:(i,s,o)=>{let a=this._client,c=(l,h,p)=>a.sendRequest(ql.DefinitionRequest.type,a.code2ProtocolConverter.asTextDocumentPositionParams(l,h),p).then(C=>p.isCancellationRequested?null:a.protocol2CodeConverter.asDefinitionResult(C,p),C=>a.handleFailedRequest(ql.DefinitionRequest.type,p,C,null)),u=a.middleware;return u.provideDefinition?u.provideDefinition(i,s,o,c):c(i,s,o)}};return[this.registerProvider(t,r),r]}registerProvider(e,t){return tE.languages.registerDefinitionProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),t)}};Ha.DefinitionFeature=Uv});var Xv=F(Ua=>{"use strict";Object.defineProperty(Ua,"__esModule",{value:!0});Ua.SignatureHelpFeature=void 0;var zv=require("vscode"),co=ce(),Fl=be(),rE=et(),Vv=class extends Fl.TextDocumentLanguageFeature{constructor(e){super(e,co.SignatureHelpRequest.type)}fillClientCapabilities(e){let t=(0,Fl.ensure)((0,Fl.ensure)(e,"textDocument"),"signatureHelp");t.dynamicRegistration=!0,t.signatureInformation={documentationFormat:[co.MarkupKind.Markdown,co.MarkupKind.PlainText]},t.signatureInformation.parameterInformation={labelOffsetSupport:!0},t.signatureInformation.activeParameterSupport=!0,t.contextSupport=!0}initialize(e,t){let r=this.getRegistrationOptions(t,e.signatureHelpProvider);!r||this.register({id:rE.generateUuid(),registerOptions:r})}registerLanguageProvider(e){let t={provideSignatureHelp:(r,i,s,o)=>{let a=this._client,c=(l,h,p,C)=>a.sendRequest(co.SignatureHelpRequest.type,a.code2ProtocolConverter.asSignatureHelpParams(l,h,p),C).then(T=>C.isCancellationRequested?null:a.protocol2CodeConverter.asSignatureHelp(T,C),T=>a.handleFailedRequest(co.SignatureHelpRequest.type,C,T,null)),u=a.middleware;return u.provideSignatureHelp?u.provideSignatureHelp(r,i,o,s,c):c(r,i,o,s)}};return[this.registerProvider(e,t),t]}registerProvider(e,t){let r=this._client.protocol2CodeConverter.asDocumentSelector(e.documentSelector);if(e.retriggerCharacters===void 0){let i=e.triggerCharacters||[];return zv.languages.registerSignatureHelpProvider(r,t,...i)}else{let i={triggerCharacters:e.triggerCharacters||[],retriggerCharacters:e.retriggerCharacters||[]};return zv.languages.registerSignatureHelpProvider(r,t,i)}}};Ua.SignatureHelpFeature=Vv});var Gv=F(Ka=>{"use strict";Object.defineProperty(Ka,"__esModule",{value:!0});Ka.DocumentHighlightFeature=void 0;var iE=require("vscode"),Nl=ce(),Ol=be(),sE=et(),Bv=class extends Ol.TextDocumentLanguageFeature{constructor(e){super(e,Nl.DocumentHighlightRequest.type)}fillClientCapabilities(e){(0,Ol.ensure)((0,Ol.ensure)(e,"textDocument"),"documentHighlight").dynamicRegistration=!0}initialize(e,t){let r=this.getRegistrationOptions(t,e.documentHighlightProvider);!r||this.register({id:sE.generateUuid(),registerOptions:r})}registerLanguageProvider(e){let t=e.documentSelector,r={provideDocumentHighlights:(i,s,o)=>{let a=this._client,c=(l,h,p)=>a.sendRequest(Nl.DocumentHighlightRequest.type,a.code2ProtocolConverter.asTextDocumentPositionParams(l,h),p).then(C=>p.isCancellationRequested?null:a.protocol2CodeConverter.asDocumentHighlights(C,p),C=>a.handleFailedRequest(Nl.DocumentHighlightRequest.type,p,C,null)),u=a.middleware;return u.provideDocumentHighlights?u.provideDocumentHighlights(i,s,o,c):c(i,s,o)}};return[iE.languages.registerDocumentHighlightProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),r),r]}};Ka.DocumentHighlightFeature=Bv});var Al=F(tr=>{"use strict";Object.defineProperty(tr,"__esModule",{value:!0});tr.DocumentSymbolFeature=tr.SupportedSymbolTags=tr.SupportedSymbolKinds=void 0;var oE=require("vscode"),Ie=ce(),Ll=be(),aE=et();tr.SupportedSymbolKinds=[Ie.SymbolKind.File,Ie.SymbolKind.Module,Ie.SymbolKind.Namespace,Ie.SymbolKind.Package,Ie.SymbolKind.Class,Ie.SymbolKind.Method,Ie.SymbolKind.Property,Ie.SymbolKind.Field,Ie.SymbolKind.Constructor,Ie.SymbolKind.Enum,Ie.SymbolKind.Interface,Ie.SymbolKind.Function,Ie.SymbolKind.Variable,Ie.SymbolKind.Constant,Ie.SymbolKind.String,Ie.SymbolKind.Number,Ie.SymbolKind.Boolean,Ie.SymbolKind.Array,Ie.SymbolKind.Object,Ie.SymbolKind.Key,Ie.SymbolKind.Null,Ie.SymbolKind.EnumMember,Ie.SymbolKind.Struct,Ie.SymbolKind.Event,Ie.SymbolKind.Operator,Ie.SymbolKind.TypeParameter];tr.SupportedSymbolTags=[Ie.SymbolTag.Deprecated];var Qv=class extends Ll.TextDocumentLanguageFeature{constructor(e){super(e,Ie.DocumentSymbolRequest.type)}fillClientCapabilities(e){let t=(0,Ll.ensure)((0,Ll.ensure)(e,"textDocument"),"documentSymbol");t.dynamicRegistration=!0,t.symbolKind={valueSet:tr.SupportedSymbolKinds},t.hierarchicalDocumentSymbolSupport=!0,t.tagSupport={valueSet:tr.SupportedSymbolTags},t.labelSupport=!0}initialize(e,t){let r=this.getRegistrationOptions(t,e.documentSymbolProvider);!r||this.register({id:aE.generateUuid(),registerOptions:r})}registerLanguageProvider(e){let t=e.documentSelector,r={provideDocumentSymbols:(s,o)=>{let a=this._client,c=(l,h)=>a.sendRequest(Ie.DocumentSymbolRequest.type,a.code2ProtocolConverter.asDocumentSymbolParams(l),h).then(async p=>{if(h.isCancellationRequested||p===void 0||p===null)return null;if(p.length===0)return[];{let C=p[0];return Ie.DocumentSymbol.is(C)?await a.protocol2CodeConverter.asDocumentSymbols(p,h):await a.protocol2CodeConverter.asSymbolInformations(p,h)}},p=>a.handleFailedRequest(Ie.DocumentSymbolRequest.type,h,p,null)),u=a.middleware;return u.provideDocumentSymbols?u.provideDocumentSymbols(s,o,c):c(s,o)}},i=e.label!==void 0?{label:e.label}:void 0;return[oE.languages.registerDocumentSymbolProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),r,i),r]}};tr.DocumentSymbolFeature=Qv});var Zv=F(za=>{"use strict";Object.defineProperty(za,"__esModule",{value:!0});za.WorkspaceSymbolFeature=void 0;var cE=require("vscode"),uo=ce(),Ml=be(),Yv=Al(),uE=et(),Jv=class extends Ml.WorkspaceFeature{constructor(e){super(e,uo.WorkspaceSymbolRequest.type)}fillClientCapabilities(e){let t=(0,Ml.ensure)((0,Ml.ensure)(e,"workspace"),"symbol");t.dynamicRegistration=!0,t.symbolKind={valueSet:Yv.SupportedSymbolKinds},t.tagSupport={valueSet:Yv.SupportedSymbolTags},t.resolveSupport={properties:["location.range"]}}initialize(e){!e.workspaceSymbolProvider||this.register({id:uE.generateUuid(),registerOptions:e.workspaceSymbolProvider===!0?{workDoneProgress:!1}:e.workspaceSymbolProvider})}registerLanguageProvider(e){let t={provideWorkspaceSymbols:(r,i)=>{let s=this._client,o=(c,u)=>s.sendRequest(uo.WorkspaceSymbolRequest.type,{query:c},u).then(l=>u.isCancellationRequested?null:s.protocol2CodeConverter.asSymbolInformations(l,u),l=>s.handleFailedRequest(uo.WorkspaceSymbolRequest.type,u,l,null)),a=s.middleware;return a.provideWorkspaceSymbols?a.provideWorkspaceSymbols(r,i,o):o(r,i)},resolveWorkspaceSymbol:e.resolveProvider===!0?(r,i)=>{let s=this._client,o=(c,u)=>s.sendRequest(uo.WorkspaceSymbolResolveRequest.type,s.code2ProtocolConverter.asWorkspaceSymbol(c),u).then(l=>u.isCancellationRequested?null:s.protocol2CodeConverter.asSymbolInformation(l),l=>s.handleFailedRequest(uo.WorkspaceSymbolResolveRequest.type,u,l,null)),a=s.middleware;return a.resolveWorkspaceSymbol?a.resolveWorkspaceSymbol(r,i,o):o(r,i)}:void 0};return[cE.languages.registerWorkspaceSymbolProvider(t),t]}};za.WorkspaceSymbolFeature=Jv});var ty=F(Va=>{"use strict";Object.defineProperty(Va,"__esModule",{value:!0});Va.ReferencesFeature=void 0;var lE=require("vscode"),$l=ce(),jl=be(),dE=et(),ey=class extends jl.TextDocumentLanguageFeature{constructor(e){super(e,$l.ReferencesRequest.type)}fillClientCapabilities(e){(0,jl.ensure)((0,jl.ensure)(e,"textDocument"),"references").dynamicRegistration=!0}initialize(e,t){let r=this.getRegistrationOptions(t,e.referencesProvider);!r||this.register({id:dE.generateUuid(),registerOptions:r})}registerLanguageProvider(e){let t=e.documentSelector,r={provideReferences:(i,s,o,a)=>{let c=this._client,u=(h,p,C,T)=>c.sendRequest($l.ReferencesRequest.type,c.code2ProtocolConverter.asReferenceParams(h,p,C),T).then(y=>T.isCancellationRequested?null:c.protocol2CodeConverter.asReferences(y,T),y=>c.handleFailedRequest($l.ReferencesRequest.type,T,y,null)),l=c.middleware;return l.provideReferences?l.provideReferences(i,s,o,a,u):u(i,s,o,a)}};return[this.registerProvider(t,r),r]}registerProvider(e,t){return lE.languages.registerReferenceProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),t)}};Va.ReferencesFeature=ey});var ry=F(Xa=>{"use strict";Object.defineProperty(Xa,"__esModule",{value:!0});Xa.CodeActionFeature=void 0;var fE=require("vscode"),un=ce(),hE=et(),Wl=be(),ny=class extends Wl.TextDocumentLanguageFeature{constructor(e){super(e,un.CodeActionRequest.type)}fillClientCapabilities(e){let t=(0,Wl.ensure)((0,Wl.ensure)(e,"textDocument"),"codeAction");t.dynamicRegistration=!0,t.isPreferredSupport=!0,t.disabledSupport=!0,t.dataSupport=!0,t.resolveSupport={properties:["edit"]},t.codeActionLiteralSupport={codeActionKind:{valueSet:[un.CodeActionKind.Empty,un.CodeActionKind.QuickFix,un.CodeActionKind.Refactor,un.CodeActionKind.RefactorExtract,un.CodeActionKind.RefactorInline,un.CodeActionKind.RefactorRewrite,un.CodeActionKind.Source,un.CodeActionKind.SourceOrganizeImports]}},t.honorsChangeAnnotations=!1}initialize(e,t){let r=this.getRegistrationOptions(t,e.codeActionProvider);!r||this.register({id:hE.generateUuid(),registerOptions:r})}registerLanguageProvider(e){let t=e.documentSelector,r={provideCodeActions:(i,s,o,a)=>{let c=this._client,u=async(h,p,C,T)=>{let y={textDocument:c.code2ProtocolConverter.asTextDocumentIdentifier(h),range:c.code2ProtocolConverter.asRange(p),context:await c.code2ProtocolConverter.asCodeActionContext(C,T)};return c.sendRequest(un.CodeActionRequest.type,y,T).then(R=>T.isCancellationRequested||R===null||R===void 0?null:c.protocol2CodeConverter.asCodeActionResult(R,T),R=>c.handleFailedRequest(un.CodeActionRequest.type,T,R,null))},l=c.middleware;return l.provideCodeActions?l.provideCodeActions(i,s,o,a,u):u(i,s,o,a)},resolveCodeAction:e.resolveProvider?(i,s)=>{let o=this._client,a=this._client.middleware,c=async(u,l)=>o.sendRequest(un.CodeActionResolveRequest.type,await o.code2ProtocolConverter.asCodeAction(u,l),l).then(h=>l.isCancellationRequested?u:o.protocol2CodeConverter.asCodeAction(h,l),h=>o.handleFailedRequest(un.CodeActionResolveRequest.type,l,h,u));return a.resolveCodeAction?a.resolveCodeAction(i,s,c):c(i,s)}:void 0};return[fE.languages.registerCodeActionsProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),r,e.codeActionKinds?{providedCodeActionKinds:this._client.protocol2CodeConverter.asCodeActionKinds(e.codeActionKinds)}:void 0),r]}};Xa.CodeActionFeature=ny});var oy=F(Ba=>{"use strict";Object.defineProperty(Ba,"__esModule",{value:!0});Ba.CodeLensFeature=void 0;var iy=require("vscode"),Yi=ce(),pE=et(),lo=be(),sy=class extends lo.TextDocumentLanguageFeature{constructor(e){super(e,Yi.CodeLensRequest.type)}fillClientCapabilities(e){(0,lo.ensure)((0,lo.ensure)(e,"textDocument"),"codeLens").dynamicRegistration=!0,(0,lo.ensure)((0,lo.ensure)(e,"workspace"),"codeLens").refreshSupport=!0}initialize(e,t){this._client.onRequest(Yi.CodeLensRefreshRequest.type,async()=>{for(let s of this.getAllProviders())s.onDidChangeCodeLensEmitter.fire()});let i=this.getRegistrationOptions(t,e.codeLensProvider);!i||this.register({id:pE.generateUuid(),registerOptions:i})}registerLanguageProvider(e){let t=e.documentSelector,r=new iy.EventEmitter,i={onDidChangeCodeLenses:r.event,provideCodeLenses:(s,o)=>{let a=this._client,c=(l,h)=>a.sendRequest(Yi.CodeLensRequest.type,a.code2ProtocolConverter.asCodeLensParams(l),h).then(p=>h.isCancellationRequested?null:a.protocol2CodeConverter.asCodeLenses(p,h),p=>a.handleFailedRequest(Yi.CodeLensRequest.type,h,p,null)),u=a.middleware;return u.provideCodeLenses?u.provideCodeLenses(s,o,c):c(s,o)},resolveCodeLens:e.resolveProvider?(s,o)=>{let a=this._client,c=(l,h)=>a.sendRequest(Yi.CodeLensResolveRequest.type,a.code2ProtocolConverter.asCodeLens(l),h).then(p=>h.isCancellationRequested?l:a.protocol2CodeConverter.asCodeLens(p),p=>a.handleFailedRequest(Yi.CodeLensResolveRequest.type,h,p,l)),u=a.middleware;return u.resolveCodeLens?u.resolveCodeLens(s,o,c):c(s,o)}:void 0};return[iy.languages.registerCodeLensProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),i),{provider:i,onDidChangeCodeLensEmitter:r}]}};Ba.CodeLensFeature=sy});var ly=F(Wr=>{"use strict";Object.defineProperty(Wr,"__esModule",{value:!0});Wr.DocumentOnTypeFormattingFeature=Wr.DocumentRangeFormattingFeature=Wr.DocumentFormattingFeature=void 0;var Ga=require("vscode"),vr=ce(),Hl=et(),yr=be(),fo;(function(n){function e(t){let r=Ga.workspace.getConfiguration("files",t);return{trimTrailingWhitespace:r.get("trimTrailingWhitespace"),trimFinalNewlines:r.get("trimFinalNewlines"),insertFinalNewline:r.get("insertFinalNewline")}}n.fromConfiguration=e})(fo||(fo={}));var ay=class extends yr.TextDocumentLanguageFeature{constructor(e){super(e,vr.DocumentFormattingRequest.type)}fillClientCapabilities(e){(0,yr.ensure)((0,yr.ensure)(e,"textDocument"),"formatting").dynamicRegistration=!0}initialize(e,t){let r=this.getRegistrationOptions(t,e.documentFormattingProvider);!r||this.register({id:Hl.generateUuid(),registerOptions:r})}registerLanguageProvider(e){let t=e.documentSelector,r={provideDocumentFormattingEdits:(i,s,o)=>{let a=this._client,c=(l,h,p)=>{let C={textDocument:a.code2ProtocolConverter.asTextDocumentIdentifier(l),options:a.code2ProtocolConverter.asFormattingOptions(h,fo.fromConfiguration(l))};return a.sendRequest(vr.DocumentFormattingRequest.type,C,p).then(T=>p.isCancellationRequested?null:a.protocol2CodeConverter.asTextEdits(T,p),T=>a.handleFailedRequest(vr.DocumentFormattingRequest.type,p,T,null))},u=a.middleware;return u.provideDocumentFormattingEdits?u.provideDocumentFormattingEdits(i,s,o,c):c(i,s,o)}};return[Ga.languages.registerDocumentFormattingEditProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),r),r]}};Wr.DocumentFormattingFeature=ay;var cy=class extends yr.TextDocumentLanguageFeature{constructor(e){super(e,vr.DocumentRangeFormattingRequest.type)}fillClientCapabilities(e){(0,yr.ensure)((0,yr.ensure)(e,"textDocument"),"rangeFormatting").dynamicRegistration=!0}initialize(e,t){let r=this.getRegistrationOptions(t,e.documentRangeFormattingProvider);!r||this.register({id:Hl.generateUuid(),registerOptions:r})}registerLanguageProvider(e){let t=e.documentSelector,r={provideDocumentRangeFormattingEdits:(i,s,o,a)=>{let c=this._client,u=(h,p,C,T)=>{let y={textDocument:c.code2ProtocolConverter.asTextDocumentIdentifier(h),range:c.code2ProtocolConverter.asRange(p),options:c.code2ProtocolConverter.asFormattingOptions(C,fo.fromConfiguration(h))};return c.sendRequest(vr.DocumentRangeFormattingRequest.type,y,T).then(R=>T.isCancellationRequested?null:c.protocol2CodeConverter.asTextEdits(R,T),R=>c.handleFailedRequest(vr.DocumentRangeFormattingRequest.type,T,R,null))},l=c.middleware;return l.provideDocumentRangeFormattingEdits?l.provideDocumentRangeFormattingEdits(i,s,o,a,u):u(i,s,o,a)}};return[Ga.languages.registerDocumentRangeFormattingEditProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),r),r]}};Wr.DocumentRangeFormattingFeature=cy;var uy=class extends yr.TextDocumentLanguageFeature{constructor(e){super(e,vr.DocumentOnTypeFormattingRequest.type)}fillClientCapabilities(e){(0,yr.ensure)((0,yr.ensure)(e,"textDocument"),"onTypeFormatting").dynamicRegistration=!0}initialize(e,t){let r=this.getRegistrationOptions(t,e.documentOnTypeFormattingProvider);!r||this.register({id:Hl.generateUuid(),registerOptions:r})}registerLanguageProvider(e){let t=e.documentSelector,r={provideOnTypeFormattingEdits:(s,o,a,c,u)=>{let l=this._client,h=(C,T,y,R,S)=>{let v={textDocument:l.code2ProtocolConverter.asTextDocumentIdentifier(C),position:l.code2ProtocolConverter.asPosition(T),ch:y,options:l.code2ProtocolConverter.asFormattingOptions(R,fo.fromConfiguration(C))};return l.sendRequest(vr.DocumentOnTypeFormattingRequest.type,v,S).then(b=>S.isCancellationRequested?null:l.protocol2CodeConverter.asTextEdits(b,S),b=>l.handleFailedRequest(vr.DocumentOnTypeFormattingRequest.type,S,b,null))},p=l.middleware;return p.provideOnTypeFormattingEdits?p.provideOnTypeFormattingEdits(s,o,a,c,u,h):h(s,o,a,c,u)}},i=e.moreTriggerCharacter||[];return[Ga.languages.registerOnTypeFormattingEditProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),r,e.firstTriggerCharacter,...i),r]}};Wr.DocumentOnTypeFormattingFeature=uy});var hy=F(Qa=>{"use strict";Object.defineProperty(Qa,"__esModule",{value:!0});Qa.RenameFeature=void 0;var gE=require("vscode"),pi=ce(),mE=et(),dy=vn(),Ul=be(),fy=class extends Ul.TextDocumentLanguageFeature{constructor(e){super(e,pi.RenameRequest.type)}fillClientCapabilities(e){let t=(0,Ul.ensure)((0,Ul.ensure)(e,"textDocument"),"rename");t.dynamicRegistration=!0,t.prepareSupport=!0,t.prepareSupportDefaultBehavior=pi.PrepareSupportDefaultBehavior.Identifier,t.honorsChangeAnnotations=!0}initialize(e,t){let r=this.getRegistrationOptions(t,e.renameProvider);!r||(dy.boolean(e.renameProvider)&&(r.prepareProvider=!1),this.register({id:mE.generateUuid(),registerOptions:r}))}registerLanguageProvider(e){let t=e.documentSelector,r={provideRenameEdits:(i,s,o,a)=>{let c=this._client,u=(h,p,C,T)=>{let y={textDocument:c.code2ProtocolConverter.asTextDocumentIdentifier(h),position:c.code2ProtocolConverter.asPosition(p),newName:C};return c.sendRequest(pi.RenameRequest.type,y,T).then(R=>T.isCancellationRequested?null:c.protocol2CodeConverter.asWorkspaceEdit(R,T),R=>c.handleFailedRequest(pi.RenameRequest.type,T,R,null,!1))},l=c.middleware;return l.provideRenameEdits?l.provideRenameEdits(i,s,o,a,u):u(i,s,o,a)},prepareRename:e.prepareProvider?(i,s,o)=>{let a=this._client,c=(l,h,p)=>{let C={textDocument:a.code2ProtocolConverter.asTextDocumentIdentifier(l),position:a.code2ProtocolConverter.asPosition(h)};return a.sendRequest(pi.PrepareRenameRequest.type,C,p).then(T=>p.isCancellationRequested?null:pi.Range.is(T)?a.protocol2CodeConverter.asRange(T):this.isDefaultBehavior(T)?T.defaultBehavior===!0?null:Promise.reject(new Error("The element can't be renamed.")):T&&pi.Range.is(T.range)?{range:a.protocol2CodeConverter.asRange(T.range),placeholder:T.placeholder}:Promise.reject(new Error("The element can't be renamed.")),T=>{throw typeof T.message=="string"?new Error(T.message):new Error("The element can't be renamed.")})},u=a.middleware;return u.prepareRename?u.prepareRename(i,s,o,c):c(i,s,o)}:void 0};return[this.registerProvider(t,r),r]}registerProvider(e,t){return gE.languages.registerRenameProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),t)}isDefaultBehavior(e){let t=e;return t&&dy.boolean(t.defaultBehavior)}};Qa.RenameFeature=fy});var gy=F(Ya=>{"use strict";Object.defineProperty(Ya,"__esModule",{value:!0});Ya.DocumentLinkFeature=void 0;var vE=require("vscode"),ho=ce(),Kl=be(),yE=et(),py=class extends Kl.TextDocumentLanguageFeature{constructor(e){super(e,ho.DocumentLinkRequest.type)}fillClientCapabilities(e){let t=(0,Kl.ensure)((0,Kl.ensure)(e,"textDocument"),"documentLink");t.dynamicRegistration=!0,t.tooltipSupport=!0}initialize(e,t){let r=this.getRegistrationOptions(t,e.documentLinkProvider);!r||this.register({id:yE.generateUuid(),registerOptions:r})}registerLanguageProvider(e){let t=e.documentSelector,r={provideDocumentLinks:(i,s)=>{let o=this._client,a=(u,l)=>o.sendRequest(ho.DocumentLinkRequest.type,o.code2ProtocolConverter.asDocumentLinkParams(u),l).then(h=>l.isCancellationRequested?null:o.protocol2CodeConverter.asDocumentLinks(h,l),h=>o.handleFailedRequest(ho.DocumentLinkRequest.type,l,h,null)),c=o.middleware;return c.provideDocumentLinks?c.provideDocumentLinks(i,s,a):a(i,s)},resolveDocumentLink:e.resolveProvider?(i,s)=>{let o=this._client,a=(u,l)=>o.sendRequest(ho.DocumentLinkResolveRequest.type,o.code2ProtocolConverter.asDocumentLink(u),l).then(h=>l.isCancellationRequested?u:o.protocol2CodeConverter.asDocumentLink(h),h=>o.handleFailedRequest(ho.DocumentLinkResolveRequest.type,l,h,u)),c=o.middleware;return c.resolveDocumentLink?c.resolveDocumentLink(i,s,a):a(i,s)}:void 0};return[vE.languages.registerDocumentLinkProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),r),r]}};Ya.DocumentLinkFeature=py});var yy=F(Ja=>{"use strict";Object.defineProperty(Ja,"__esModule",{value:!0});Ja.ExecuteCommandFeature=void 0;var wE=require("vscode"),zl=ce(),CE=et(),my=be(),vy=class{constructor(e){this._client=e,this._commands=new Map}getState(){return{kind:"workspace",id:this.registrationType.method,registrations:this._commands.size>0}}get registrationType(){return zl.ExecuteCommandRequest.type}fillClientCapabilities(e){(0,my.ensure)((0,my.ensure)(e,"workspace"),"executeCommand").dynamicRegistration=!0}initialize(e){!e.executeCommandProvider||this.register({id:CE.generateUuid(),registerOptions:Object.assign({},e.executeCommandProvider)})}register(e){let t=this._client,r=t.middleware,i=(s,o)=>{let a={command:s,arguments:o};return t.sendRequest(zl.ExecuteCommandRequest.type,a).then(void 0,c=>t.handleFailedRequest(zl.ExecuteCommandRequest.type,void 0,c,void 0))};if(e.registerOptions.commands){let s=[];for(let o of e.registerOptions.commands)s.push(wE.commands.registerCommand(o,(...a)=>r.executeCommand?r.executeCommand(o,a,i):i(o,a)));this._commands.set(e.id,s)}}unregister(e){let t=this._commands.get(e);t&&t.forEach(r=>r.dispose())}dispose(){this._commands.forEach(e=>{e.forEach(t=>t.dispose())}),this._commands.clear()}};Ja.ExecuteCommandFeature=vy});var Cy=F(ec=>{"use strict";Object.defineProperty(ec,"__esModule",{value:!0});ec.FileSystemWatcherFeature=void 0;var bE=require("vscode"),gi=ce(),Za=be(),wy=class{constructor(e,t){this._client=e,this._notifyFileEvent=t,this._watchers=new Map}getState(){return{kind:"workspace",id:this.registrationType.method,registrations:this._watchers.size>0}}get registrationType(){return gi.DidChangeWatchedFilesNotification.type}fillClientCapabilities(e){(0,Za.ensure)((0,Za.ensure)(e,"workspace"),"didChangeWatchedFiles").dynamicRegistration=!0,(0,Za.ensure)((0,Za.ensure)(e,"workspace"),"didChangeWatchedFiles").relativePatternSupport=!0}initialize(e,t){}register(e){if(!Array.isArray(e.registerOptions.watchers))return;let t=[];for(let r of e.registerOptions.watchers){let i=this._client.protocol2CodeConverter.asGlobPattern(r.globPattern);if(i===void 0)continue;let s=!0,o=!0,a=!0;r.kind!==void 0&&r.kind!==null&&(s=(r.kind&gi.WatchKind.Create)!=0,o=(r.kind&gi.WatchKind.Change)!=0,a=(r.kind&gi.WatchKind.Delete)!=0);let c=bE.workspace.createFileSystemWatcher(i,!s,!o,!a);this.hookListeners(c,s,o,a,t),t.push(c)}this._watchers.set(e.id,t)}registerRaw(e,t){let r=[];for(let i of t)this.hookListeners(i,!0,!0,!0,r);this._watchers.set(e,r)}hookListeners(e,t,r,i,s){t&&e.onDidCreate(o=>this._notifyFileEvent({uri:this._client.code2ProtocolConverter.asUri(o),type:gi.FileChangeType.Created}),null,s),r&&e.onDidChange(o=>this._notifyFileEvent({uri:this._client.code2ProtocolConverter.asUri(o),type:gi.FileChangeType.Changed}),null,s),i&&e.onDidDelete(o=>this._notifyFileEvent({uri:this._client.code2ProtocolConverter.asUri(o),type:gi.FileChangeType.Deleted}),null,s)}unregister(e){let t=this._watchers.get(e);if(t)for(let r of t)r.dispose()}dispose(){this._watchers.forEach(e=>{for(let t of e)t.dispose()}),this._watchers.clear()}};ec.FileSystemWatcherFeature=wy});var Dy=F(tc=>{"use strict";Object.defineProperty(tc,"__esModule",{value:!0});tc.ColorProviderFeature=void 0;var DE=require("vscode"),po=ce(),Vl=be(),by=class extends Vl.TextDocumentLanguageFeature{constructor(e){super(e,po.DocumentColorRequest.type)}fillClientCapabilities(e){(0,Vl.ensure)((0,Vl.ensure)(e,"textDocument"),"colorProvider").dynamicRegistration=!0}initialize(e,t){let[r,i]=this.getRegistration(t,e.colorProvider);!r||!i||this.register({id:r,registerOptions:i})}registerLanguageProvider(e){let t=e.documentSelector,r={provideColorPresentations:(i,s,o)=>{let a=this._client,c=(l,h,p)=>{let C={color:l,textDocument:a.code2ProtocolConverter.asTextDocumentIdentifier(h.document),range:a.code2ProtocolConverter.asRange(h.range)};return a.sendRequest(po.ColorPresentationRequest.type,C,p).then(T=>p.isCancellationRequested?null:this._client.protocol2CodeConverter.asColorPresentations(T,p),T=>a.handleFailedRequest(po.ColorPresentationRequest.type,p,T,null))},u=a.middleware;return u.provideColorPresentations?u.provideColorPresentations(i,s,o,c):c(i,s,o)},provideDocumentColors:(i,s)=>{let o=this._client,a=(u,l)=>{let h={textDocument:o.code2ProtocolConverter.asTextDocumentIdentifier(u)};return o.sendRequest(po.DocumentColorRequest.type,h,l).then(p=>l.isCancellationRequested?null:this._client.protocol2CodeConverter.asColorInformations(p,l),p=>o.handleFailedRequest(po.DocumentColorRequest.type,l,p,null))},c=o.middleware;return c.provideDocumentColors?c.provideDocumentColors(i,s,a):a(i,s)}};return[DE.languages.registerColorProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),r),r]}};tc.ColorProviderFeature=by});var Ry=F(nc=>{"use strict";Object.defineProperty(nc,"__esModule",{value:!0});nc.ImplementationFeature=void 0;var TE=require("vscode"),Xl=ce(),Bl=be(),Ty=class extends Bl.TextDocumentLanguageFeature{constructor(e){super(e,Xl.ImplementationRequest.type)}fillClientCapabilities(e){let t=(0,Bl.ensure)((0,Bl.ensure)(e,"textDocument"),"implementation");t.dynamicRegistration=!0,t.linkSupport=!0}initialize(e,t){let[r,i]=this.getRegistration(t,e.implementationProvider);!r||!i||this.register({id:r,registerOptions:i})}registerLanguageProvider(e){let t=e.documentSelector,r={provideImplementation:(i,s,o)=>{let a=this._client,c=(l,h,p)=>a.sendRequest(Xl.ImplementationRequest.type,a.code2ProtocolConverter.asTextDocumentPositionParams(l,h),p).then(C=>p.isCancellationRequested?null:a.protocol2CodeConverter.asDefinitionResult(C,p),C=>a.handleFailedRequest(Xl.ImplementationRequest.type,p,C,null)),u=a.middleware;return u.provideImplementation?u.provideImplementation(i,s,o,c):c(i,s,o)}};return[this.registerProvider(t,r),r]}registerProvider(e,t){return TE.languages.registerImplementationProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),t)}};nc.ImplementationFeature=Ty});var _y=F(rc=>{"use strict";Object.defineProperty(rc,"__esModule",{value:!0});rc.TypeDefinitionFeature=void 0;var RE=require("vscode"),Gl=ce(),go=be(),Sy=class extends go.TextDocumentLanguageFeature{constructor(e){super(e,Gl.TypeDefinitionRequest.type)}fillClientCapabilities(e){(0,go.ensure)((0,go.ensure)(e,"textDocument"),"typeDefinition").dynamicRegistration=!0;let t=(0,go.ensure)((0,go.ensure)(e,"textDocument"),"typeDefinition");t.dynamicRegistration=!0,t.linkSupport=!0}initialize(e,t){let[r,i]=this.getRegistration(t,e.typeDefinitionProvider);!r||!i||this.register({id:r,registerOptions:i})}registerLanguageProvider(e){let t=e.documentSelector,r={provideTypeDefinition:(i,s,o)=>{let a=this._client,c=(l,h,p)=>a.sendRequest(Gl.TypeDefinitionRequest.type,a.code2ProtocolConverter.asTextDocumentPositionParams(l,h),p).then(C=>p.isCancellationRequested?null:a.protocol2CodeConverter.asDefinitionResult(C,p),C=>a.handleFailedRequest(Gl.TypeDefinitionRequest.type,p,C,null)),u=a.middleware;return u.provideTypeDefinition?u.provideTypeDefinition(i,s,o,c):c(i,s,o)}};return[this.registerProvider(t,r),r]}registerProvider(e,t){return RE.languages.registerTypeDefinitionProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),t)}};rc.TypeDefinitionFeature=Sy});var ky=F(Ji=>{"use strict";Object.defineProperty(Ji,"__esModule",{value:!0});Ji.WorkspaceFoldersFeature=Ji.arrayDiff=void 0;var SE=et(),ic=require("vscode"),mo=ce();function Ql(n,e){if(n!==void 0)return n[e]}function Yl(n,e){return n.filter(t=>e.indexOf(t)<0)}Ji.arrayDiff=Yl;var Py=class{constructor(e){this._client=e,this._listeners=new Map}getState(){return{kind:"workspace",id:this.registrationType.method,registrations:this._listeners.size>0}}get registrationType(){return mo.DidChangeWorkspaceFoldersNotification.type}fillInitializeParams(e){let t=ic.workspace.workspaceFolders;this.initializeWithFolders(t),t===void 0?e.workspaceFolders=null:e.workspaceFolders=t.map(r=>this.asProtocol(r))}initializeWithFolders(e){this._initialFolders=e}fillClientCapabilities(e){e.workspace=e.workspace||{},e.workspace.workspaceFolders=!0}initialize(e){let t=this._client;t.onRequest(mo.WorkspaceFoldersRequest.type,s=>{let o=()=>{let c=ic.workspace.workspaceFolders;return c===void 0?null:c.map(l=>this.asProtocol(l))},a=t.middleware.workspace;return a&&a.workspaceFolders?a.workspaceFolders(s,o):o(s)});let r=Ql(Ql(Ql(e,"workspace"),"workspaceFolders"),"changeNotifications"),i;typeof r=="string"?i=r:r===!0&&(i=SE.generateUuid()),i&&this.register({id:i,registerOptions:void 0})}sendInitialEvent(e){let t;if(this._initialFolders&&e){let r=Yl(this._initialFolders,e),i=Yl(e,this._initialFolders);(i.length>0||r.length>0)&&(t=this.doSendEvent(i,r))}else this._initialFolders?t=this.doSendEvent([],this._initialFolders):e&&(t=this.doSendEvent(e,[]));t!==void 0&&t.catch(r=>{this._client.error(`Sending notification ${mo.DidChangeWorkspaceFoldersNotification.type.method} failed`,r)})}doSendEvent(e,t){let r={event:{added:e.map(i=>this.asProtocol(i)),removed:t.map(i=>this.asProtocol(i))}};return this._client.sendNotification(mo.DidChangeWorkspaceFoldersNotification.type,r)}register(e){let t=e.id,r=this._client,i=ic.workspace.onDidChangeWorkspaceFolders(s=>{let o=u=>this.doSendEvent(u.added,u.removed),a=r.middleware.workspace;(a&&a.didChangeWorkspaceFolders?a.didChangeWorkspaceFolders(s,o):o(s)).catch(u=>{this._client.error(`Sending notification ${mo.DidChangeWorkspaceFoldersNotification.type.method} failed`,u)})});this._listeners.set(t,i),this.sendInitialEvent(ic.workspace.workspaceFolders)}unregister(e){let t=this._listeners.get(e);t!==void 0&&(this._listeners.delete(e),t.dispose())}dispose(){for(let e of this._listeners.values())e.dispose();this._listeners.clear()}asProtocol(e){return e===void 0?null:{uri:this._client.code2ProtocolConverter.asUri(e.uri),name:e.name}}};Ji.WorkspaceFoldersFeature=Py});var xy=F(sc=>{"use strict";Object.defineProperty(sc,"__esModule",{value:!0});sc.FoldingRangeFeature=void 0;var _E=require("vscode"),Zi=ce(),Jl=be(),Ey=class extends Jl.TextDocumentLanguageFeature{constructor(e){super(e,Zi.FoldingRangeRequest.type)}fillClientCapabilities(e){let t=(0,Jl.ensure)((0,Jl.ensure)(e,"textDocument"),"foldingRange");t.dynamicRegistration=!0,t.rangeLimit=5e3,t.lineFoldingOnly=!0,t.foldingRangeKind={valueSet:[Zi.FoldingRangeKind.Comment,Zi.FoldingRangeKind.Imports,Zi.FoldingRangeKind.Region]},t.foldingRange={collapsedText:!1}}initialize(e,t){let[r,i]=this.getRegistration(t,e.foldingRangeProvider);!r||!i||this.register({id:r,registerOptions:i})}registerLanguageProvider(e){let t=e.documentSelector,r={provideFoldingRanges:(i,s,o)=>{let a=this._client,c=(l,h,p)=>{let C={textDocument:a.code2ProtocolConverter.asTextDocumentIdentifier(l)};return a.sendRequest(Zi.FoldingRangeRequest.type,C,p).then(T=>p.isCancellationRequested?null:a.protocol2CodeConverter.asFoldingRanges(T,p),T=>a.handleFailedRequest(Zi.FoldingRangeRequest.type,p,T,null))},u=a.middleware;return u.provideFoldingRanges?u.provideFoldingRanges(i,s,o,c):c(i,s,o)}};return[_E.languages.registerFoldingRangeProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),r),r]}};sc.FoldingRangeFeature=Ey});var Iy=F(oc=>{"use strict";Object.defineProperty(oc,"__esModule",{value:!0});oc.DeclarationFeature=void 0;var PE=require("vscode"),Zl=ce(),ed=be(),qy=class extends ed.TextDocumentLanguageFeature{constructor(e){super(e,Zl.DeclarationRequest.type)}fillClientCapabilities(e){let t=(0,ed.ensure)((0,ed.ensure)(e,"textDocument"),"declaration");t.dynamicRegistration=!0,t.linkSupport=!0}initialize(e,t){let[r,i]=this.getRegistration(t,e.declarationProvider);!r||!i||this.register({id:r,registerOptions:i})}registerLanguageProvider(e){let t=e.documentSelector,r={provideDeclaration:(i,s,o)=>{let a=this._client,c=(l,h,p)=>a.sendRequest(Zl.DeclarationRequest.type,a.code2ProtocolConverter.asTextDocumentPositionParams(l,h),p).then(C=>p.isCancellationRequested?null:a.protocol2CodeConverter.asDeclarationResult(C,p),C=>a.handleFailedRequest(Zl.DeclarationRequest.type,p,C,null)),u=a.middleware;return u.provideDeclaration?u.provideDeclaration(i,s,o,c):c(i,s,o)}};return[this.registerProvider(t,r),r]}registerProvider(e,t){return PE.languages.registerDeclarationProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),t)}};oc.DeclarationFeature=qy});var Ny=F(ac=>{"use strict";Object.defineProperty(ac,"__esModule",{value:!0});ac.SelectionRangeFeature=void 0;var kE=require("vscode"),td=ce(),nd=be(),Fy=class extends nd.TextDocumentLanguageFeature{constructor(e){super(e,td.SelectionRangeRequest.type)}fillClientCapabilities(e){let t=(0,nd.ensure)((0,nd.ensure)(e,"textDocument"),"selectionRange");t.dynamicRegistration=!0}initialize(e,t){let[r,i]=this.getRegistration(t,e.selectionRangeProvider);!r||!i||this.register({id:r,registerOptions:i})}registerLanguageProvider(e){let t=e.documentSelector,r={provideSelectionRanges:(i,s,o)=>{let a=this._client,c=async(l,h,p)=>{let C={textDocument:a.code2ProtocolConverter.asTextDocumentIdentifier(l),positions:await a.code2ProtocolConverter.asPositions(h,p)};return a.sendRequest(td.SelectionRangeRequest.type,C,p).then(T=>p.isCancellationRequested?null:a.protocol2CodeConverter.asSelectionRanges(T,p),T=>a.handleFailedRequest(td.SelectionRangeRequest.type,p,T,null))},u=a.middleware;return u.provideSelectionRanges?u.provideSelectionRanges(i,s,o,c):c(i,s,o)}};return[this.registerProvider(t,r),r]}registerProvider(e,t){return kE.languages.registerSelectionRangeProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),t)}};ac.SelectionRangeFeature=Fy});var Ay=F(cc=>{"use strict";Object.defineProperty(cc,"__esModule",{value:!0});cc.ProgressFeature=void 0;var Oy=ce(),EE=ml();function xE(n,e){return n[e]===void 0&&(n[e]=Object.create(null)),n[e]}var Ly=class{constructor(e){this._client=e,this.activeParts=new Set}getState(){return{kind:"window",id:Oy.WorkDoneProgressCreateRequest.method,registrations:this.activeParts.size>0}}fillClientCapabilities(e){xE(e,"window").workDoneProgress=!0}initialize(){let e=this._client,t=i=>{this.activeParts.delete(i)},r=i=>{this.activeParts.add(new EE.ProgressPart(this._client,i.token,t))};e.onRequest(Oy.WorkDoneProgressCreateRequest.type,r)}dispose(){for(let e of this.activeParts)e.done();this.activeParts.clear()}};cc.ProgressFeature=Ly});var jy=F(uc=>{"use strict";Object.defineProperty(uc,"__esModule",{value:!0});uc.CallHierarchyFeature=void 0;var qE=require("vscode"),mi=ce(),rd=be(),My=class{constructor(e){this.client=e,this.middleware=e.middleware}prepareCallHierarchy(e,t,r){let i=this.client,s=this.middleware,o=(a,c,u)=>{let l=i.code2ProtocolConverter.asTextDocumentPositionParams(a,c);return i.sendRequest(mi.CallHierarchyPrepareRequest.type,l,u).then(h=>u.isCancellationRequested?null:i.protocol2CodeConverter.asCallHierarchyItems(h,u),h=>i.handleFailedRequest(mi.CallHierarchyPrepareRequest.type,u,h,null))};return s.prepareCallHierarchy?s.prepareCallHierarchy(e,t,r,o):o(e,t,r)}provideCallHierarchyIncomingCalls(e,t){let r=this.client,i=this.middleware,s=(o,a)=>{let c={item:r.code2ProtocolConverter.asCallHierarchyItem(o)};return r.sendRequest(mi.CallHierarchyIncomingCallsRequest.type,c,a).then(u=>a.isCancellationRequested?null:r.protocol2CodeConverter.asCallHierarchyIncomingCalls(u,a),u=>r.handleFailedRequest(mi.CallHierarchyIncomingCallsRequest.type,a,u,null))};return i.provideCallHierarchyIncomingCalls?i.provideCallHierarchyIncomingCalls(e,t,s):s(e,t)}provideCallHierarchyOutgoingCalls(e,t){let r=this.client,i=this.middleware,s=(o,a)=>{let c={item:r.code2ProtocolConverter.asCallHierarchyItem(o)};return r.sendRequest(mi.CallHierarchyOutgoingCallsRequest.type,c,a).then(u=>a.isCancellationRequested?null:r.protocol2CodeConverter.asCallHierarchyOutgoingCalls(u,a),u=>r.handleFailedRequest(mi.CallHierarchyOutgoingCallsRequest.type,a,u,null))};return i.provideCallHierarchyOutgoingCalls?i.provideCallHierarchyOutgoingCalls(e,t,s):s(e,t)}},$y=class extends rd.TextDocumentLanguageFeature{constructor(e){super(e,mi.CallHierarchyPrepareRequest.type)}fillClientCapabilities(e){let t=e,r=(0,rd.ensure)((0,rd.ensure)(t,"textDocument"),"callHierarchy");r.dynamicRegistration=!0}initialize(e,t){let[r,i]=this.getRegistration(t,e.callHierarchyProvider);!r||!i||this.register({id:r,registerOptions:i})}registerLanguageProvider(e){let t=this._client,r=new My(t);return[qE.languages.registerCallHierarchyProvider(this._client.protocol2CodeConverter.asDocumentSelector(e.documentSelector),r),r]}};uc.CallHierarchyFeature=$y});var Hy=F(dc=>{"use strict";Object.defineProperty(dc,"__esModule",{value:!0});dc.SemanticTokensFeature=void 0;var lc=require("vscode"),le=ce(),vo=be(),IE=vn(),Wy=class extends vo.TextDocumentLanguageFeature{constructor(e){super(e,le.SemanticTokensRegistrationType.type)}fillClientCapabilities(e){let t=(0,vo.ensure)((0,vo.ensure)(e,"textDocument"),"semanticTokens");t.dynamicRegistration=!0,t.tokenTypes=[le.SemanticTokenTypes.namespace,le.SemanticTokenTypes.type,le.SemanticTokenTypes.class,le.SemanticTokenTypes.enum,le.SemanticTokenTypes.interface,le.SemanticTokenTypes.struct,le.SemanticTokenTypes.typeParameter,le.SemanticTokenTypes.parameter,le.SemanticTokenTypes.variable,le.SemanticTokenTypes.property,le.SemanticTokenTypes.enumMember,le.SemanticTokenTypes.event,le.SemanticTokenTypes.function,le.SemanticTokenTypes.method,le.SemanticTokenTypes.macro,le.SemanticTokenTypes.keyword,le.SemanticTokenTypes.modifier,le.SemanticTokenTypes.comment,le.SemanticTokenTypes.string,le.SemanticTokenTypes.number,le.SemanticTokenTypes.regexp,le.SemanticTokenTypes.operator,le.SemanticTokenTypes.decorator],t.tokenModifiers=[le.SemanticTokenModifiers.declaration,le.SemanticTokenModifiers.definition,le.SemanticTokenModifiers.readonly,le.SemanticTokenModifiers.static,le.SemanticTokenModifiers.deprecated,le.SemanticTokenModifiers.abstract,le.SemanticTokenModifiers.async,le.SemanticTokenModifiers.modification,le.SemanticTokenModifiers.documentation,le.SemanticTokenModifiers.defaultLibrary],t.formats=[le.TokenFormat.Relative],t.requests={range:!0,full:{delta:!0}},t.multilineTokenSupport=!1,t.overlappingTokenSupport=!1,t.serverCancelSupport=!0,t.augmentsSyntaxTokens=!0,(0,vo.ensure)((0,vo.ensure)(e,"workspace"),"semanticTokens").refreshSupport=!0}initialize(e,t){this._client.onRequest(le.SemanticTokensRefreshRequest.type,async()=>{for(let o of this.getAllProviders())o.onDidChangeSemanticTokensEmitter.fire()});let[i,s]=this.getRegistration(t,e.semanticTokensProvider);!i||!s||this.register({id:i,registerOptions:s})}registerLanguageProvider(e){let t=e.documentSelector,r=IE.boolean(e.full)?e.full:e.full!==void 0,i=e.full!==void 0&&typeof e.full!="boolean"&&e.full.delta===!0,s=new lc.EventEmitter,o=r?{onDidChangeSemanticTokens:s.event,provideDocumentSemanticTokens:(C,T)=>{let y=this._client,R=y.middleware,S=(v,b)=>{let P={textDocument:y.code2ProtocolConverter.asTextDocumentIdentifier(v)};return y.sendRequest(le.SemanticTokensRequest.type,P,b).then(N=>b.isCancellationRequested?null:y.protocol2CodeConverter.asSemanticTokens(N,b),N=>y.handleFailedRequest(le.SemanticTokensRequest.type,b,N,null))};return R.provideDocumentSemanticTokens?R.provideDocumentSemanticTokens(C,T,S):S(C,T)},provideDocumentSemanticTokensEdits:i?(C,T,y)=>{let R=this._client,S=R.middleware,v=(b,P,N)=>{let q={textDocument:R.code2ProtocolConverter.asTextDocumentIdentifier(b),previousResultId:P};return R.sendRequest(le.SemanticTokensDeltaRequest.type,q,N).then(async O=>N.isCancellationRequested?null:le.SemanticTokens.is(O)?await R.protocol2CodeConverter.asSemanticTokens(O,N):await R.protocol2CodeConverter.asSemanticTokensEdits(O,N),O=>R.handleFailedRequest(le.SemanticTokensDeltaRequest.type,N,O,null))};return S.provideDocumentSemanticTokensEdits?S.provideDocumentSemanticTokensEdits(C,T,y,v):v(C,T,y)}:void 0}:void 0,c=e.range===!0?{provideDocumentRangeSemanticTokens:(C,T,y)=>{let R=this._client,S=R.middleware,v=(b,P,N)=>{let q={textDocument:R.code2ProtocolConverter.asTextDocumentIdentifier(b),range:R.code2ProtocolConverter.asRange(P)};return R.sendRequest(le.SemanticTokensRangeRequest.type,q,N).then(O=>N.isCancellationRequested?null:R.protocol2CodeConverter.asSemanticTokens(O,N),O=>R.handleFailedRequest(le.SemanticTokensRangeRequest.type,N,O,null))};return S.provideDocumentRangeSemanticTokens?S.provideDocumentRangeSemanticTokens(C,T,y,v):v(C,T,y)}}:void 0,u=[],l=this._client,h=l.protocol2CodeConverter.asSemanticTokensLegend(e.legend),p=l.protocol2CodeConverter.asDocumentSelector(t);return o!==void 0&&u.push(lc.languages.registerDocumentSemanticTokensProvider(p,o,h)),c!==void 0&&u.push(lc.languages.registerDocumentRangeSemanticTokensProvider(p,c,h)),[new lc.Disposable(()=>u.forEach(C=>C.dispose())),{range:c,full:o,onDidChangeSemanticTokensEmitter:s}]}};dc.SemanticTokensFeature=Wy});var Yy=F(Yt=>{"use strict";Object.defineProperty(Yt,"__esModule",{value:!0});Yt.WillDeleteFilesFeature=Yt.WillRenameFilesFeature=Yt.WillCreateFilesFeature=Yt.DidDeleteFilesFeature=Yt.DidRenameFilesFeature=Yt.DidCreateFilesFeature=void 0;var Rn=require("vscode"),FE=Oa(),wr=ce(),NE=et();function Uy(n,e){return n[e]===void 0&&(n[e]={}),n[e]}function OE(n,e){return n[e]}function Ky(n,e,t){n[e]=t}var Hr=class{constructor(e,t,r,i,s){this._client=e,this._event=t,this._registrationType=r,this._clientCapability=i,this._serverCapability=s,this._filters=new Map}getState(){return{kind:"workspace",id:this._registrationType.method,registrations:this._filters.size>0}}filterSize(){return this._filters.size}get registrationType(){return this._registrationType}fillClientCapabilities(e){let t=Uy(Uy(e,"workspace"),"fileOperations");Ky(t,"dynamicRegistration",!0),Ky(t,this._clientCapability,!0)}initialize(e){var i;let t=(i=e.workspace)==null?void 0:i.fileOperations,r=t!==void 0?OE(t,this._serverCapability):void 0;if((r==null?void 0:r.filters)!==void 0)try{this.register({id:NE.generateUuid(),registerOptions:{filters:r.filters}})}catch(s){this._client.warn(`Ignoring invalid glob pattern for ${this._serverCapability} registration: ${s}`)}}register(e){this._listener||(this._listener=this._event(this.send,this));let t=e.registerOptions.filters.map(r=>{let i=new FE.Minimatch(r.pattern.glob,Hr.asMinimatchOptions(r.pattern.options));if(!i.makeRe())throw new Error(`Invalid pattern ${r.pattern.glob}!`);return{scheme:r.scheme,matcher:i,kind:r.pattern.matches}});this._filters.set(e.id,t)}unregister(e){this._filters.delete(e),this._filters.size===0&&this._listener&&(this._listener.dispose(),this._listener=void 0)}dispose(){this._filters.clear(),this._listener&&(this._listener.dispose(),this._listener=void 0)}getFileType(e){return Hr.getFileType(e)}async filter(e,t){let r=await Promise.all(e.files.map(async s=>{let o=t(s),a=o.fsPath.replace(/\\/g,"/");for(let c of this._filters.values())for(let u of c)if(!(u.scheme!==void 0&&u.scheme!==o.scheme)){if(u.matcher.match(a)){if(u.kind===void 0)return!0;let l=await this.getFileType(o);if(l===void 0)return this._client.error(`Failed to determine file type for ${o.toString()}.`),!0;if(l===Rn.FileType.File&&u.kind===wr.FileOperationPatternKind.file||l===Rn.FileType.Directory&&u.kind===wr.FileOperationPatternKind.folder)return!0}else if(u.kind===wr.FileOperationPatternKind.folder&&await Hr.getFileType(o)===Rn.FileType.Directory&&u.matcher.match(`${a}/`))return!0}return!1})),i=e.files.filter((s,o)=>r[o]);return Bo(Ve({},e),{files:i})}static async getFileType(e){try{return(await Rn.workspace.fs.stat(e)).type}catch{return}}static asMinimatchOptions(e){if(e!==void 0&&e.ignoreCase===!0)return{nocase:!0}}},id=class extends Hr{constructor(e,t,r,i,s,o,a){super(e,t,r,i,s);this._notificationType=r,this._accessUri=o,this._createParams=a}async send(e){let t=await this.filter(e,this._accessUri);if(t.files.length){let r=async i=>this._client.sendNotification(this._notificationType,this._createParams(i));return this.doSend(t,r)}}},sd=class extends id{constructor(){super(...arguments);this._fsPathFileTypes=new Map}async getFileType(e){let t=e.fsPath;if(this._fsPathFileTypes.has(t))return this._fsPathFileTypes.get(t);let r=await Hr.getFileType(e);return r&&this._fsPathFileTypes.set(t,r),r}async cacheFileTypes(e,t){await this.filter(e,t)}clearFileTypeCache(){this._fsPathFileTypes.clear()}unregister(e){super.unregister(e),this.filterSize()===0&&this._willListener&&(this._willListener.dispose(),this._willListener=void 0)}dispose(){super.dispose(),this._willListener&&(this._willListener.dispose(),this._willListener=void 0)}},zy=class extends id{constructor(e){super(e,Rn.workspace.onDidCreateFiles,wr.DidCreateFilesNotification.type,"didCreate","didCreate",t=>t,e.code2ProtocolConverter.asDidCreateFilesParams)}doSend(e,t){let r=this._client.middleware.workspace;return(r==null?void 0:r.didCreateFiles)?r.didCreateFiles(e,t):t(e)}};Yt.DidCreateFilesFeature=zy;var Vy=class extends sd{constructor(e){super(e,Rn.workspace.onDidRenameFiles,wr.DidRenameFilesNotification.type,"didRename","didRename",t=>t.oldUri,e.code2ProtocolConverter.asDidRenameFilesParams)}register(e){this._willListener||(this._willListener=Rn.workspace.onWillRenameFiles(this.willRename,this)),super.register(e)}willRename(e){e.waitUntil(this.cacheFileTypes(e,t=>t.oldUri))}doSend(e,t){this.clearFileTypeCache();let r=this._client.middleware.workspace;return(r==null?void 0:r.didRenameFiles)?r.didRenameFiles(e,t):t(e)}};Yt.DidRenameFilesFeature=Vy;var Xy=class extends sd{constructor(e){super(e,Rn.workspace.onDidDeleteFiles,wr.DidDeleteFilesNotification.type,"didDelete","didDelete",t=>t,e.code2ProtocolConverter.asDidDeleteFilesParams)}register(e){this._willListener||(this._willListener=Rn.workspace.onWillDeleteFiles(this.willDelete,this)),super.register(e)}willDelete(e){e.waitUntil(this.cacheFileTypes(e,t=>t))}doSend(e,t){this.clearFileTypeCache();let r=this._client.middleware.workspace;return(r==null?void 0:r.didDeleteFiles)?r.didDeleteFiles(e,t):t(e)}};Yt.DidDeleteFilesFeature=Xy;var fc=class extends Hr{constructor(e,t,r,i,s,o,a){super(e,t,r,i,s);this._requestType=r,this._accessUri=o,this._createParams=a}async send(e){let t=this.waitUntil(e);e.waitUntil(t)}async waitUntil(e){let t=await this.filter(e,this._accessUri);if(t.files.length){let r=i=>this._client.sendRequest(this._requestType,this._createParams(i),i.token).then(this._client.protocol2CodeConverter.asWorkspaceEdit);return this.doSend(t,r)}else return}},By=class extends fc{constructor(e){super(e,Rn.workspace.onWillCreateFiles,wr.WillCreateFilesRequest.type,"willCreate","willCreate",t=>t,e.code2ProtocolConverter.asWillCreateFilesParams)}doSend(e,t){let r=this._client.middleware.workspace;return(r==null?void 0:r.willCreateFiles)?r.willCreateFiles(e,t):t(e)}};Yt.WillCreateFilesFeature=By;var Gy=class extends fc{constructor(e){super(e,Rn.workspace.onWillRenameFiles,wr.WillRenameFilesRequest.type,"willRename","willRename",t=>t.oldUri,e.code2ProtocolConverter.asWillRenameFilesParams)}doSend(e,t){let r=this._client.middleware.workspace;return(r==null?void 0:r.willRenameFiles)?r.willRenameFiles(e,t):t(e)}};Yt.WillRenameFilesFeature=Gy;var Qy=class extends fc{constructor(e){super(e,Rn.workspace.onWillDeleteFiles,wr.WillDeleteFilesRequest.type,"willDelete","willDelete",t=>t,e.code2ProtocolConverter.asWillDeleteFilesParams)}doSend(e,t){let r=this._client.middleware.workspace;return(r==null?void 0:r.willDeleteFiles)?r.willDeleteFiles(e,t):t(e)}};Yt.WillDeleteFilesFeature=Qy});var Zy=F(hc=>{"use strict";Object.defineProperty(hc,"__esModule",{value:!0});hc.LinkedEditingFeature=void 0;var LE=require("vscode"),od=ce(),ad=be(),Jy=class extends ad.TextDocumentLanguageFeature{constructor(e){super(e,od.LinkedEditingRangeRequest.type)}fillClientCapabilities(e){let t=(0,ad.ensure)((0,ad.ensure)(e,"textDocument"),"linkedEditingRange");t.dynamicRegistration=!0}initialize(e,t){let[r,i]=this.getRegistration(t,e.linkedEditingRangeProvider);!r||!i||this.register({id:r,registerOptions:i})}registerLanguageProvider(e){let t=e.documentSelector,r={provideLinkedEditingRanges:(i,s,o)=>{let a=this._client,c=(l,h,p)=>a.sendRequest(od.LinkedEditingRangeRequest.type,a.code2ProtocolConverter.asTextDocumentPositionParams(l,h),p).then(C=>p.isCancellationRequested?null:a.protocol2CodeConverter.asLinkedEditingRanges(C,p),C=>a.handleFailedRequest(od.LinkedEditingRangeRequest.type,p,C,null)),u=a.middleware;return u.provideLinkedEditingRange?u.provideLinkedEditingRange(i,s,o,c):c(i,s,o)}};return[this.registerProvider(t,r),r]}registerProvider(e,t){return LE.languages.registerLinkedEditingRangeProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),t)}};hc.LinkedEditingFeature=Jy});var nw=F(pc=>{"use strict";Object.defineProperty(pc,"__esModule",{value:!0});pc.TypeHierarchyFeature=void 0;var AE=require("vscode"),vi=ce(),cd=be(),ew=class{constructor(e){this.client=e,this.middleware=e.middleware}prepareTypeHierarchy(e,t,r){let i=this.client,s=this.middleware,o=(a,c,u)=>{let l=i.code2ProtocolConverter.asTextDocumentPositionParams(a,c);return i.sendRequest(vi.TypeHierarchyPrepareRequest.type,l,u).then(h=>u.isCancellationRequested?null:i.protocol2CodeConverter.asTypeHierarchyItems(h,u),h=>i.handleFailedRequest(vi.TypeHierarchyPrepareRequest.type,u,h,null))};return s.prepareTypeHierarchy?s.prepareTypeHierarchy(e,t,r,o):o(e,t,r)}provideTypeHierarchySupertypes(e,t){let r=this.client,i=this.middleware,s=(o,a)=>{let c={item:r.code2ProtocolConverter.asTypeHierarchyItem(o)};return r.sendRequest(vi.TypeHierarchySupertypesRequest.type,c,a).then(u=>a.isCancellationRequested?null:r.protocol2CodeConverter.asTypeHierarchyItems(u,a),u=>r.handleFailedRequest(vi.TypeHierarchySupertypesRequest.type,a,u,null))};return i.provideTypeHierarchySupertypes?i.provideTypeHierarchySupertypes(e,t,s):s(e,t)}provideTypeHierarchySubtypes(e,t){let r=this.client,i=this.middleware,s=(o,a)=>{let c={item:r.code2ProtocolConverter.asTypeHierarchyItem(o)};return r.sendRequest(vi.TypeHierarchySubtypesRequest.type,c,a).then(u=>a.isCancellationRequested?null:r.protocol2CodeConverter.asTypeHierarchyItems(u,a),u=>r.handleFailedRequest(vi.TypeHierarchySubtypesRequest.type,a,u,null))};return i.provideTypeHierarchySubtypes?i.provideTypeHierarchySubtypes(e,t,s):s(e,t)}},tw=class extends cd.TextDocumentLanguageFeature{constructor(e){super(e,vi.TypeHierarchyPrepareRequest.type)}fillClientCapabilities(e){let t=(0,cd.ensure)((0,cd.ensure)(e,"textDocument"),"typeHierarchy");t.dynamicRegistration=!0}initialize(e,t){let[r,i]=this.getRegistration(t,e.typeHierarchyProvider);!r||!i||this.register({id:r,registerOptions:i})}registerLanguageProvider(e){let t=this._client,r=new ew(t);return[AE.languages.registerTypeHierarchyProvider(t.protocol2CodeConverter.asDocumentSelector(e.documentSelector),r),r]}};pc.TypeHierarchyFeature=tw});var sw=F(mc=>{"use strict";Object.defineProperty(mc,"__esModule",{value:!0});mc.InlineValueFeature=void 0;var rw=require("vscode"),gc=ce(),yo=be(),iw=class extends yo.TextDocumentLanguageFeature{constructor(e){super(e,gc.InlineValueRequest.type)}fillClientCapabilities(e){(0,yo.ensure)((0,yo.ensure)(e,"textDocument"),"inlineValue").dynamicRegistration=!0,(0,yo.ensure)((0,yo.ensure)(e,"workspace"),"inlineValue").refreshSupport=!0}initialize(e,t){this._client.onRequest(gc.InlineValueRefreshRequest.type,async()=>{for(let s of this.getAllProviders())s.onDidChangeInlineValues.fire()});let[r,i]=this.getRegistration(t,e.inlineValueProvider);!r||!i||this.register({id:r,registerOptions:i})}registerLanguageProvider(e){let t=e.documentSelector,r=new rw.EventEmitter,i={onDidChangeInlineValues:r.event,provideInlineValues:(s,o,a,c)=>{let u=this._client,l=(p,C,T,y)=>{let R={textDocument:u.code2ProtocolConverter.asTextDocumentIdentifier(p),range:u.code2ProtocolConverter.asRange(C),context:u.code2ProtocolConverter.asInlineValueContext(T)};return u.sendRequest(gc.InlineValueRequest.type,R,y).then(S=>y.isCancellationRequested?null:u.protocol2CodeConverter.asInlineValues(S,y),S=>u.handleFailedRequest(gc.InlineValueRequest.type,y,S,null))},h=u.middleware;return h.provideInlineValues?h.provideInlineValues(s,o,a,c,l):l(s,o,a,c)}};return[this.registerProvider(t,i),{provider:i,onDidChangeInlineValues:r}]}registerProvider(e,t){return rw.languages.registerInlineValuesProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),t)}};mc.InlineValueFeature=iw});var cw=F(vc=>{"use strict";Object.defineProperty(vc,"__esModule",{value:!0});vc.InlayHintsFeature=void 0;var ow=require("vscode"),es=ce(),wo=be(),aw=class extends wo.TextDocumentLanguageFeature{constructor(e){super(e,es.InlayHintRequest.type)}fillClientCapabilities(e){let t=(0,wo.ensure)((0,wo.ensure)(e,"textDocument"),"inlayHint");t.dynamicRegistration=!0,t.resolveSupport={properties:["tooltip","textEdits","label.tooltip","label.location","label.command"]},(0,wo.ensure)((0,wo.ensure)(e,"workspace"),"inlayHint").refreshSupport=!0}initialize(e,t){this._client.onRequest(es.InlayHintRefreshRequest.type,async()=>{for(let s of this.getAllProviders())s.onDidChangeInlayHints.fire()});let[r,i]=this.getRegistration(t,e.inlayHintProvider);!r||!i||this.register({id:r,registerOptions:i})}registerLanguageProvider(e){let t=e.documentSelector,r=new ow.EventEmitter,i={onDidChangeInlayHints:r.event,provideInlayHints:(s,o,a)=>{let c=this._client,u=async(h,p,C)=>{let T={textDocument:c.code2ProtocolConverter.asTextDocumentIdentifier(h),range:c.code2ProtocolConverter.asRange(p)};try{let y=await c.sendRequest(es.InlayHintRequest.type,T,C);return C.isCancellationRequested?null:c.protocol2CodeConverter.asInlayHints(y,C)}catch(y){return c.handleFailedRequest(es.InlayHintRequest.type,C,y,null)}},l=c.middleware;return l.provideInlayHints?l.provideInlayHints(s,o,a,u):u(s,o,a)}};return i.resolveInlayHint=e.resolveProvider===!0?(s,o)=>{let a=this._client,c=async(l,h)=>{try{let p=await a.sendRequest(es.InlayHintResolveRequest.type,a.code2ProtocolConverter.asInlayHint(l),h);if(h.isCancellationRequested)return null;let C=a.protocol2CodeConverter.asInlayHint(p,h);return h.isCancellationRequested?null:C}catch(p){return a.handleFailedRequest(es.InlayHintResolveRequest.type,h,p,null)}},u=a.middleware;return u.resolveInlayHint?u.resolveInlayHint(s,o,c):c(s,o)}:void 0,[this.registerProvider(t,i),{provider:i,onDidChangeInlayHints:r}]}registerProvider(e,t){return ow.languages.registerInlayHintsProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),t)}};vc.InlayHintsFeature=aw});var ld=F(Xe=>{"use strict";Object.defineProperty(Xe,"__esModule",{value:!0});Xe.ProposedFeatures=Xe.BaseLanguageClient=Xe.MessageTransports=Xe.SuspendMode=Xe.State=Xe.CloseAction=Xe.ErrorAction=Xe.RevealOutputChannelOn=void 0;var Me=require("vscode"),K=ce(),ME=Mm(),$E=Wm(),Sn=vn(),uw=ro(),lw=et(),jE=ml(),Hn=be(),WE=Sl(),dw=kv(),fw=kl(),ts=Mv(),HE=jv(),UE=Hv(),KE=Kv(),zE=Xv(),VE=Gv(),XE=Al(),BE=Zv(),GE=ty(),QE=ry(),YE=oy(),ud=ly(),JE=hy(),ZE=gy(),ex=yy(),tx=Cy(),nx=Dy(),rx=kl(),ix=Ry(),sx=_y(),ox=ky(),ax=xy(),cx=Iy(),ux=Ny(),lx=Ay(),dx=jy(),fx=Hy(),ns=Yy(),hx=Zy(),px=nw(),gx=sw(),mx=cw(),Co;(function(n){n[n.Info=1]="Info",n[n.Warn=2]="Warn",n[n.Error=3]="Error",n[n.Never=4]="Never"})(Co=Xe.RevealOutputChannelOn||(Xe.RevealOutputChannelOn={}));var yc;(function(n){n[n.Continue=1]="Continue",n[n.Shutdown=2]="Shutdown"})(yc=Xe.ErrorAction||(Xe.ErrorAction={}));var yi;(function(n){n[n.DoNotRestart=1]="DoNotRestart",n[n.Restart=2]="Restart"})(yi=Xe.CloseAction||(Xe.CloseAction={}));var wc;(function(n){n[n.Stopped=1]="Stopped",n[n.Starting=3]="Starting",n[n.Running=2]="Running"})(wc=Xe.State||(Xe.State={}));var vx;(function(n){n.off="off",n.on="on"})(vx=Xe.SuspendMode||(Xe.SuspendMode={}));var hw=class{constructor(e,t){this.client=e,this.maxRestartCount=t,this.restarts=[]}error(e,t,r){return r&&r<=3?{action:yc.Continue}:{action:yc.Shutdown}}closed(){return this.restarts.push(Date.now()),this.restarts.length<=this.maxRestartCount?{action:yi.Restart}:this.restarts[this.restarts.length-1]-this.restarts[0]<=3*60*1e3?{action:yi.DoNotRestart,message:`The ${this.client.name} server crashed ${this.maxRestartCount+1} times in the last 3 minutes. The server will not be restarted. See the output for more information.`}:(this.restarts.shift(),{action:yi.Restart})}},De;(function(n){n.Initial="initial",n.Starting="starting",n.StartFailed="startFailed",n.Running="running",n.Stopping="stopping",n.Stopped="stopped"})(De||(De={}));var yx;(function(n){function e(t){return t&&K.MessageReader.is(t.reader)&&K.MessageWriter.is(t.writer)}n.is=e})(yx=Xe.MessageTransports||(Xe.MessageTransports={}));var rs=class{constructor(e,t,r){var s;this._traceFormat=K.TraceFormat.Text,this._diagnosticQueue=new Map,this._diagnosticQueueState={state:"idle"},this._features=[],this._dynamicFeatures=new Map,this.workspaceEditLock=new uw.Semaphore(1),this._id=e,this._name=t,r=r||{};let i={isTrusted:!1,supportHtml:!1};r.markdown!==void 0&&(i.isTrusted=r.markdown.isTrusted===!0,i.supportHtml=r.markdown.supportHtml===!0),this._clientOptions={documentSelector:r.documentSelector??[],synchronize:r.synchronize??{},diagnosticCollectionName:r.diagnosticCollectionName,outputChannelName:r.outputChannelName??this._name,revealOutputChannelOn:r.revealOutputChannelOn??Co.Error,stdioEncoding:r.stdioEncoding??"utf8",initializationOptions:r.initializationOptions,initializationFailedHandler:r.initializationFailedHandler,progressOnInitialization:!!r.progressOnInitialization,errorHandler:r.errorHandler??this.createDefaultErrorHandler((s=r.connectionOptions)==null?void 0:s.maxRestartCount),middleware:r.middleware??{},uriConverters:r.uriConverters,workspaceFolder:r.workspaceFolder,connectionOptions:r.connectionOptions,markdown:i,diagnosticPullOptions:r.diagnosticPullOptions??{onChange:!0,onSave:!1},notebookDocumentOptions:r.notebookDocumentOptions??{}},this._clientOptions.synchronize=this._clientOptions.synchronize||{},this._state=De.Initial,this._ignoredRegistrations=new Set,this._notificationHandlers=new Map,this._pendingNotificationHandlers=new Map,this._notificationDisposables=new Map,this._requestHandlers=new Map,this._pendingRequestHandlers=new Map,this._requestDisposables=new Map,this._progressHandlers=new Map,this._pendingProgressHandlers=new Map,this._progressDisposables=new Map,this._connection=void 0,this._initializeResult=void 0,r.outputChannel?(this._outputChannel=r.outputChannel,this._disposeOutputChannel=!1):(this._outputChannel=void 0,this._disposeOutputChannel=!0),this._traceOutputChannel=r.traceOutputChannel,this._diagnostics=void 0,this._fileEvents=[],this._fileEventDelayer=new uw.Delayer(250),this._onStop=void 0,this._telemetryEmitter=new K.Emitter,this._stateChangeEmitter=new K.Emitter,this._trace=K.Trace.Off,this._tracer={log:(o,a)=>{Sn.string(o)?this.logTrace(o,a):this.logObjectTrace(o)}},this._c2p=ME.createConverter(r.uriConverters?r.uriConverters.code2Protocol:void 0),this._p2c=$E.createConverter(r.uriConverters?r.uriConverters.protocol2Code:void 0,this._clientOptions.markdown.isTrusted,this._clientOptions.markdown.supportHtml),this._syncedDocuments=new Map,this.registerBuiltinFeatures()}get name(){return this._name}get middleware(){return this._clientOptions.middleware??Object.create(null)}get clientOptions(){return this._clientOptions}get protocol2CodeConverter(){return this._p2c}get code2ProtocolConverter(){return this._c2p}get onTelemetry(){return this._telemetryEmitter.event}get onDidChangeState(){return this._stateChangeEmitter.event}get outputChannel(){return this._outputChannel||(this._outputChannel=Me.window.createOutputChannel(this._clientOptions.outputChannelName?this._clientOptions.outputChannelName:this._name)),this._outputChannel}get traceOutputChannel(){return this._traceOutputChannel?this._traceOutputChannel:this.outputChannel}get diagnostics(){return this._diagnostics}get state(){return this.getPublicState()}get $state(){return this._state}set $state(e){let t=this.getPublicState();this._state=e;let r=this.getPublicState();r!==t&&this._stateChangeEmitter.fire({oldState:t,newState:r})}getPublicState(){switch(this.$state){case De.Starting:return wc.Starting;case De.Running:return wc.Running;default:return wc.Stopped}}get initializeResult(){return this._initializeResult}async sendRequest(e,...t){if(this.$state===De.StartFailed||this.$state===De.Stopping||this.$state===De.Stopped)return Promise.reject(new K.ResponseError(K.ErrorCodes.ConnectionInactive,"Client is not running"));try{let r=await this.$start();return this.forceDocumentSync(),r.sendRequest(e,...t)}catch(r){throw this.error(`Sending request ${Sn.string(e)?e:e.method} failed.`,r),r}}onRequest(e,t){let r=typeof e=="string"?e:e.method;this._requestHandlers.set(r,t);let i=this.activeConnection(),s;return i!==void 0?(this._requestDisposables.set(r,i.onRequest(e,t)),s={dispose:()=>{let o=this._requestDisposables.get(r);o!==void 0&&(o.dispose(),this._requestDisposables.delete(r))}}):(this._pendingRequestHandlers.set(r,t),s={dispose:()=>{this._pendingRequestHandlers.delete(r);let o=this._requestDisposables.get(r);o!==void 0&&(o.dispose(),this._requestDisposables.delete(r))}}),{dispose:()=>{this._requestHandlers.delete(r),s.dispose()}}}async sendNotification(e,t){if(this.$state===De.StartFailed||this.$state===De.Stopping||this.$state===De.Stopped)return Promise.reject(new K.ResponseError(K.ErrorCodes.ConnectionInactive,"Client is not running"));try{let r=await this.$start();return this.forceDocumentSync(),r.sendNotification(e,t)}catch(r){throw this.error(`Sending notification ${Sn.string(e)?e:e.method} failed.`,r),r}}onNotification(e,t){let r=typeof e=="string"?e:e.method;this._notificationHandlers.set(r,t);let i=this.activeConnection(),s;return i!==void 0?(this._notificationDisposables.set(r,i.onNotification(e,t)),s={dispose:()=>{let o=this._notificationDisposables.get(r);o!==void 0&&(o.dispose(),this._notificationDisposables.delete(r))}}):(this._pendingNotificationHandlers.set(r,t),s={dispose:()=>{this._pendingNotificationHandlers.delete(r);let o=this._notificationDisposables.get(r);o!==void 0&&(o.dispose(),this._notificationDisposables.delete(r))}}),{dispose:()=>{this._notificationHandlers.delete(r),s.dispose()}}}async sendProgress(e,t,r){try{return(await this.$start()).sendProgress(e,t,r)}catch(i){throw this.error(`Sending progress for token ${t} failed.`,i),i}}onProgress(e,t,r){var c;this._progressHandlers.set(t,{type:e,handler:r});let i=this.activeConnection(),s,o=(c=this._clientOptions.middleware)==null?void 0:c.handleWorkDoneProgress,a=K.WorkDoneProgress.is(e)&&o!==void 0?u=>{o(t,u,()=>r(u))}:r;return i!==void 0?(this._progressDisposables.set(t,i.onProgress(e,t,a)),s={dispose:()=>{let u=this._progressDisposables.get(t);u!==void 0&&(u.dispose(),this._progressDisposables.delete(t))}}):(this._pendingProgressHandlers.set(t,{type:e,handler:r}),s={dispose:()=>{this._pendingProgressHandlers.delete(t);let u=this._progressDisposables.get(t);u!==void 0&&(u.dispose(),this._progressDisposables.delete(t))}}),{dispose:()=>{this._progressHandlers.delete(t),s.dispose()}}}createDefaultErrorHandler(e){if(e!==void 0&&e<0)throw new Error(`Invalid maxRestartCount: ${e}`);return new hw(this,e??4)}async setTrace(e){this._trace=e;let t=this.activeConnection();t!==void 0&&await t.trace(this._trace,this._tracer,{sendNotification:!1,traceFormat:this._traceFormat})}data2String(e){if(e instanceof K.ResponseError){let t=e;return`  Message: ${t.message}
  Code: ${t.code} ${t.data?`
`+t.data.toString():""}`}return e instanceof Error?Sn.string(e.stack)?e.stack:e.message:Sn.string(e)?e:e.toString()}info(e,t,r=!0){this.outputChannel.appendLine(`[Info  - ${new Date().toLocaleTimeString()}] ${e}`),t!=null&&this.outputChannel.appendLine(this.data2String(t)),r&&this._clientOptions.revealOutputChannelOn<=Co.Info&&this.showNotificationMessage(K.MessageType.Info,e)}warn(e,t,r=!0){this.outputChannel.appendLine(`[Warn  - ${new Date().toLocaleTimeString()}] ${e}`),t!=null&&this.outputChannel.appendLine(this.data2String(t)),r&&this._clientOptions.revealOutputChannelOn<=Co.Warn&&this.showNotificationMessage(K.MessageType.Warning,e)}error(e,t,r=!0){this.outputChannel.appendLine(`[Error - ${new Date().toLocaleTimeString()}] ${e}`),t!=null&&this.outputChannel.appendLine(this.data2String(t)),(r==="force"||r&&this._clientOptions.revealOutputChannelOn<=Co.Error)&&this.showNotificationMessage(K.MessageType.Error,e)}showNotificationMessage(e,t){t=t??"A request has failed. See the output for more information.",(e===K.MessageType.Error?Me.window.showErrorMessage:e===K.MessageType.Warning?Me.window.showWarningMessage:Me.window.showInformationMessage)(t,"Go to output").then(i=>{i!==void 0&&this.outputChannel.show(!0)})}logTrace(e,t){this.traceOutputChannel.appendLine(`[Trace - ${new Date().toLocaleTimeString()}] ${e}`),t&&this.traceOutputChannel.appendLine(this.data2String(t))}logObjectTrace(e){e.isLSPMessage&&e.type?this.traceOutputChannel.append(`[LSP   - ${new Date().toLocaleTimeString()}] `):this.traceOutputChannel.append(`[Trace - ${new Date().toLocaleTimeString()}] `),e&&this.traceOutputChannel.appendLine(`${JSON.stringify(e)}`)}needsStart(){return this.$state===De.Initial||this.$state===De.Stopping||this.$state===De.Stopped}needsStop(){return this.$state===De.Starting||this.$state===De.Running}activeConnection(){return this.$state===De.Running&&this._connection!==void 0?this._connection:void 0}isRunning(){return this.$state===De.Running}async start(){if(this._onStart!==void 0)return this._onStart;let[e,t,r]=this.createOnStartPromise();this._onStart=e,this._onStop!==void 0&&(await this._onStop,this._onStop=void 0),this._diagnostics===void 0&&(this._diagnostics=this._clientOptions.diagnosticCollectionName?Me.languages.createDiagnosticCollection(this._clientOptions.diagnosticCollectionName):Me.languages.createDiagnosticCollection());for(let[i,s]of this._notificationHandlers)this._pendingNotificationHandlers.has(i)||this._pendingNotificationHandlers.set(i,s);for(let[i,s]of this._requestHandlers)this._pendingRequestHandlers.has(i)||this._pendingRequestHandlers.set(i,s);for(let[i,s]of this._progressHandlers)this._pendingProgressHandlers.has(i)||this._pendingProgressHandlers.set(i,s);this.$state=De.Starting;try{let i=await this.createConnection();i.onNotification(K.LogMessageNotification.type,s=>{switch(s.type){case K.MessageType.Error:this.error(s.message,void 0,!1);break;case K.MessageType.Warning:this.warn(s.message,void 0,!1);break;case K.MessageType.Info:this.info(s.message,void 0,!1);break;default:this.outputChannel.appendLine(s.message)}}),i.onNotification(K.ShowMessageNotification.type,s=>{switch(s.type){case K.MessageType.Error:Me.window.showErrorMessage(s.message);break;case K.MessageType.Warning:Me.window.showWarningMessage(s.message);break;case K.MessageType.Info:Me.window.showInformationMessage(s.message);break;default:Me.window.showInformationMessage(s.message)}}),i.onRequest(K.ShowMessageRequest.type,s=>{let o;switch(s.type){case K.MessageType.Error:o=Me.window.showErrorMessage;break;case K.MessageType.Warning:o=Me.window.showWarningMessage;break;case K.MessageType.Info:o=Me.window.showInformationMessage;break;default:o=Me.window.showInformationMessage}let a=s.actions||[];return o(s.message,...a)}),i.onNotification(K.TelemetryEventNotification.type,s=>{this._telemetryEmitter.fire(s)}),i.onRequest(K.ShowDocumentRequest.type,async s=>{var c;let o=async u=>{let l=this.protocol2CodeConverter.asUri(u.uri);try{if(u.external===!0)return{success:await Me.env.openExternal(l)};{let h={};return u.selection!==void 0&&(h.selection=this.protocol2CodeConverter.asRange(u.selection)),u.takeFocus===void 0||u.takeFocus===!1?h.preserveFocus=!0:u.takeFocus===!0&&(h.preserveFocus=!1),await Me.window.showTextDocument(l,h),{success:!0}}}catch{return{success:!0}}},a=(c=this._clientOptions.middleware.window)==null?void 0:c.showDocument;return a!==void 0?a(s,o):o(s)}),i.listen(),await this.initialize(i),t()}catch(i){this.$state=De.StartFailed,this.error(`${this._name} client: couldn't create connection to server.`,i,"force"),r(i)}return this._onStart}createOnStartPromise(){let e,t;return[new Promise((i,s)=>{e=i,t=s}),e,t]}async initialize(e){this.refreshTrace(e,!1);let t=this._clientOptions.initializationOptions,[r,i]=this._clientOptions.workspaceFolder!==void 0?[this._clientOptions.workspaceFolder.uri.fsPath,[{uri:this._c2p.asUri(this._clientOptions.workspaceFolder.uri),name:this._clientOptions.workspaceFolder.name}]]:[this._clientGetRootPath(),null],s={processId:null,clientInfo:{name:Me.env.appName,version:Me.version},locale:this.getLocale(),rootPath:r||null,rootUri:r?this._c2p.asUri(Me.Uri.file(r)):null,capabilities:this.computeClientCapabilities(),initializationOptions:Sn.func(t)?t():t,trace:K.Trace.toString(this._trace),workspaceFolders:i};if(this.fillInitializeParams(s),this._clientOptions.progressOnInitialization){let o=lw.generateUuid(),a=new jE.ProgressPart(e,o);s.workDoneToken=o;try{let c=await this.doInitialize(e,s);return a.done(),c}catch(c){throw a.cancel(),c}}else return this.doInitialize(e,s)}async doInitialize(e,t){try{let r=await e.initialize(t);if(r.capabilities.positionEncoding!==void 0&&r.capabilities.positionEncoding!==K.PositionEncodingKind.UTF16)throw new Error(`Unsupported position encoding (${r.capabilities.positionEncoding}) received from server ${this.name}`);this._initializeResult=r,this.$state=De.Running;let i;Sn.number(r.capabilities.textDocumentSync)?r.capabilities.textDocumentSync===K.TextDocumentSyncKind.None?i={openClose:!1,change:K.TextDocumentSyncKind.None,save:void 0}:i={openClose:!0,change:r.capabilities.textDocumentSync,save:{includeText:!1}}:r.capabilities.textDocumentSync!==void 0&&r.capabilities.textDocumentSync!==null&&(i=r.capabilities.textDocumentSync),this._capabilities=Object.assign({},r.capabilities,{resolvedTextDocumentSync:i}),e.onNotification(K.PublishDiagnosticsNotification.type,s=>this.handleDiagnostics(s)),e.onRequest(K.RegistrationRequest.type,s=>this.handleRegistrationRequest(s)),e.onRequest("client/registerFeature",s=>this.handleRegistrationRequest(s)),e.onRequest(K.UnregistrationRequest.type,s=>this.handleUnregistrationRequest(s)),e.onRequest("client/unregisterFeature",s=>this.handleUnregistrationRequest(s)),e.onRequest(K.ApplyWorkspaceEditRequest.type,s=>this.handleApplyWorkspaceEdit(s));for(let[s,o]of this._pendingNotificationHandlers)this._notificationDisposables.set(s,e.onNotification(s,o));this._pendingNotificationHandlers.clear();for(let[s,o]of this._pendingRequestHandlers)this._requestDisposables.set(s,e.onRequest(s,o));this._pendingRequestHandlers.clear();for(let[s,o]of this._pendingProgressHandlers)this._progressDisposables.set(s,e.onProgress(o.type,s,o.handler));return this._pendingProgressHandlers.clear(),await e.sendNotification(K.InitializedNotification.type,{}),this.hookFileEvents(e),this.hookConfigurationChanged(e),this.initializeFeatures(e),r}catch(r){throw this._clientOptions.initializationFailedHandler?this._clientOptions.initializationFailedHandler(r)?this.initialize(e):this.stop():r instanceof K.ResponseError&&r.data&&r.data.retry?Me.window.showErrorMessage(r.message,{title:"Retry",id:"retry"}).then(i=>{i&&i.id==="retry"?this.initialize(e):this.stop()}):(r&&r.message&&Me.window.showErrorMessage(r.message),this.error("Server initialization failed.",r),this.stop()),r}}_clientGetRootPath(){let e=Me.workspace.workspaceFolders;if(!e||e.length===0)return;let t=e[0];if(t.uri.scheme==="file")return t.uri.fsPath}stop(e=2e3){return this.shutdown("stop",e)}suspend(){return this.shutdown("suspend",5e3)}async shutdown(e,t){if(this.$state===De.Stopped||this.$state===De.Initial)return;if(this.$state===De.Stopping&&this._onStop)return this._onStop;let r=await this.$start();this._initializeResult=void 0,this.$state=De.Stopping,this.cleanUp(e);let i=new Promise(o=>{(0,K.RAL)().timer.setTimeout(o,t)}),s=(async o=>(await o.shutdown(),await o.exit(),o))(r);return this._onStop=Promise.race([i,s]).then(o=>{if(o!==void 0)o.end(),o.dispose();else throw this.error("Stopping server timed out",void 0,!1),new Error("Stopping the server timed out")},o=>{throw this.error("Stopping server failed",o,!1),o}).finally(()=>{this.$state=De.Stopped,e==="stop"&&this.cleanUpChannel(),this._onStart=void 0,this._onStop=void 0,this._connection=void 0,this._ignoredRegistrations.clear()})}cleanUp(e){this._fileEvents=[],this._fileEventDelayer.cancel(),this._syncedDocuments&&this._syncedDocuments.clear();for(let t of Array.from(this._features.entries()).map(r=>r[1]).reverse())t.dispose();e==="stop"&&this._diagnostics!==void 0&&(this._diagnostics.dispose(),this._diagnostics=void 0),this._idleInterval!==void 0&&(this._idleInterval.dispose(),this._idleInterval=void 0)}cleanUpChannel(){this._outputChannel!==void 0&&this._disposeOutputChannel&&(this._outputChannel.dispose(),this._outputChannel=void 0)}notifyFileEvent(e){var s;let t=this;async function r(o){return t._fileEvents.push(o),t._fileEventDelayer.trigger(async()=>{let a=await t.$start();t.forceDocumentSync();let c=a.sendNotification(K.DidChangeWatchedFilesNotification.type,{changes:t._fileEvents});return t._fileEvents=[],c})}let i=(s=this.clientOptions.middleware)==null?void 0:s.workspace;((i==null?void 0:i.didChangeWatchedFile)?i.didChangeWatchedFile(e,r):r(e)).catch(o=>{t.error("Notify file events failed.",o)})}forceDocumentSync(){this._didChangeTextDocumentFeature===void 0&&(this._didChangeTextDocumentFeature=this._dynamicFeatures.get(K.DidChangeTextDocumentNotification.type.method)),this._didChangeTextDocumentFeature.forceDelivery()}handleDiagnostics(e){if(!this._diagnostics)return;let t=e.uri;this._diagnosticQueueState.state==="busy"&&this._diagnosticQueueState.document===t&&this._diagnosticQueueState.tokenSource.cancel(),this._diagnosticQueue.set(e.uri,e.diagnostics),this.triggerDiagnosticQueue()}triggerDiagnosticQueue(){(0,K.RAL)().timer.setImmediate(()=>{this.workDiagnosticQueue()})}workDiagnosticQueue(){if(this._diagnosticQueueState.state==="busy")return;let e=this._diagnosticQueue.entries().next();if(e.done===!0)return;let[t,r]=e.value;this._diagnosticQueue.delete(t);let i=new Me.CancellationTokenSource;this._diagnosticQueueState={state:"busy",document:t,tokenSource:i},this._p2c.asDiagnostics(r,i.token).then(s=>{if(!i.token.isCancellationRequested){let o=this._p2c.asUri(t),a=this.clientOptions.middleware;a.handleDiagnostics?a.handleDiagnostics(o,s,(c,u)=>this.setDiagnostics(c,u)):this.setDiagnostics(o,s)}}).finally(()=>{this._diagnosticQueueState={state:"idle"},this.triggerDiagnosticQueue()})}setDiagnostics(e,t){!this._diagnostics||this._diagnostics.set(e,t)}async $start(){if(this.$state===De.StartFailed)throw new Error("Previous start failed. Can't restart server.");await this.start();let e=this.activeConnection();if(e===void 0)throw new Error("Starting server failed");return e}async createConnection(){let e=(i,s,o)=>{this.handleConnectionError(i,s,o)},t=()=>{this.handleConnectionClosed()},r=await this.createMessageTransports(this._clientOptions.stdioEncoding||"utf8");return this._connection=wx(r.reader,r.writer,e,t,this._clientOptions.connectionOptions),this._connection}handleConnectionClosed(){if(this.$state===De.Stopped)return;try{this._connection!==void 0&&this._connection.dispose()}catch{}let e={action:yi.DoNotRestart};if(this.$state!==De.Stopping)try{e=this._clientOptions.errorHandler.closed()}catch{}this._connection=void 0,e.action===yi.DoNotRestart?(this.error(e.message??"Connection to server got closed. Server will not be restarted.",void 0,"force"),this.cleanUp("stop"),this.$state===De.Starting?this.$state=De.StartFailed:this.$state=De.Stopped,this._onStop=Promise.resolve(),this._onStart=void 0):e.action===yi.Restart&&(this.info(e.message??"Connection to server got closed. Server will restart."),this.cleanUp("restart"),this.$state=De.Initial,this._onStop=Promise.resolve(),this._onStart=void 0,this.start().catch(t=>this.error("Restarting server failed",t,"force")))}handleConnectionError(e,t,r){let i=this._clientOptions.errorHandler.error(e,t,r);i.action===yc.Shutdown&&(this.error(i.message??`Client ${this._name}: connection to server is erroring. Shutting down server.`,void 0,"force"),this.stop().catch(s=>{this.error("Stopping server failed",s,!1)}))}hookConfigurationChanged(e){Me.workspace.onDidChangeConfiguration(()=>{this.refreshTrace(e,!0)})}refreshTrace(e,t=!1){let r=Me.workspace.getConfiguration(this._id),i=K.Trace.Off,s=K.TraceFormat.Text;if(r){let o=r.get("trace.server","off");typeof o=="string"?i=K.Trace.fromString(o):(i=K.Trace.fromString(r.get("trace.server.verbosity","off")),s=K.TraceFormat.fromString(r.get("trace.server.format","text")))}this._trace=i,this._traceFormat=s,e.trace(this._trace,this._tracer,{sendNotification:t,traceFormat:this._traceFormat}).catch(o=>{this.error("Updating trace failed with error",o,!1)})}hookFileEvents(e){let t=this._clientOptions.synchronize.fileEvents;if(!t)return;let r;Sn.array(t)?r=t:r=[t],!!r&&this._dynamicFeatures.get(K.DidChangeWatchedFilesNotification.type.method).registerRaw(lw.generateUuid(),r)}registerFeatures(e){for(let t of e)this.registerFeature(t)}registerFeature(e){if(this._features.push(e),Hn.DynamicFeature.is(e)){let t=e.registrationType;this._dynamicFeatures.set(t.method,e)}}getFeature(e){return this._dynamicFeatures.get(e)}hasDedicatedTextSynchronizationFeature(e){let t=this.getFeature(K.NotebookDocumentSyncRegistrationType.method);return t===void 0||!(t instanceof dw.NotebookDocumentSyncFeature)?!1:t.handles(e)}registerBuiltinFeatures(){this.registerFeature(new fw.ConfigurationFeature(this)),this.registerFeature(new ts.DidOpenTextDocumentFeature(this,this._syncedDocuments)),this.registerFeature(new ts.DidChangeTextDocumentFeature(this)),this.registerFeature(new ts.WillSaveFeature(this)),this.registerFeature(new ts.WillSaveWaitUntilFeature(this)),this.registerFeature(new ts.DidSaveTextDocumentFeature(this)),this.registerFeature(new ts.DidCloseTextDocumentFeature(this,this._syncedDocuments)),this.registerFeature(new tx.FileSystemWatcherFeature(this,e=>this.notifyFileEvent(e))),this.registerFeature(new HE.CompletionItemFeature(this)),this.registerFeature(new UE.HoverFeature(this)),this.registerFeature(new zE.SignatureHelpFeature(this)),this.registerFeature(new KE.DefinitionFeature(this)),this.registerFeature(new GE.ReferencesFeature(this)),this.registerFeature(new VE.DocumentHighlightFeature(this)),this.registerFeature(new XE.DocumentSymbolFeature(this)),this.registerFeature(new BE.WorkspaceSymbolFeature(this)),this.registerFeature(new QE.CodeActionFeature(this)),this.registerFeature(new YE.CodeLensFeature(this)),this.registerFeature(new ud.DocumentFormattingFeature(this)),this.registerFeature(new ud.DocumentRangeFormattingFeature(this)),this.registerFeature(new ud.DocumentOnTypeFormattingFeature(this)),this.registerFeature(new JE.RenameFeature(this)),this.registerFeature(new ZE.DocumentLinkFeature(this)),this.registerFeature(new ex.ExecuteCommandFeature(this)),this.registerFeature(new fw.SyncConfigurationFeature(this)),this.registerFeature(new rx.ConfigurationFeature(this)),this.registerFeature(new sx.TypeDefinitionFeature(this)),this.registerFeature(new ix.ImplementationFeature(this)),this.registerFeature(new nx.ColorProviderFeature(this)),this.clientOptions.workspaceFolder===void 0&&this.registerFeature(new ox.WorkspaceFoldersFeature(this)),this.registerFeature(new ax.FoldingRangeFeature(this)),this.registerFeature(new cx.DeclarationFeature(this)),this.registerFeature(new ux.SelectionRangeFeature(this)),this.registerFeature(new lx.ProgressFeature(this)),this.registerFeature(new dx.CallHierarchyFeature(this)),this.registerFeature(new fx.SemanticTokensFeature(this)),this.registerFeature(new hx.LinkedEditingFeature(this)),this.registerFeature(new ns.DidCreateFilesFeature(this)),this.registerFeature(new ns.DidRenameFilesFeature(this)),this.registerFeature(new ns.DidDeleteFilesFeature(this)),this.registerFeature(new ns.WillCreateFilesFeature(this)),this.registerFeature(new ns.WillRenameFilesFeature(this)),this.registerFeature(new ns.WillDeleteFilesFeature(this)),this.registerFeature(new px.TypeHierarchyFeature(this)),this.registerFeature(new gx.InlineValueFeature(this)),this.registerFeature(new mx.InlayHintsFeature(this)),this.registerFeature(new WE.DiagnosticFeature(this)),this.registerFeature(new dw.NotebookDocumentSyncFeature(this))}registerProposedFeatures(){this.registerFeatures(gw.createAll(this))}fillInitializeParams(e){for(let t of this._features)Sn.func(t.fillInitializeParams)&&t.fillInitializeParams(e)}computeClientCapabilities(){let e={};(0,Hn.ensure)(e,"workspace").applyEdit=!0;let t=(0,Hn.ensure)((0,Hn.ensure)(e,"workspace"),"workspaceEdit");t.documentChanges=!0,t.resourceOperations=[K.ResourceOperationKind.Create,K.ResourceOperationKind.Rename,K.ResourceOperationKind.Delete],t.failureHandling=K.FailureHandlingKind.TextOnlyTransactional,t.normalizesLineEndings=!0,t.changeAnnotationSupport={groupsOnLabel:!0};let r=(0,Hn.ensure)((0,Hn.ensure)(e,"textDocument"),"publishDiagnostics");r.relatedInformation=!0,r.versionSupport=!1,r.tagSupport={valueSet:[K.DiagnosticTag.Unnecessary,K.DiagnosticTag.Deprecated]},r.codeDescriptionSupport=!0,r.dataSupport=!0;let i=(0,Hn.ensure)(e,"window"),s=(0,Hn.ensure)(i,"showMessage");s.messageActionItem={additionalPropertiesSupport:!0};let o=(0,Hn.ensure)(i,"showDocument");o.support=!0;let a=(0,Hn.ensure)(e,"general");a.staleRequestSupport={cancel:!0,retryOnContentModified:Array.from(rs.RequestsToCancelOnContentModified)},a.regularExpressions={engine:"ECMAScript",version:"ES2020"},a.markdown={parser:"marked",version:"1.1.0"},a.positionEncodings=["utf-16"],this._clientOptions.markdown.supportHtml&&(a.markdown.allowedTags=["ul","li","p","code","blockquote","ol","h1","h2","h3","h4","h5","h6","hr","em","pre","table","thead","tbody","tr","th","td","div","del","a","strong","br","img","span"]);for(let c of this._features)c.fillClientCapabilities(e);return e}initializeFeatures(e){let t=this._clientOptions.documentSelector;for(let r of this._features)Sn.func(r.preInitialize)&&r.preInitialize(this._capabilities,t);for(let r of this._features)r.initialize(this._capabilities,t)}async handleRegistrationRequest(e){if(!this.isRunning()){for(let t of e.registrations)this._ignoredRegistrations.add(t.id);return}for(let t of e.registrations){let r=this._dynamicFeatures.get(t.method);if(r===void 0)return Promise.reject(new Error(`No feature implementation for ${t.method} found. Registration failed.`));let i=t.registerOptions??{};i.documentSelector=i.documentSelector??this._clientOptions.documentSelector;let s={id:t.id,registerOptions:i};try{r.register(s)}catch(o){return Promise.reject(o)}}}async handleUnregistrationRequest(e){for(let t of e.unregisterations){if(this._ignoredRegistrations.has(t.id))continue;let r=this._dynamicFeatures.get(t.method);if(!r)return Promise.reject(new Error(`No feature implementation for ${t.method} found. Unregistration failed.`));r.unregister(t.id)}}async handleApplyWorkspaceEdit(e){let t=e.edit,r=await this.workspaceEditLock.lock(()=>this._p2c.asWorkspaceEdit(t)),i=new Map;Me.workspace.textDocuments.forEach(o=>i.set(o.uri.toString(),o));let s=!1;if(t.documentChanges){for(let o of t.documentChanges)if(K.TextDocumentEdit.is(o)&&o.textDocument.version&&o.textDocument.version>=0){let a=i.get(o.textDocument.uri);if(a&&a.version!==o.textDocument.version){s=!0;break}}}return s?Promise.resolve({applied:!1}):Sn.asPromise(Me.workspace.applyEdit(r).then(o=>({applied:o})))}handleFailedRequest(e,t,r,i,s=!0){if(r instanceof K.ResponseError){if(r.code===K.ErrorCodes.PendingResponseRejected||r.code===K.ErrorCodes.ConnectionInactive)return i;if(r.code===K.LSPErrorCodes.RequestCancelled||r.code===K.LSPErrorCodes.ServerCancelled){if(t!==void 0&&t.isCancellationRequested)return i;throw r.data!==void 0?new Hn.LSPCancellationError(r.data):new Me.CancellationError}else if(r.code===K.LSPErrorCodes.ContentModified){if(rs.RequestsToCancelOnContentModified.has(e.method))throw new Me.CancellationError;return i}}throw this.error(`Request ${e.method} failed.`,r,s),r}};Xe.BaseLanguageClient=rs;rs.RequestsToCancelOnContentModified=new Set([K.SemanticTokensRequest.method,K.SemanticTokensRangeRequest.method,K.SemanticTokensDeltaRequest.method]);var pw=class{error(e){(0,K.RAL)().console.error(e)}warn(e){(0,K.RAL)().console.warn(e)}info(e){(0,K.RAL)().console.info(e)}log(e){(0,K.RAL)().console.log(e)}};function wx(n,e,t,r,i){let s=-1,o=new pw,a=(0,K.createProtocolConnection)(n,e,o,i);return a.onError(u=>{t(u[0],u[1],u[2])}),a.onClose(r),{get lastUsed(){return s},resetLastUsed:()=>{s=-1},listen:()=>a.listen(),sendRequest:(u,...l)=>(s=Date.now(),a.sendRequest(u,...l)),onRequest:(u,l)=>a.onRequest(u,l),hasPendingResponse:()=>a.hasPendingResponse(),sendNotification:(u,l)=>(s=Date.now(),a.sendNotification(u,l)),onNotification:(u,l)=>a.onNotification(u,l),onProgress:a.onProgress,sendProgress:a.sendProgress,trace:(u,l,h)=>{let p={sendNotification:!1,traceFormat:K.TraceFormat.Text};return h===void 0?a.trace(u,l,p):(Sn.boolean(h),a.trace(u,l,h))},initialize:u=>(s=Date.now(),a.sendRequest(K.InitializeRequest.type,u)),shutdown:()=>(s=Date.now(),a.sendRequest(K.ShutdownRequest.type,void 0)),exit:()=>(s=Date.now(),a.sendNotification(K.ExitNotification.type)),end:()=>a.end(),dispose:()=>a.dispose()}}var gw;(function(n){function e(t){return[]}n.createAll=e})(gw=Xe.ProposedFeatures||(Xe.ProposedFeatures={}))});var vw=F(Cc=>{"use strict";Object.defineProperty(Cc,"__esModule",{value:!0});Cc.terminate=void 0;var mw=require("child_process"),Cx=require("path"),bx=process.platform==="win32",Dx=process.platform==="darwin",Tx=process.platform==="linux";function Rx(n,e){if(bx)try{let i={stdio:["pipe","pipe","ignore"]};return e&&(i.cwd=e),mw.execFileSync("taskkill",["/T","/F","/PID",n.pid.toString()],i),!0}catch{return!1}else if(Tx||Dx)try{var t=(0,Cx.join)(__dirname,"terminateProcess.sh"),r=mw.spawnSync(t,[n.pid.toString()]);return!r.error}catch{return!1}else return n.kill("SIGKILL"),!0}Cc.terminate=Rx});var dd=F((o0,yw)=>{"use strict";yw.exports=ce()});var Cw=F(ln=>{"use strict";var Sx=ln&&ln.__createBinding||(Object.create?function(n,e,t,r){r===void 0&&(r=t);var i=Object.getOwnPropertyDescriptor(e,t);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(n,r,i)}:function(n,e,t,r){r===void 0&&(r=t),n[r]=e[t]}),fd=ln&&ln.__exportStar||function(n,e){for(var t in n)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&Sx(e,n,t)};Object.defineProperty(ln,"__esModule",{value:!0});ln.DiagnosticPullMode=ln.vsdiag=void 0;fd(ce(),ln);fd(be(),ln);var ww=Sl();Object.defineProperty(ln,"vsdiag",{enumerable:!0,get:function(){return ww.vsdiag}});Object.defineProperty(ln,"DiagnosticPullMode",{enumerable:!0,get:function(){return ww.DiagnosticPullMode}});fd(ld(),ln)});var wd=F(zt=>{"use strict";var _x=zt&&zt.__createBinding||(Object.create?function(n,e,t,r){r===void 0&&(r=t);var i=Object.getOwnPropertyDescriptor(e,t);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(n,r,i)}:function(n,e,t,r){r===void 0&&(r=t),n[r]=e[t]}),bw=zt&&zt.__exportStar||function(n,e){for(var t in n)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&_x(e,n,t)};Object.defineProperty(zt,"__esModule",{value:!0});zt.SettingMonitor=zt.LanguageClient=zt.TransportKind=void 0;var Cr=require("child_process"),hd=require("fs"),pd=require("path"),Dw=Cp(),Ur=require("vscode"),Qe=vn(),Tw=ld(),Px=vw(),nt=dd();bw(dd(),zt);bw(Cw(),zt);var Rw="^1.67.0",st;(function(n){n[n.stdio=0]="stdio",n[n.ipc=1]="ipc",n[n.pipe=2]="pipe",n[n.socket=3]="socket"})(st=zt.TransportKind||(zt.TransportKind={}));var Kr;(function(n){function e(t){let r=t;return r&&r.kind===st.socket&&Qe.number(r.port)}n.isSocket=e})(Kr||(Kr={}));var gd;(function(n){function e(t){return Qe.string(t.command)}n.is=e})(gd||(gd={}));var md;(function(n){function e(t){return Qe.string(t.module)}n.is=e})(md||(md={}));var vd;(function(n){function e(t){let r=t;return r&&r.writer!==void 0&&r.reader!==void 0}n.is=e})(vd||(vd={}));var yd;(function(n){function e(t){let r=t;return r&&r.process!==void 0&&typeof r.detached=="boolean"}n.is=e})(yd||(yd={}));var Sw=class extends Tw.BaseLanguageClient{constructor(e,t,r,i,s){let o,a,c,u,l;Qe.string(t)?(o=e,a=t,c=r,u=i,l=!!s):(o=e.toLowerCase(),a=e,c=t,u=r,l=i),l===void 0&&(l=!1);super(o,a,u);this._serverOptions=c,this._forceDebug=l,this._isInDebugMode=l;try{this.checkVersion()}catch(h){throw Qe.string(h.message)&&this.outputChannel.appendLine(h.message),h}}checkVersion(){let e=Dw.parse(Ur.version);if(!e)throw new Error(`No valid VS Code version detected. Version string is: ${Ur.version}`);if(e.prerelease&&e.prerelease.length>0&&(e.prerelease=[]),!Dw.satisfies(e,Rw))throw new Error(`The language client requires VS Code version ${Rw} but received version ${Ur.version}`)}get isInDebugMode(){return this._isInDebugMode}async restart(){await this.stop(),this.isInDebugMode?(await new Promise(e=>setTimeout(e,1e3)),await this.start()):await this.start()}stop(e=2e3){return super.stop(e).finally(()=>{if(this._serverProcess){let t=this._serverProcess;this._serverProcess=void 0,(this._isDetached===void 0||!this._isDetached)&&this.checkProcessDied(t),this._isDetached=void 0}})}checkProcessDied(e){!e||e.pid===void 0||setTimeout(()=>{try{e.pid!==void 0&&(process.kill(e.pid,0),(0,Px.terminate)(e))}catch{}},2e3)}handleConnectionClosed(){this._serverProcess=void 0,super.handleConnectionClosed()}fillInitializeParams(e){super.fillInitializeParams(e),e.processId===null&&(e.processId=process.pid)}createMessageTransports(e){function t(l,h){if(!l&&!h)return;let p=Object.create(null);return Object.keys(process.env).forEach(C=>p[C]=process.env[C]),h&&(p.ELECTRON_RUN_AS_NODE="1",p.ELECTRON_NO_ASAR="1"),l&&Object.keys(l).forEach(C=>p[C]=l[C]),p}let r=["--debug=","--debug-brk=","--inspect=","--inspect-brk="],i=["--debug","--debug-brk","--inspect","--inspect-brk"];function s(){let l=process.execArgv;return l?l.some(h=>r.some(p=>h.startsWith(p))||i.some(p=>h===p)):!1}function o(l){if(l.stdin===null||l.stdout===null||l.stderr===null)throw new Error("Process created without stdio streams")}let a=this._serverOptions;if(Qe.func(a))return a().then(l=>{if(Tw.MessageTransports.is(l))return this._isDetached=!!l.detached,l;if(vd.is(l))return this._isDetached=!!l.detached,{reader:new nt.StreamMessageReader(l.reader),writer:new nt.StreamMessageWriter(l.writer)};{let h;return yd.is(l)?(h=l.process,this._isDetached=l.detached):(h=l,this._isDetached=!1),h.stderr.on("data",p=>this.outputChannel.append(Qe.string(p)?p:p.toString(e))),{reader:new nt.StreamMessageReader(h.stdout),writer:new nt.StreamMessageWriter(h.stdin)}}});let c,u=a;return u.run||u.debug?this._forceDebug||s()?(c=u.debug,this._isInDebugMode=!0):(c=u.run,this._isInDebugMode=!1):c=a,this._getServerWorkingDir(c.options).then(l=>{if(md.is(c)&&c.module){let h=c,p=h.transport||st.stdio;if(h.runtime){let C=[],T=h.options??Object.create(null);T.execArgv&&T.execArgv.forEach(v=>C.push(v)),C.push(h.module),h.args&&h.args.forEach(v=>C.push(v));let y=Object.create(null);y.cwd=l,y.env=t(T.env,!1);let R=this._getRuntimePath(h.runtime,l),S;if(p===st.ipc?(y.stdio=[null,null,null,"ipc"],C.push("--node-ipc")):p===st.stdio?C.push("--stdio"):p===st.pipe?(S=(0,nt.generateRandomPipeName)(),C.push(`--pipe=${S}`)):Kr.isSocket(p)&&C.push(`--socket=${p.port}`),C.push(`--clientProcessId=${process.pid.toString()}`),p===st.ipc||p===st.stdio){let v=Cr.spawn(R,C,y);return!v||!v.pid?is(v,`Launching server using runtime ${R} failed.`):(this._serverProcess=v,v.stderr.on("data",b=>this.outputChannel.append(Qe.string(b)?b:b.toString(e))),p===st.ipc?(v.stdout.on("data",b=>this.outputChannel.append(Qe.string(b)?b:b.toString(e))),Promise.resolve({reader:new nt.IPCMessageReader(v),writer:new nt.IPCMessageWriter(v)})):Promise.resolve({reader:new nt.StreamMessageReader(v.stdout),writer:new nt.StreamMessageWriter(v.stdin)}))}else{if(p===st.pipe)return(0,nt.createClientPipeTransport)(S).then(v=>{let b=Cr.spawn(R,C,y);return!b||!b.pid?is(b,`Launching server using runtime ${R} failed.`):(this._serverProcess=b,b.stderr.on("data",P=>this.outputChannel.append(Qe.string(P)?P:P.toString(e))),b.stdout.on("data",P=>this.outputChannel.append(Qe.string(P)?P:P.toString(e))),v.onConnected().then(P=>({reader:P[0],writer:P[1]})))});if(Kr.isSocket(p))return(0,nt.createClientSocketTransport)(p.port).then(v=>{let b=Cr.spawn(R,C,y);return!b||!b.pid?is(b,`Launching server using runtime ${R} failed.`):(this._serverProcess=b,b.stderr.on("data",P=>this.outputChannel.append(Qe.string(P)?P:P.toString(e))),b.stdout.on("data",P=>this.outputChannel.append(Qe.string(P)?P:P.toString(e))),v.onConnected().then(P=>({reader:P[0],writer:P[1]})))})}}else{let C;return new Promise((T,y)=>{let R=(h.args&&h.args.slice())??[];p===st.ipc?R.push("--node-ipc"):p===st.stdio?R.push("--stdio"):p===st.pipe?(C=(0,nt.generateRandomPipeName)(),R.push(`--pipe=${C}`)):Kr.isSocket(p)&&R.push(`--socket=${p.port}`),R.push(`--clientProcessId=${process.pid.toString()}`);let S=h.options??Object.create(null);if(S.env=t(S.env,!0),S.execArgv=S.execArgv||[],S.cwd=l,S.silent=!0,p===st.ipc||p===st.stdio){let v=Cr.fork(h.module,R||[],S);o(v),this._serverProcess=v,v.stderr.on("data",b=>this.outputChannel.append(Qe.string(b)?b:b.toString(e))),p===st.ipc?(v.stdout.on("data",b=>this.outputChannel.append(Qe.string(b)?b:b.toString(e))),T({reader:new nt.IPCMessageReader(this._serverProcess),writer:new nt.IPCMessageWriter(this._serverProcess)})):T({reader:new nt.StreamMessageReader(v.stdout),writer:new nt.StreamMessageWriter(v.stdin)})}else p===st.pipe?(0,nt.createClientPipeTransport)(C).then(v=>{let b=Cr.fork(h.module,R||[],S);o(b),this._serverProcess=b,b.stderr.on("data",P=>this.outputChannel.append(Qe.string(P)?P:P.toString(e))),b.stdout.on("data",P=>this.outputChannel.append(Qe.string(P)?P:P.toString(e))),v.onConnected().then(P=>{T({reader:P[0],writer:P[1]})},y)},y):Kr.isSocket(p)&&(0,nt.createClientSocketTransport)(p.port).then(v=>{let b=Cr.fork(h.module,R||[],S);o(b),this._serverProcess=b,b.stderr.on("data",P=>this.outputChannel.append(Qe.string(P)?P:P.toString(e))),b.stdout.on("data",P=>this.outputChannel.append(Qe.string(P)?P:P.toString(e))),v.onConnected().then(P=>{T({reader:P[0],writer:P[1]})},y)},y)})}}else if(gd.is(c)&&c.command){let h=c,p=c.args!==void 0?c.args.slice(0):[],C,T=c.transport;if(T===st.stdio)p.push("--stdio");else if(T===st.pipe)C=(0,nt.generateRandomPipeName)(),p.push(`--pipe=${C}`);else if(Kr.isSocket(T))p.push(`--socket=${T.port}`);else if(T===st.ipc)throw new Error("Transport kind ipc is not support for command executable");let y=Object.assign({},h.options);if(y.cwd=y.cwd||l,T===void 0||T===st.stdio){let R=Cr.spawn(h.command,p,y);return!R||!R.pid?is(R,`Launching server using command ${h.command} failed.`):(R.stderr.on("data",S=>this.outputChannel.append(Qe.string(S)?S:S.toString(e))),this._serverProcess=R,this._isDetached=!!y.detached,Promise.resolve({reader:new nt.StreamMessageReader(R.stdout),writer:new nt.StreamMessageWriter(R.stdin)}))}else{if(T===st.pipe)return(0,nt.createClientPipeTransport)(C).then(R=>{let S=Cr.spawn(h.command,p,y);return!S||!S.pid?is(S,`Launching server using command ${h.command} failed.`):(this._serverProcess=S,this._isDetached=!!y.detached,S.stderr.on("data",v=>this.outputChannel.append(Qe.string(v)?v:v.toString(e))),S.stdout.on("data",v=>this.outputChannel.append(Qe.string(v)?v:v.toString(e))),R.onConnected().then(v=>({reader:v[0],writer:v[1]})))});if(Kr.isSocket(T))return(0,nt.createClientSocketTransport)(T.port).then(R=>{let S=Cr.spawn(h.command,p,y);return!S||!S.pid?is(S,`Launching server using command ${h.command} failed.`):(this._serverProcess=S,this._isDetached=!!y.detached,S.stderr.on("data",v=>this.outputChannel.append(Qe.string(v)?v:v.toString(e))),S.stdout.on("data",v=>this.outputChannel.append(Qe.string(v)?v:v.toString(e))),R.onConnected().then(v=>({reader:v[0],writer:v[1]})))})}}return Promise.reject(new Error("Unsupported server configuration "+JSON.stringify(a,null,4)))})}_getRuntimePath(e,t){if(pd.isAbsolute(e))return e;let r=this._mainGetRootPath();if(r!==void 0){let i=pd.join(r,e);if(hd.existsSync(i))return i}if(t!==void 0){let i=pd.join(t,e);if(hd.existsSync(i))return i}return e}_mainGetRootPath(){let e=Ur.workspace.workspaceFolders;if(!e||e.length===0)return;let t=e[0];if(t.uri.scheme==="file")return t.uri.fsPath}_getServerWorkingDir(e){let t=e&&e.cwd;return t||(t=this.clientOptions.workspaceFolder?this.clientOptions.workspaceFolder.uri.fsPath:this._mainGetRootPath()),t?new Promise(r=>{hd.lstat(t,(i,s)=>{r(!i&&s.isDirectory()?t:void 0)})}):Promise.resolve(void 0)}getLocale(){let e=process.env.VSCODE_NLS_CONFIG;if(e===void 0)return"en";let t;try{t=JSON.parse(e)}catch{}return t===void 0||typeof t.locale!="string"?"en":t.locale}};zt.LanguageClient=Sw;var _w=class{constructor(e,t){this._client=e,this._setting=t,this._listeners=[]}start(){return Ur.workspace.onDidChangeConfiguration(this.onDidChangeConfiguration,this,this._listeners),this.onDidChangeConfiguration(),new Ur.Disposable(()=>{this._client.needsStop()&&this._client.stop()})}onDidChangeConfiguration(){let e=this._setting.indexOf("."),t=e>=0?this._setting.substr(0,e):this._setting,r=e>=0?this._setting.substr(e+1):void 0,i=r?Ur.workspace.getConfiguration(t).get(r,!1):Ur.workspace.getConfiguration(t);i&&this._client.needsStart()?this._client.start().catch(s=>this._client.error("Start failed after configuration change",s,"force")):!i&&this._client.needsStop()&&this._client.stop().catch(s=>this._client.error("Stop failed after configuration change",s,"force"))}};zt.SettingMonitor=_w;function is(n,e){return n===null?Promise.reject(e):new Promise((t,r)=>{n.on("error",i=>{r(`${e} ${i}`)}),setImmediate(()=>r(e))})}});var Cd=F((u0,Pw)=>{"use strict";Pw.exports=wd()});var Ow=F(Nw=>{Nw.entityMap={lt:"<",gt:">",amp:"&",quot:'"',apos:"'",Agrave:"\xC0",Aacute:"\xC1",Acirc:"\xC2",Atilde:"\xC3",Auml:"\xC4",Aring:"\xC5",AElig:"\xC6",Ccedil:"\xC7",Egrave:"\xC8",Eacute:"\xC9",Ecirc:"\xCA",Euml:"\xCB",Igrave:"\xCC",Iacute:"\xCD",Icirc:"\xCE",Iuml:"\xCF",ETH:"\xD0",Ntilde:"\xD1",Ograve:"\xD2",Oacute:"\xD3",Ocirc:"\xD4",Otilde:"\xD5",Ouml:"\xD6",Oslash:"\xD8",Ugrave:"\xD9",Uacute:"\xDA",Ucirc:"\xDB",Uuml:"\xDC",Yacute:"\xDD",THORN:"\xDE",szlig:"\xDF",agrave:"\xE0",aacute:"\xE1",acirc:"\xE2",atilde:"\xE3",auml:"\xE4",aring:"\xE5",aelig:"\xE6",ccedil:"\xE7",egrave:"\xE8",eacute:"\xE9",ecirc:"\xEA",euml:"\xEB",igrave:"\xEC",iacute:"\xED",icirc:"\xEE",iuml:"\xEF",eth:"\xF0",ntilde:"\xF1",ograve:"\xF2",oacute:"\xF3",ocirc:"\xF4",otilde:"\xF5",ouml:"\xF6",oslash:"\xF8",ugrave:"\xF9",uacute:"\xFA",ucirc:"\xFB",uuml:"\xFC",yacute:"\xFD",thorn:"\xFE",yuml:"\xFF",nbsp:"\xA0",iexcl:"\xA1",cent:"\xA2",pound:"\xA3",curren:"\xA4",yen:"\xA5",brvbar:"\xA6",sect:"\xA7",uml:"\xA8",copy:"\xA9",ordf:"\xAA",laquo:"\xAB",not:"\xAC",shy:"\xAD\xAD",reg:"\xAE",macr:"\xAF",deg:"\xB0",plusmn:"\xB1",sup2:"\xB2",sup3:"\xB3",acute:"\xB4",micro:"\xB5",para:"\xB6",middot:"\xB7",cedil:"\xB8",sup1:"\xB9",ordm:"\xBA",raquo:"\xBB",frac14:"\xBC",frac12:"\xBD",frac34:"\xBE",iquest:"\xBF",times:"\xD7",divide:"\xF7",forall:"\u2200",part:"\u2202",exist:"\u2203",empty:"\u2205",nabla:"\u2207",isin:"\u2208",notin:"\u2209",ni:"\u220B",prod:"\u220F",sum:"\u2211",minus:"\u2212",lowast:"\u2217",radic:"\u221A",prop:"\u221D",infin:"\u221E",ang:"\u2220",and:"\u2227",or:"\u2228",cap:"\u2229",cup:"\u222A",int:"\u222B",there4:"\u2234",sim:"\u223C",cong:"\u2245",asymp:"\u2248",ne:"\u2260",equiv:"\u2261",le:"\u2264",ge:"\u2265",sub:"\u2282",sup:"\u2283",nsub:"\u2284",sube:"\u2286",supe:"\u2287",oplus:"\u2295",otimes:"\u2297",perp:"\u22A5",sdot:"\u22C5",Alpha:"\u0391",Beta:"\u0392",Gamma:"\u0393",Delta:"\u0394",Epsilon:"\u0395",Zeta:"\u0396",Eta:"\u0397",Theta:"\u0398",Iota:"\u0399",Kappa:"\u039A",Lambda:"\u039B",Mu:"\u039C",Nu:"\u039D",Xi:"\u039E",Omicron:"\u039F",Pi:"\u03A0",Rho:"\u03A1",Sigma:"\u03A3",Tau:"\u03A4",Upsilon:"\u03A5",Phi:"\u03A6",Chi:"\u03A7",Psi:"\u03A8",Omega:"\u03A9",alpha:"\u03B1",beta:"\u03B2",gamma:"\u03B3",delta:"\u03B4",epsilon:"\u03B5",zeta:"\u03B6",eta:"\u03B7",theta:"\u03B8",iota:"\u03B9",kappa:"\u03BA",lambda:"\u03BB",mu:"\u03BC",nu:"\u03BD",xi:"\u03BE",omicron:"\u03BF",pi:"\u03C0",rho:"\u03C1",sigmaf:"\u03C2",sigma:"\u03C3",tau:"\u03C4",upsilon:"\u03C5",phi:"\u03C6",chi:"\u03C7",psi:"\u03C8",omega:"\u03C9",thetasym:"\u03D1",upsih:"\u03D2",piv:"\u03D6",OElig:"\u0152",oelig:"\u0153",Scaron:"\u0160",scaron:"\u0161",Yuml:"\u0178",fnof:"\u0192",circ:"\u02C6",tilde:"\u02DC",ensp:"\u2002",emsp:"\u2003",thinsp:"\u2009",zwnj:"\u200C",zwj:"\u200D",lrm:"\u200E",rlm:"\u200F",ndash:"\u2013",mdash:"\u2014",lsquo:"\u2018",rsquo:"\u2019",sbquo:"\u201A",ldquo:"\u201C",rdquo:"\u201D",bdquo:"\u201E",dagger:"\u2020",Dagger:"\u2021",bull:"\u2022",hellip:"\u2026",permil:"\u2030",prime:"\u2032",Prime:"\u2033",lsaquo:"\u2039",rsaquo:"\u203A",oline:"\u203E",euro:"\u20AC",trade:"\u2122",larr:"\u2190",uarr:"\u2191",rarr:"\u2192",darr:"\u2193",harr:"\u2194",crarr:"\u21B5",lceil:"\u2308",rceil:"\u2309",lfloor:"\u230A",rfloor:"\u230B",loz:"\u25CA",spades:"\u2660",clubs:"\u2663",hearts:"\u2665",diams:"\u2666"}});var Uw=F(Rd=>{var Td=/[A-Z_a-z\xC0-\xD6\xD8-\xF6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,Lw=new RegExp("[\\-\\.0-9"+Td.source.slice(1,-1)+"\\u00B7\\u0300-\\u036F\\u203F-\\u2040]"),Aw=new RegExp("^"+Td.source+Lw.source+"*(?::"+Td.source+Lw.source+"*)?$"),To=0,zr=1,ss=2,Ro=3,os=4,as=5,So=6,Tc=7;function cs(n,e){this.message=n,this.locator=e,Error.captureStackTrace&&Error.captureStackTrace(this,cs)}cs.prototype=new Error;cs.prototype.name=cs.name;function Mw(){}Mw.prototype={parse:function(n,e,t){var r=this.domBuilder;r.startDocument(),Ww(e,e={}),kx(n,e,t,r,this.errorHandler),r.endDocument()}};function kx(n,e,t,r,i){function s(de){if(de>65535){de-=65536;var Ue=55296+(de>>10),je=56320+(de&1023);return String.fromCharCode(Ue,je)}else return String.fromCharCode(de)}function o(de){var Ue=de.slice(1,-1);return Ue in t?t[Ue]:Ue.charAt(0)==="#"?s(parseInt(Ue.substr(1).replace("x","0x"))):(i.error("entity not found:"+de),de)}function a(de){if(de>y){var Ue=n.substring(y,de).replace(/&#?\w+;/g,o);p&&c(y),r.characters(Ue,0,de-y),y=de}}function c(de,Ue){for(;de>=l&&(Ue=h.exec(n));)u=Ue.index,l=u+Ue[0].length,p.lineNumber++;p.columnNumber=de-u+1}for(var u=0,l=0,h=/.*(?:\r\n?|\n)|.*$/g,p=r.locator,C=[{currentNSMap:e}],T={},y=0;;){try{var R=n.indexOf("<",y);if(R<0){if(!n.substr(y).match(/^\s*$/)){var S=r.doc,v=S.createTextNode(n.substr(y));S.appendChild(v),r.currentElement=v}return}switch(R>y&&a(R),n.charAt(R+1)){case"/":var b=n.indexOf(">",R+3),P=n.substring(R+2,b),N=C.pop();b<0?(P=n.substring(R+2).replace(/[\s<].*/,""),i.error("end tag name: "+P+" is not complete:"+N.tagName),b=R+1+P.length):P.match(/\s</)&&(P=P.replace(/[\s<].*/,""),i.error("end tag name: "+P+" maybe not complete"),b=R+1+P.length);var q=N.localNSMap,O=N.tagName==P,H=O||N.tagName&&N.tagName.toLowerCase()==P.toLowerCase();if(H){if(r.endElement(N.uri,N.localName,P),q)for(var B in q)r.endPrefixMapping(B);O||i.fatalError("end tag name: "+P+" is not match the current start tagName:"+N.tagName)}else C.push(N);b++;break;case"?":p&&c(R),b=Fx(n,R,r);break;case"!":p&&c(R),b=Ix(n,R,r,i);break;default:p&&c(R);var Y=new Hw,Z=C[C.length-1].currentNSMap,b=Ex(n,R,Y,Z,o,i),Oe=Y.length;if(!Y.closed&&qx(n,b,Y.tagName,T)&&(Y.closed=!0,t.nbsp||i.warning("unclosed xml attribute")),p&&Oe){for(var ot=$w(p,{}),Ye=0;Ye<Oe;Ye++){var He=Y[Ye];c(He.offset),He.locator=$w(p,{})}r.locator=ot,jw(Y,r,Z)&&C.push(Y),r.locator=p}else jw(Y,r,Z)&&C.push(Y);Y.uri==="http://www.w3.org/1999/xhtml"&&!Y.closed?b=xx(n,b,Y.tagName,o,r):b++}}catch(de){if(de instanceof cs)throw de;i.error("element parse error: "+de),b=-1}b>y?y=b:a(Math.max(R,y)+1)}}function $w(n,e){return e.lineNumber=n.lineNumber,e.columnNumber=n.columnNumber,e}function Ex(n,e,t,r,i,s){function o(C,T,y){C in t.attributeNames&&s.fatalError("Attribute "+C+" redefined"),t.addValue(C,T,y)}for(var a,c,u=++e,l=To;;){var h=n.charAt(u);switch(h){case"=":if(l===zr)a=n.slice(e,u),l=Ro;else if(l===ss)l=Ro;else throw new Error("attribute equal must after attrName");break;case"'":case'"':if(l===Ro||l===zr)if(l===zr&&(s.warning('attribute value must after "="'),a=n.slice(e,u)),e=u+1,u=n.indexOf(h,e),u>0)c=n.slice(e,u).replace(/&#?\w+;/g,i),o(a,c,e-1),l=as;else throw new Error("attribute value no end '"+h+"' match");else if(l==os)c=n.slice(e,u).replace(/&#?\w+;/g,i),o(a,c,e),s.warning('attribute "'+a+'" missed start quot('+h+")!!"),e=u+1,l=as;else throw new Error('attribute value must after "="');break;case"/":switch(l){case To:t.setTagName(n.slice(e,u));case as:case So:case Tc:l=Tc,t.closed=!0;case os:case zr:case ss:break;default:throw new Error("attribute invalid close char('/')")}break;case"":return s.error("unexpected end of input"),l==To&&t.setTagName(n.slice(e,u)),u;case">":switch(l){case To:t.setTagName(n.slice(e,u));case as:case So:case Tc:break;case os:case zr:c=n.slice(e,u),c.slice(-1)==="/"&&(t.closed=!0,c=c.slice(0,-1));case ss:l===ss&&(c=a),l==os?(s.warning('attribute "'+c+'" missed quot(")!'),o(a,c.replace(/&#?\w+;/g,i),e)):((r[""]!=="http://www.w3.org/1999/xhtml"||!c.match(/^(?:disabled|checked|selected)$/i))&&s.warning('attribute "'+c+'" missed value!! "'+c+'" instead!!'),o(c,c,e));break;case Ro:throw new Error("attribute value missed!!")}return u;case"\x80":h=" ";default:if(h<=" ")switch(l){case To:t.setTagName(n.slice(e,u)),l=So;break;case zr:a=n.slice(e,u),l=ss;break;case os:var c=n.slice(e,u).replace(/&#?\w+;/g,i);s.warning('attribute "'+c+'" missed quot(")!!'),o(a,c,e);case as:l=So;break}else switch(l){case ss:var p=t.tagName;(r[""]!=="http://www.w3.org/1999/xhtml"||!a.match(/^(?:disabled|checked|selected)$/i))&&s.warning('attribute "'+a+'" missed value!! "'+a+'" instead2!!'),o(a,a,e),e=u,l=zr;break;case as:s.warning('attribute space is required"'+a+'"!!');case So:l=zr,e=u;break;case Ro:l=os,e=u;break;case Tc:throw new Error("elements closed character '/' and '>' must be connected to")}}u++}}function jw(n,e,t){for(var r=n.tagName,i=null,s=n.length;s--;){var o=n[s],a=o.qName,c=o.value,p=a.indexOf(":");if(p>0)var u=o.prefix=a.slice(0,p),l=a.slice(p+1),h=u==="xmlns"&&l;else l=a,u=null,h=a==="xmlns"&&"";o.localName=l,h!==!1&&(i==null&&(i={},Ww(t,t={})),t[h]=i[h]=c,o.uri="http://www.w3.org/2000/xmlns/",e.startPrefixMapping(h,c))}for(var s=n.length;s--;){o=n[s];var u=o.prefix;u&&(u==="xml"&&(o.uri="http://www.w3.org/XML/1998/namespace"),u!=="xmlns"&&(o.uri=t[u||""]))}var p=r.indexOf(":");p>0?(u=n.prefix=r.slice(0,p),l=n.localName=r.slice(p+1)):(u=null,l=n.localName=r);var C=n.uri=t[u||""];if(e.startElement(C,l,r,n),n.closed){if(e.endElement(C,l,r),i)for(u in i)e.endPrefixMapping(u)}else return n.currentNSMap=t,n.localNSMap=i,!0}function xx(n,e,t,r,i){if(/^(?:script|textarea)$/i.test(t)){var s=n.indexOf("</"+t+">",e),o=n.substring(e+1,s);if(/[&<]/.test(o))return/^script$/i.test(t)?(i.characters(o,0,o.length),s):(o=o.replace(/&#?\w+;/g,r),i.characters(o,0,o.length),s)}return e+1}function qx(n,e,t,r){var i=r[t];return i==null&&(i=n.lastIndexOf("</"+t+">"),i<e&&(i=n.lastIndexOf("</"+t)),r[t]=i),i<e}function Ww(n,e){for(var t in n)e[t]=n[t]}function Ix(n,e,t,r){var i=n.charAt(e+2);switch(i){case"-":if(n.charAt(e+3)==="-"){var s=n.indexOf("-->",e+4);return s>e?(t.comment(n,e+4,s-e-4),s+3):(r.error("Unclosed comment"),-1)}else return-1;default:if(n.substr(e+3,6)=="CDATA["){var s=n.indexOf("]]>",e+9);return t.startCDATA(),t.characters(n,e+9,s-e-9),t.endCDATA(),s+3}var o=Nx(n,e),a=o.length;if(a>1&&/!doctype/i.test(o[0][0])){var c=o[1][0],u=!1,l=!1;a>3&&(/^public$/i.test(o[2][0])?(u=o[3][0],l=a>4&&o[4][0]):/^system$/i.test(o[2][0])&&(l=o[3][0]));var h=o[a-1];return t.startDTD(c,u,l),t.endDTD(),h.index+h[0].length}}return-1}function Fx(n,e,t){var r=n.indexOf("?>",e);if(r){var i=n.substring(e,r).match(/^<\?(\S*)\s*([\s\S]*?)\s*$/);if(i){var s=i[0].length;return t.processingInstruction(i[1],i[2]),r+2}else return-1}return-1}function Hw(){this.attributeNames={}}Hw.prototype={setTagName:function(n){if(!Aw.test(n))throw new Error("invalid tagName:"+n);this.tagName=n},addValue:function(n,e,t){if(!Aw.test(n))throw new Error("invalid attribute:"+n);this.attributeNames[n]=this.length,this[this.length++]={qName:n,value:e,offset:t}},length:0,getLocalName:function(n){return this[n].localName},getLocator:function(n){return this[n].locator},getQName:function(n){return this[n].qName},getURI:function(n){return this[n].uri},getValue:function(n){return this[n].value}};function Nx(n,e){var t,r=[],i=/'[^']+'|"[^"]+"|[^\s<>\/=]+=?|(\/?\s*>|<)/g;for(i.lastIndex=e,i.exec(n);t=i.exec(n);)if(r.push(t),t[1])return r}Rd.XMLReader=Mw;Rd.ParseError=cs});var Nd=F(xo=>{function _o(n,e){for(var t in n)e[t]=n[t]}function Jt(n,e){var t=n.prototype;if(!(t instanceof e)){let i=function(){};var r=i;i.prototype=e.prototype,i=new i,_o(t,i),n.prototype=t=i}t.constructor!=n&&(typeof n!="function"&&console.error("unknow Class:"+n),t.constructor=n)}var Ox="http://www.w3.org/1999/xhtml",Zt={},Un=Zt.ELEMENT_NODE=1,us=Zt.ATTRIBUTE_NODE=2,Rc=Zt.TEXT_NODE=3,Kw=Zt.CDATA_SECTION_NODE=4,zw=Zt.ENTITY_REFERENCE_NODE=5,Lx=Zt.ENTITY_NODE=6,Vw=Zt.PROCESSING_INSTRUCTION_NODE=7,Xw=Zt.COMMENT_NODE=8,Bw=Zt.DOCUMENT_NODE=9,Gw=Zt.DOCUMENT_TYPE_NODE=10,br=Zt.DOCUMENT_FRAGMENT_NODE=11,Ax=Zt.NOTATION_NODE=12,Lt={},Dt={},k0=Lt.INDEX_SIZE_ERR=(Dt[1]="Index size error",1),E0=Lt.DOMSTRING_SIZE_ERR=(Dt[2]="DOMString size error",2),Mx=Lt.HIERARCHY_REQUEST_ERR=(Dt[3]="Hierarchy request error",3),x0=Lt.WRONG_DOCUMENT_ERR=(Dt[4]="Wrong document",4),q0=Lt.INVALID_CHARACTER_ERR=(Dt[5]="Invalid character",5),I0=Lt.NO_DATA_ALLOWED_ERR=(Dt[6]="No data allowed",6),F0=Lt.NO_MODIFICATION_ALLOWED_ERR=(Dt[7]="No modification allowed",7),$x=Lt.NOT_FOUND_ERR=(Dt[8]="Not found",8),N0=Lt.NOT_SUPPORTED_ERR=(Dt[9]="Not supported",9),Qw=Lt.INUSE_ATTRIBUTE_ERR=(Dt[10]="Attribute in use",10),O0=Lt.INVALID_STATE_ERR=(Dt[11]="Invalid state",11),L0=Lt.SYNTAX_ERR=(Dt[12]="Syntax error",12),A0=Lt.INVALID_MODIFICATION_ERR=(Dt[13]="Invalid modification",13),M0=Lt.NAMESPACE_ERR=(Dt[14]="Invalid namespace",14),$0=Lt.INVALID_ACCESS_ERR=(Dt[15]="Invalid access",15);function Ci(n,e){if(e instanceof Error)var t=e;else t=this,Error.call(this,Dt[n]),this.message=Dt[n],Error.captureStackTrace&&Error.captureStackTrace(this,Ci);return t.code=n,e&&(this.message=this.message+": "+e),t}Ci.prototype=Error.prototype;_o(Lt,Ci);function Vr(){}Vr.prototype={length:0,item:function(n){return this[n]||null},toString:function(n,e){for(var t=[],r=0;r<this.length;r++)fs(this[r],t,n,e);return t.join("")}};function ls(n,e){this._node=n,this._refresh=e,Sd(this)}function Sd(n){var e=n._node._inc||n._node.ownerDocument._inc;if(n._inc!=e){var t=n._refresh(n._node);dC(n,"length",t.length),_o(t,n),n._inc=e}}ls.prototype.item=function(n){return Sd(this),this[n]};Jt(ls,Vr);function Sc(){}function Yw(n,e){for(var t=n.length;t--;)if(n[t]===e)return t}function Jw(n,e,t,r){if(r?e[Yw(e,r)]=t:e[e.length++]=t,n){t.ownerElement=n;var i=n.ownerDocument;i&&(r&&nC(i,n,r),jx(i,n,t))}}function Zw(n,e,t){var r=Yw(e,t);if(r>=0){for(var i=e.length-1;r<i;)e[r]=e[++r];if(e.length=i,n){var s=n.ownerDocument;s&&(nC(s,n,t),t.ownerElement=null)}}else throw Ci($x,new Error(n.tagName+"@"+t))}Sc.prototype={length:0,item:Vr.prototype.item,getNamedItem:function(n){for(var e=this.length;e--;){var t=this[e];if(t.nodeName==n)return t}},setNamedItem:function(n){var e=n.ownerElement;if(e&&e!=this._ownerElement)throw new Ci(Qw);var t=this.getNamedItem(n.nodeName);return Jw(this._ownerElement,this,n,t),t},setNamedItemNS:function(n){var e=n.ownerElement,t;if(e&&e!=this._ownerElement)throw new Ci(Qw);return t=this.getNamedItemNS(n.namespaceURI,n.localName),Jw(this._ownerElement,this,n,t),t},removeNamedItem:function(n){var e=this.getNamedItem(n);return Zw(this._ownerElement,this,e),e},removeNamedItemNS:function(n,e){var t=this.getNamedItemNS(n,e);return Zw(this._ownerElement,this,t),t},getNamedItemNS:function(n,e){for(var t=this.length;t--;){var r=this[t];if(r.localName==e&&r.namespaceURI==n)return r}return null}};function eC(n){if(this._features={},n)for(var e in n)this._features=n[e]}eC.prototype={hasFeature:function(n,e){var t=this._features[n.toLowerCase()];return!!(t&&(!e||e in t))},createDocument:function(n,e,t){var r=new ko;if(r.implementation=this,r.childNodes=new Vr,r.doctype=t,t&&r.appendChild(t),e){var i=r.createElementNS(n,e);r.appendChild(i)}return r},createDocumentType:function(n,e,t){var r=new xd;return r.name=n,r.nodeName=n,r.publicId=e,r.systemId=t,r}};function At(){}At.prototype={firstChild:null,lastChild:null,previousSibling:null,nextSibling:null,attributes:null,parentNode:null,childNodes:null,ownerDocument:null,nodeValue:null,namespaceURI:null,prefix:null,localName:null,insertBefore:function(n,e){return iC(this,n,e)},replaceChild:function(n,e){this.insertBefore(n,e),e&&this.removeChild(e)},removeChild:function(n){return rC(this,n)},appendChild:function(n){return this.insertBefore(n,null)},hasChildNodes:function(){return this.firstChild!=null},cloneNode:function(n){return Fd(this.ownerDocument||this,this,n)},normalize:function(){for(var n=this.firstChild;n;){var e=n.nextSibling;e&&e.nodeType==Rc&&n.nodeType==Rc?(this.removeChild(e),n.appendData(e.data)):(n.normalize(),n=e)}},isSupported:function(n,e){return this.ownerDocument.implementation.hasFeature(n,e)},hasAttributes:function(){return this.attributes.length>0},lookupPrefix:function(n){for(var e=this;e;){var t=e._nsMap;if(t){for(var r in t)if(t[r]==n)return r}e=e.nodeType==us?e.ownerDocument:e.parentNode}return null},lookupNamespaceURI:function(n){for(var e=this;e;){var t=e._nsMap;if(t&&n in t)return t[n];e=e.nodeType==us?e.ownerDocument:e.parentNode}return null},isDefaultNamespace:function(n){var e=this.lookupPrefix(n);return e==null}};function tC(n){return n=="<"&&"&lt;"||n==">"&&"&gt;"||n=="&"&&"&amp;"||n=='"'&&"&quot;"||"&#"+n.charCodeAt()+";"}_o(Zt,At);_o(Zt,At.prototype);function Po(n,e){if(e(n))return!0;if(n=n.firstChild)do if(Po(n,e))return!0;while(n=n.nextSibling)}function ko(){}function jx(n,e,t){n&&n._inc++;var r=t.namespaceURI;r=="http://www.w3.org/2000/xmlns/"&&(e._nsMap[t.prefix?t.localName:""]=t.value)}function nC(n,e,t,r){n&&n._inc++;var i=t.namespaceURI;i=="http://www.w3.org/2000/xmlns/"&&delete e._nsMap[t.prefix?t.localName:""]}function _d(n,e,t){if(n&&n._inc){n._inc++;var r=e.childNodes;if(t)r[r.length++]=t;else{for(var i=e.firstChild,s=0;i;)r[s++]=i,i=i.nextSibling;r.length=s}}}function rC(n,e){var t=e.previousSibling,r=e.nextSibling;return t?t.nextSibling=r:n.firstChild=r,r?r.previousSibling=t:n.lastChild=t,_d(n.ownerDocument,n),e}function iC(n,e,t){var r=e.parentNode;if(r&&r.removeChild(e),e.nodeType===br){var i=e.firstChild;if(i==null)return e;var s=e.lastChild}else i=s=e;var o=t?t.previousSibling:n.lastChild;i.previousSibling=o,s.nextSibling=t,o?o.nextSibling=i:n.firstChild=i,t==null?n.lastChild=s:t.previousSibling=s;do i.parentNode=n;while(i!==s&&(i=i.nextSibling));return _d(n.ownerDocument||n,n),e.nodeType==br&&(e.firstChild=e.lastChild=null),e}function Wx(n,e){var t=e.parentNode;if(t){var r=n.lastChild;t.removeChild(e);var r=n.lastChild}var r=n.lastChild;return e.parentNode=n,e.previousSibling=r,e.nextSibling=null,r?r.nextSibling=e:n.firstChild=e,n.lastChild=e,_d(n.ownerDocument,n,e),e}ko.prototype={nodeName:"#document",nodeType:Bw,doctype:null,documentElement:null,_inc:1,insertBefore:function(n,e){if(n.nodeType==br){for(var t=n.firstChild;t;){var r=t.nextSibling;this.insertBefore(t,e),t=r}return n}return this.documentElement==null&&n.nodeType==Un&&(this.documentElement=n),iC(this,n,e),n.ownerDocument=this,n},removeChild:function(n){return this.documentElement==n&&(this.documentElement=null),rC(this,n)},importNode:function(n,e){return lC(this,n,e)},getElementById:function(n){var e=null;return Po(this.documentElement,function(t){if(t.nodeType==Un&&t.getAttribute("id")==n)return e=t,!0}),e},getElementsByClassName:function(n){var e=new RegExp("(^|\\s)"+n+"(\\s|$)");return new ls(this,function(t){var r=[];return Po(t.documentElement,function(i){i!==t&&i.nodeType==Un&&e.test(i.getAttribute("class"))&&r.push(i)}),r})},createElement:function(n){var e=new ds;e.ownerDocument=this,e.nodeName=n,e.tagName=n,e.childNodes=new Vr;var t=e.attributes=new Sc;return t._ownerElement=e,e},createDocumentFragment:function(){var n=new Pc;return n.ownerDocument=this,n.childNodes=new Vr,n},createTextNode:function(n){var e=new Pd;return e.ownerDocument=this,e.appendData(n),e},createComment:function(n){var e=new kd;return e.ownerDocument=this,e.appendData(n),e},createCDATASection:function(n){var e=new Ed;return e.ownerDocument=this,e.appendData(n),e},createProcessingInstruction:function(n,e){var t=new Id;return t.ownerDocument=this,t.tagName=t.target=n,t.nodeValue=t.data=e,t},createAttribute:function(n){var e=new _c;return e.ownerDocument=this,e.name=n,e.nodeName=n,e.localName=n,e.specified=!0,e},createEntityReference:function(n){var e=new qd;return e.ownerDocument=this,e.nodeName=n,e},createElementNS:function(n,e){var t=new ds,r=e.split(":"),i=t.attributes=new Sc;return t.childNodes=new Vr,t.ownerDocument=this,t.nodeName=e,t.tagName=e,t.namespaceURI=n,r.length==2?(t.prefix=r[0],t.localName=r[1]):t.localName=e,i._ownerElement=t,t},createAttributeNS:function(n,e){var t=new _c,r=e.split(":");return t.ownerDocument=this,t.nodeName=e,t.name=e,t.namespaceURI=n,t.specified=!0,r.length==2?(t.prefix=r[0],t.localName=r[1]):t.localName=e,t}};Jt(ko,At);function ds(){this._nsMap={}}ds.prototype={nodeType:Un,hasAttribute:function(n){return this.getAttributeNode(n)!=null},getAttribute:function(n){var e=this.getAttributeNode(n);return e&&e.value||""},getAttributeNode:function(n){return this.attributes.getNamedItem(n)},setAttribute:function(n,e){var t=this.ownerDocument.createAttribute(n);t.value=t.nodeValue=""+e,this.setAttributeNode(t)},removeAttribute:function(n){var e=this.getAttributeNode(n);e&&this.removeAttributeNode(e)},appendChild:function(n){return n.nodeType===br?this.insertBefore(n,null):Wx(this,n)},setAttributeNode:function(n){return this.attributes.setNamedItem(n)},setAttributeNodeNS:function(n){return this.attributes.setNamedItemNS(n)},removeAttributeNode:function(n){return this.attributes.removeNamedItem(n.nodeName)},removeAttributeNS:function(n,e){var t=this.getAttributeNodeNS(n,e);t&&this.removeAttributeNode(t)},hasAttributeNS:function(n,e){return this.getAttributeNodeNS(n,e)!=null},getAttributeNS:function(n,e){var t=this.getAttributeNodeNS(n,e);return t&&t.value||""},setAttributeNS:function(n,e,t){var r=this.ownerDocument.createAttributeNS(n,e);r.value=r.nodeValue=""+t,this.setAttributeNode(r)},getAttributeNodeNS:function(n,e){return this.attributes.getNamedItemNS(n,e)},getElementsByTagName:function(n){return new ls(this,function(e){var t=[];return Po(e,function(r){r!==e&&r.nodeType==Un&&(n==="*"||r.tagName==n)&&t.push(r)}),t})},getElementsByTagNameNS:function(n,e){return new ls(this,function(t){var r=[];return Po(t,function(i){i!==t&&i.nodeType===Un&&(n==="*"||i.namespaceURI===n)&&(e==="*"||i.localName==e)&&r.push(i)}),r})}};ko.prototype.getElementsByTagName=ds.prototype.getElementsByTagName;ko.prototype.getElementsByTagNameNS=ds.prototype.getElementsByTagNameNS;Jt(ds,At);function _c(){}_c.prototype.nodeType=us;Jt(_c,At);function Eo(){}Eo.prototype={data:"",substringData:function(n,e){return this.data.substring(n,n+e)},appendData:function(n){n=this.data+n,this.nodeValue=this.data=n,this.length=n.length},insertData:function(n,e){this.replaceData(n,0,e)},appendChild:function(n){throw new Error(Dt[Mx])},deleteData:function(n,e){this.replaceData(n,e,"")},replaceData:function(n,e,t){var r=this.data.substring(0,n),i=this.data.substring(n+e);t=r+t+i,this.nodeValue=this.data=t,this.length=t.length}};Jt(Eo,At);function Pd(){}Pd.prototype={nodeName:"#text",nodeType:Rc,splitText:function(n){var e=this.data,t=e.substring(n);e=e.substring(0,n),this.data=this.nodeValue=e,this.length=e.length;var r=this.ownerDocument.createTextNode(t);return this.parentNode&&this.parentNode.insertBefore(r,this.nextSibling),r}};Jt(Pd,Eo);function kd(){}kd.prototype={nodeName:"#comment",nodeType:Xw};Jt(kd,Eo);function Ed(){}Ed.prototype={nodeName:"#cdata-section",nodeType:Kw};Jt(Ed,Eo);function xd(){}xd.prototype.nodeType=Gw;Jt(xd,At);function sC(){}sC.prototype.nodeType=Ax;Jt(sC,At);function oC(){}oC.prototype.nodeType=Lx;Jt(oC,At);function qd(){}qd.prototype.nodeType=zw;Jt(qd,At);function Pc(){}Pc.prototype.nodeName="#document-fragment";Pc.prototype.nodeType=br;Jt(Pc,At);function Id(){}Id.prototype.nodeType=Vw;Jt(Id,At);function aC(){}aC.prototype.serializeToString=function(n,e,t){return cC.call(n,e,t)};At.prototype.toString=cC;function cC(n,e){var t=[],r=this.nodeType==9&&this.documentElement||this,i=r.prefix,s=r.namespaceURI;if(s&&i==null){var i=r.lookupPrefix(s);if(i==null)var o=[{namespace:s,prefix:null}]}return fs(this,t,n,e,o),t.join("")}function uC(n,e,t){var r=n.prefix||"",i=n.namespaceURI;if(!r&&!i||r==="xml"&&i==="http://www.w3.org/XML/1998/namespace"||i=="http://www.w3.org/2000/xmlns/")return!1;for(var s=t.length;s--;){var o=t[s];if(o.prefix==r)return o.namespace!=i}return!0}function fs(n,e,t,r,i){if(r)if(n=r(n),n){if(typeof n=="string"){e.push(n);return}}else return;switch(n.nodeType){case Un:i||(i=[]);var s=i.length,o=n.attributes,a=o.length,c=n.firstChild,u=n.tagName;t=Ox===n.namespaceURI||t,e.push("<",u);for(var l=0;l<a;l++){var h=o.item(l);h.prefix=="xmlns"?i.push({prefix:h.localName,namespace:h.value}):h.nodeName=="xmlns"&&i.push({prefix:"",namespace:h.value})}for(var l=0;l<a;l++){var h=o.item(l);if(uC(h,t,i)){var p=h.prefix||"",C=h.namespaceURI,T=p?" xmlns:"+p:" xmlns";e.push(T,'="',C,'"'),i.push({prefix:p,namespace:C})}fs(h,e,t,r,i)}if(uC(n,t,i)){var p=n.prefix||"",C=n.namespaceURI;if(C){var T=p?" xmlns:"+p:" xmlns";e.push(T,'="',C,'"'),i.push({prefix:p,namespace:C})}}if(c||t&&!/^(?:meta|link|img|br|hr|input)$/i.test(u)){if(e.push(">"),t&&/^script$/i.test(u))for(;c;)c.data?e.push(c.data):fs(c,e,t,r,i),c=c.nextSibling;else for(;c;)fs(c,e,t,r,i),c=c.nextSibling;e.push("</",u,">")}else e.push("/>");return;case Bw:case br:for(var c=n.firstChild;c;)fs(c,e,t,r,i),c=c.nextSibling;return;case us:return e.push(" ",n.name,'="',n.value.replace(/[<&"]/g,tC),'"');case Rc:return e.push(n.data.replace(/[<&]/g,tC).replace(/]]>/g,"]]&gt;"));case Kw:return e.push("<![CDATA[",n.data,"]]>");case Xw:return e.push("<!--",n.data,"-->");case Gw:var y=n.publicId,R=n.systemId;if(e.push("<!DOCTYPE ",n.name),y)e.push(" PUBLIC ",y),R&&R!="."&&e.push(" ",R),e.push(">");else if(R&&R!=".")e.push(" SYSTEM ",R,">");else{var S=n.internalSubset;S&&e.push(" [",S,"]"),e.push(">")}return;case Vw:return e.push("<?",n.target," ",n.data,"?>");case zw:return e.push("&",n.nodeName,";");default:e.push("??",n.nodeName)}}function lC(n,e,t){var r;switch(e.nodeType){case Un:r=e.cloneNode(!1),r.ownerDocument=n;case br:break;case us:t=!0;break}if(r||(r=e.cloneNode(!1)),r.ownerDocument=n,r.parentNode=null,t)for(var i=e.firstChild;i;)r.appendChild(lC(n,i,t)),i=i.nextSibling;return r}function Fd(n,e,t){var r=new e.constructor;for(var i in e){var s=e[i];typeof s!="object"&&s!=r[i]&&(r[i]=s)}switch(e.childNodes&&(r.childNodes=new Vr),r.ownerDocument=n,r.nodeType){case Un:var o=e.attributes,a=r.attributes=new Sc,c=o.length;a._ownerElement=r;for(var u=0;u<c;u++)r.setAttributeNode(Fd(n,o.item(u),!0));break;case us:t=!0}if(t)for(var l=e.firstChild;l;)r.appendChild(Fd(n,l,t)),l=l.nextSibling;return r}function dC(n,e,t){n[e]=t}try{if(Object.defineProperty){let n=function(e){switch(e.nodeType){case Un:case br:var t=[];for(e=e.firstChild;e;)e.nodeType!==7&&e.nodeType!==8&&t.push(n(e)),e=e.nextSibling;return t.join("");default:return e.nodeValue}};j0=n,Object.defineProperty(ls.prototype,"length",{get:function(){return Sd(this),this.$$length}}),Object.defineProperty(At.prototype,"textContent",{get:function(){return n(this)},set:function(e){switch(this.nodeType){case Un:case br:for(;this.firstChild;)this.removeChild(this.firstChild);(e||String(e))&&this.appendChild(this.ownerDocument.createTextNode(e));break;default:this.data=e,this.value=e,this.nodeValue=e}}}),dC=function(e,t,r){e["$$"+t]=r}}}catch{}var j0;xo.Node=At;xo.DOMException=Ci;xo.DOMImplementation=eC;xo.XMLSerializer=aC});var gC=F(Io=>{function fC(n){this.options=n||{locator:{}}}fC.prototype.parseFromString=function(n,e){var t=this.options,r=new Kx,i=t.domBuilder||new qo,s=t.errorHandler,o=t.locator,a=t.xmlns||{},c=/\/x?html?$/.test(e),u=c?Ux.entityMap:{lt:"<",gt:">",amp:"&",quot:'"',apos:"'"};return o&&i.setDocumentLocator(o),r.errorHandler=Hx(s,i,o),r.domBuilder=t.domBuilder||i,c&&(a[""]="http://www.w3.org/1999/xhtml"),a.xml=a.xml||"http://www.w3.org/XML/1998/namespace",n&&typeof n=="string"?r.parse(n,a,u):r.errorHandler.error("invalid doc source"),i.doc};function Hx(n,e,t){if(!n){if(e instanceof qo)return e;n=e}var r={},i=n instanceof Function;t=t||{};function s(o){var a=n[o];!a&&i&&(a=n.length==2?function(c){n(o,c)}:n),r[o]=a&&function(c){a("[xmldom "+o+"]	"+c+Od(t))}||function(){}}return s("warning"),s("error"),s("fatalError"),r}function qo(){this.cdata=!1}function hs(n,e){e.lineNumber=n.lineNumber,e.columnNumber=n.columnNumber}qo.prototype={startDocument:function(){this.doc=new Vx().createDocument(null,null,null),this.locator&&(this.doc.documentURI=this.locator.systemId)},startElement:function(n,e,t,r){var i=this.doc,s=i.createElementNS(n,t||e),o=r.length;kc(this,s),this.currentElement=s,this.locator&&hs(this.locator,s);for(var a=0;a<o;a++){var n=r.getURI(a),c=r.getValue(a),t=r.getQName(a),u=i.createAttributeNS(n,t);this.locator&&hs(r.getLocator(a),u),u.value=u.nodeValue=c,s.setAttributeNode(u)}},endElement:function(n,e,t){var r=this.currentElement,i=r.tagName;this.currentElement=r.parentNode},startPrefixMapping:function(n,e){},endPrefixMapping:function(n){},processingInstruction:function(n,e){var t=this.doc.createProcessingInstruction(n,e);this.locator&&hs(this.locator,t),kc(this,t)},ignorableWhitespace:function(n,e,t){},characters:function(n,e,t){if(n=hC.apply(this,arguments),n){if(this.cdata)var r=this.doc.createCDATASection(n);else var r=this.doc.createTextNode(n);this.currentElement?this.currentElement.appendChild(r):/^\s*$/.test(n)&&this.doc.appendChild(r),this.locator&&hs(this.locator,r)}},skippedEntity:function(n){},endDocument:function(){this.doc.normalize()},setDocumentLocator:function(n){(this.locator=n)&&(n.lineNumber=0)},comment:function(n,e,t){n=hC.apply(this,arguments);var r=this.doc.createComment(n);this.locator&&hs(this.locator,r),kc(this,r)},startCDATA:function(){this.cdata=!0},endCDATA:function(){this.cdata=!1},startDTD:function(n,e,t){var r=this.doc.implementation;if(r&&r.createDocumentType){var i=r.createDocumentType(n,e,t);this.locator&&hs(this.locator,i),kc(this,i)}},warning:function(n){console.warn("[xmldom warning]	"+n,Od(this.locator))},error:function(n){console.error("[xmldom error]	"+n,Od(this.locator))},fatalError:function(n){throw new zx(n,this.locator)}};function Od(n){if(n)return`
@`+(n.systemId||"")+"#[line:"+n.lineNumber+",col:"+n.columnNumber+"]"}function hC(n,e,t){return typeof n=="string"?n.substr(e,t):n.length>=e+t||e?new java.lang.String(n,e,t)+"":n}"endDTD,startEntity,endEntity,attributeDecl,elementDecl,externalEntityDecl,internalEntityDecl,resolveEntity,getExternalSubset,notationDecl,unparsedEntityDecl".replace(/\w+/g,function(n){qo.prototype[n]=function(){return null}});function kc(n,e){n.currentElement?n.currentElement.appendChild(e):n.doc.appendChild(e)}var Ux=Ow(),pC=Uw(),Kx=pC.XMLReader,zx=pC.ParseError,Vx=Io.DOMImplementation=Nd().DOMImplementation;Io.XMLSerializer=Nd().XMLSerializer;Io.DOMParser=fC;Io.__DOMHandler=qo});var yC=F(vC=>{var Xx=gC().DOMParser;vC.parse=Gx;var Ec=3,mC=4,Bx=8;function Ld(n){return n.nodeType===Ec||n.nodeType===Bx||n.nodeType===mC}function Dr(n){return!n.childNodes||n.childNodes.length===0}function bi(n,e){if(!n)throw new Error(e)}function Gx(n){var e=new Xx().parseFromString(n);bi(e.documentElement.nodeName==="plist","malformed document. First element should be <plist>");var t=ps(e.documentElement);return t.length==1&&(t=t[0]),t}function ps(n){var e,t,r,i,s,o,a,c;if(!n)return null;if(n.nodeName==="plist"){if(s=[],Dr(n))return s;for(e=0;e<n.childNodes.length;e++)Ld(n.childNodes[e])||s.push(ps(n.childNodes[e]));return s}else if(n.nodeName==="dict"){if(t={},r=null,a=0,Dr(n))return t;for(e=0;e<n.childNodes.length;e++)Ld(n.childNodes[e])||(a%2==0?(bi(n.childNodes[e].nodeName==="key","Missing key while parsing <dict/>."),r=ps(n.childNodes[e])):(bi(n.childNodes[e].nodeName!=="key",'Unexpected key "'+ps(n.childNodes[e])+'" while parsing <dict/>.'),t[r]=ps(n.childNodes[e])),a+=1);if(a%2==1)throw new Error('Missing value for "'+r+'" while parsing <dict/>');return t}else if(n.nodeName==="array"){if(s=[],Dr(n))return s;for(e=0;e<n.childNodes.length;e++)Ld(n.childNodes[e])||(o=ps(n.childNodes[e]),o!=null&&s.push(o));return s}else if(n.nodeName!=="#text"){if(n.nodeName==="key")return Dr(n)?"":(bi(n.childNodes[0].nodeValue!=="__proto__","__proto__ keys can lead to prototype pollution. More details on CVE-2022-22912"),n.childNodes[0].nodeValue);if(n.nodeName==="string"){if(o="",Dr(n))return o;for(e=0;e<n.childNodes.length;e++){var c=n.childNodes[e].nodeType;(c===Ec||c===mC)&&(o+=n.childNodes[e].nodeValue)}return o}else{if(n.nodeName==="integer")return bi(!Dr(n),'Cannot parse "" as integer.'),parseInt(n.childNodes[0].nodeValue,10);if(n.nodeName==="real"){for(bi(!Dr(n),'Cannot parse "" as real.'),o="",e=0;e<n.childNodes.length;e++)n.childNodes[e].nodeType===Ec&&(o+=n.childNodes[e].nodeValue);return parseFloat(o)}else if(n.nodeName==="data"){if(o="",Dr(n))return Buffer.from(o,"base64");for(e=0;e<n.childNodes.length;e++)n.childNodes[e].nodeType===Ec&&(o+=n.childNodes[e].nodeValue.replace(/\s+/g,""));return Buffer.from(o,"base64")}else{if(n.nodeName==="date")return bi(!Dr(n),'Cannot parse "" as Date.'),new Date(n.childNodes[0].nodeValue);if(n.nodeName==="true")return!0;if(n.nodeName==="false")return!1}}}}});var bC=F(xc=>{"use strict";xc.byteLength=Yx;xc.toByteArray=Zx;xc.fromByteArray=nq;var nr=[],Pn=[],Qx=typeof Uint8Array!="undefined"?Uint8Array:Array,Ad="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(Di=0,wC=Ad.length;Di<wC;++Di)nr[Di]=Ad[Di],Pn[Ad.charCodeAt(Di)]=Di;var Di,wC;Pn["-".charCodeAt(0)]=62;Pn["_".charCodeAt(0)]=63;function CC(n){var e=n.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var t=n.indexOf("=");t===-1&&(t=e);var r=t===e?0:4-t%4;return[t,r]}function Yx(n){var e=CC(n),t=e[0],r=e[1];return(t+r)*3/4-r}function Jx(n,e,t){return(e+t)*3/4-t}function Zx(n){var e,t=CC(n),r=t[0],i=t[1],s=new Qx(Jx(n,r,i)),o=0,a=i>0?r-4:r,c;for(c=0;c<a;c+=4)e=Pn[n.charCodeAt(c)]<<18|Pn[n.charCodeAt(c+1)]<<12|Pn[n.charCodeAt(c+2)]<<6|Pn[n.charCodeAt(c+3)],s[o++]=e>>16&255,s[o++]=e>>8&255,s[o++]=e&255;return i===2&&(e=Pn[n.charCodeAt(c)]<<2|Pn[n.charCodeAt(c+1)]>>4,s[o++]=e&255),i===1&&(e=Pn[n.charCodeAt(c)]<<10|Pn[n.charCodeAt(c+1)]<<4|Pn[n.charCodeAt(c+2)]>>2,s[o++]=e>>8&255,s[o++]=e&255),s}function eq(n){return nr[n>>18&63]+nr[n>>12&63]+nr[n>>6&63]+nr[n&63]}function tq(n,e,t){for(var r,i=[],s=e;s<t;s+=3)r=(n[s]<<16&16711680)+(n[s+1]<<8&65280)+(n[s+2]&255),i.push(eq(r));return i.join("")}function nq(n){for(var e,t=n.length,r=t%3,i=[],s=16383,o=0,a=t-r;o<a;o+=s)i.push(tq(n,o,o+s>a?a:o+s));return r===1?(e=n[t-1],i.push(nr[e>>2]+nr[e<<4&63]+"==")):r===2&&(e=(n[t-2]<<8)+n[t-1],i.push(nr[e>>10]+nr[e>>4&63]+nr[e<<2&63]+"=")),i.join("")}});var Tr=F((DC,Ti)=>{(function(){var n,e,t,r,i,s,o=[].slice,a={}.hasOwnProperty;n=function(){var c,u,l,h,p,C;if(C=arguments[0],p=2<=arguments.length?o.call(arguments,1):[],r(Object.assign))Object.assign.apply(null,arguments);else for(c=0,l=p.length;c<l;c++)if(h=p[c],h!=null)for(u in h)!a.call(h,u)||(C[u]=h[u]);return C},r=function(c){return!!c&&Object.prototype.toString.call(c)==="[object Function]"},i=function(c){var u;return!!c&&((u=typeof c)==="function"||u==="object")},e=function(c){return r(Array.isArray)?Array.isArray(c):Object.prototype.toString.call(c)==="[object Array]"},t=function(c){var u;if(e(c))return!c.length;for(u in c)if(!!a.call(c,u))return!1;return!0},s=function(c){var u,l;return i(c)&&(l=Object.getPrototypeOf(c))&&(u=l.constructor)&&typeof u=="function"&&u instanceof u&&Function.prototype.toString.call(u)===Function.prototype.toString.call(Object)},Ti.exports.assign=n,Ti.exports.isFunction=r,Ti.exports.isObject=i,Ti.exports.isArray=e,Ti.exports.isEmpty=t,Ti.exports.isPlainObject=s}).call(DC)});var Md=F((TC,RC)=>{(function(){var n;RC.exports=n=function(){function e(t,r,i){if(this.options=t.options,this.stringify=t.stringify,r==null)throw new Error("Missing attribute name of element "+t.name);if(i==null)throw new Error("Missing attribute value for attribute "+r+" of element "+t.name);this.name=this.stringify.attName(r),this.value=this.stringify.attValue(i)}return e.prototype.clone=function(){return Object.create(this)},e.prototype.toString=function(t){return this.options.writer.set(t).attribute(this)},e}()}).call(TC)});var Fo=F((SC,_C)=>{(function(){var n,e,t,r,i,s,o=function(c,u){for(var l in u)a.call(u,l)&&(c[l]=u[l]);function h(){this.constructor=c}return h.prototype=u.prototype,c.prototype=new h,c.__super__=u.prototype,c},a={}.hasOwnProperty;s=Tr(),i=s.isObject,r=s.isFunction,t=en(),n=Md(),_C.exports=e=function(c){o(u,c);function u(l,h,p){if(u.__super__.constructor.call(this,l),h==null)throw new Error("Missing element name");this.name=this.stringify.eleName(h),this.attributes={},p!=null&&this.attribute(p),l.isDocument&&(this.isRoot=!0,this.documentObject=l,l.rootObject=this)}return u.prototype.clone=function(){var l,h,p,C;p=Object.create(this),p.isRoot&&(p.documentObject=null),p.attributes={},C=this.attributes;for(h in C)!a.call(C,h)||(l=C[h],p.attributes[h]=l.clone());return p.children=[],this.children.forEach(function(T){var y;return y=T.clone(),y.parent=p,p.children.push(y)}),p},u.prototype.attribute=function(l,h){var p,C;if(l!=null&&(l=l.valueOf()),i(l))for(p in l)!a.call(l,p)||(C=l[p],this.attribute(p,C));else r(h)&&(h=h.apply()),(!this.options.skipNullAttributes||h!=null)&&(this.attributes[l]=new n(this,l,h));return this},u.prototype.removeAttribute=function(l){var h,p,C;if(l==null)throw new Error("Missing attribute name");if(l=l.valueOf(),Array.isArray(l))for(p=0,C=l.length;p<C;p++)h=l[p],delete this.attributes[h];else delete this.attributes[l];return this},u.prototype.toString=function(l){return this.options.writer.set(l).element(this)},u.prototype.att=function(l,h){return this.attribute(l,h)},u.prototype.a=function(l,h){return this.attribute(l,h)},u}(t)}).call(SC)});var No=F((PC,kC)=>{(function(){var n,e,t=function(i,s){for(var o in s)r.call(s,o)&&(i[o]=s[o]);function a(){this.constructor=i}return a.prototype=s.prototype,i.prototype=new a,i.__super__=s.prototype,i},r={}.hasOwnProperty;e=en(),kC.exports=n=function(i){t(s,i);function s(o,a){if(s.__super__.constructor.call(this,o),a==null)throw new Error("Missing CDATA text");this.text=this.stringify.cdata(a)}return s.prototype.clone=function(){return Object.create(this)},s.prototype.toString=function(o){return this.options.writer.set(o).cdata(this)},s}(e)}).call(PC)});var Oo=F((EC,xC)=>{(function(){var n,e,t=function(i,s){for(var o in s)r.call(s,o)&&(i[o]=s[o]);function a(){this.constructor=i}return a.prototype=s.prototype,i.prototype=new a,i.__super__=s.prototype,i},r={}.hasOwnProperty;e=en(),xC.exports=n=function(i){t(s,i);function s(o,a){if(s.__super__.constructor.call(this,o),a==null)throw new Error("Missing comment text");this.text=this.stringify.comment(a)}return s.prototype.clone=function(){return Object.create(this)},s.prototype.toString=function(o){return this.options.writer.set(o).comment(this)},s}(e)}).call(EC)});var Lo=F((qC,IC)=>{(function(){var n,e,t,r=function(s,o){for(var a in o)i.call(o,a)&&(s[a]=o[a]);function c(){this.constructor=s}return c.prototype=o.prototype,s.prototype=new c,s.__super__=o.prototype,s},i={}.hasOwnProperty;t=Tr().isObject,e=en(),IC.exports=n=function(s){r(o,s);function o(a,c,u,l){var h;o.__super__.constructor.call(this,a),t(c)&&(h=c,c=h.version,u=h.encoding,l=h.standalone),c||(c="1.0"),this.version=this.stringify.xmlVersion(c),u!=null&&(this.encoding=this.stringify.xmlEncoding(u)),l!=null&&(this.standalone=this.stringify.xmlStandalone(l))}return o.prototype.toString=function(a){return this.options.writer.set(a).declaration(this)},o}(e)}).call(qC)});var Ao=F((FC,NC)=>{(function(){var n,e,t=function(i,s){for(var o in s)r.call(s,o)&&(i[o]=s[o]);function a(){this.constructor=i}return a.prototype=s.prototype,i.prototype=new a,i.__super__=s.prototype,i},r={}.hasOwnProperty;e=en(),NC.exports=n=function(i){t(s,i);function s(o,a,c,u,l,h){if(s.__super__.constructor.call(this,o),a==null)throw new Error("Missing DTD element name");if(c==null)throw new Error("Missing DTD attribute name");if(!u)throw new Error("Missing DTD attribute type");if(!l)throw new Error("Missing DTD attribute default");if(l.indexOf("#")!==0&&(l="#"+l),!l.match(/^(#REQUIRED|#IMPLIED|#FIXED|#DEFAULT)$/))throw new Error("Invalid default value type; expected: #REQUIRED, #IMPLIED, #FIXED or #DEFAULT");if(h&&!l.match(/^(#FIXED|#DEFAULT)$/))throw new Error("Default value only applies to #FIXED or #DEFAULT");this.elementName=this.stringify.eleName(a),this.attributeName=this.stringify.attName(c),this.attributeType=this.stringify.dtdAttType(u),this.defaultValue=this.stringify.dtdAttDefault(h),this.defaultValueType=l}return s.prototype.toString=function(o){return this.options.writer.set(o).dtdAttList(this)},s}(e)}).call(FC)});var Mo=F((OC,LC)=>{(function(){var n,e,t,r=function(s,o){for(var a in o)i.call(o,a)&&(s[a]=o[a]);function c(){this.constructor=s}return c.prototype=o.prototype,s.prototype=new c,s.__super__=o.prototype,s},i={}.hasOwnProperty;t=Tr().isObject,e=en(),LC.exports=n=function(s){r(o,s);function o(a,c,u,l){if(o.__super__.constructor.call(this,a),u==null)throw new Error("Missing entity name");if(l==null)throw new Error("Missing entity value");if(this.pe=!!c,this.name=this.stringify.eleName(u),!t(l))this.value=this.stringify.dtdEntityValue(l);else{if(!l.pubID&&!l.sysID)throw new Error("Public and/or system identifiers are required for an external entity");if(l.pubID&&!l.sysID)throw new Error("System identifier is required for a public external entity");if(l.pubID!=null&&(this.pubID=this.stringify.dtdPubID(l.pubID)),l.sysID!=null&&(this.sysID=this.stringify.dtdSysID(l.sysID)),l.nData!=null&&(this.nData=this.stringify.dtdNData(l.nData)),this.pe&&this.nData)throw new Error("Notation declaration is not allowed in a parameter entity")}}return o.prototype.toString=function(a){return this.options.writer.set(a).dtdEntity(this)},o}(e)}).call(OC)});var $o=F((AC,MC)=>{(function(){var n,e,t=function(i,s){for(var o in s)r.call(s,o)&&(i[o]=s[o]);function a(){this.constructor=i}return a.prototype=s.prototype,i.prototype=new a,i.__super__=s.prototype,i},r={}.hasOwnProperty;e=en(),MC.exports=n=function(i){t(s,i);function s(o,a,c){if(s.__super__.constructor.call(this,o),a==null)throw new Error("Missing DTD element name");c||(c="(#PCDATA)"),Array.isArray(c)&&(c="("+c.join(",")+")"),this.name=this.stringify.eleName(a),this.value=this.stringify.dtdElementValue(c)}return s.prototype.toString=function(o){return this.options.writer.set(o).dtdElement(this)},s}(e)}).call(AC)});var jo=F(($C,jC)=>{(function(){var n,e,t=function(i,s){for(var o in s)r.call(s,o)&&(i[o]=s[o]);function a(){this.constructor=i}return a.prototype=s.prototype,i.prototype=new a,i.__super__=s.prototype,i},r={}.hasOwnProperty;e=en(),jC.exports=n=function(i){t(s,i);function s(o,a,c){if(s.__super__.constructor.call(this,o),a==null)throw new Error("Missing notation name");if(!c.pubID&&!c.sysID)throw new Error("Public or system identifiers are required for an external entity");this.name=this.stringify.eleName(a),c.pubID!=null&&(this.pubID=this.stringify.dtdPubID(c.pubID)),c.sysID!=null&&(this.sysID=this.stringify.dtdSysID(c.sysID))}return s.prototype.toString=function(o){return this.options.writer.set(o).dtdNotation(this)},s}(e)}).call($C)});var Wo=F((WC,HC)=>{(function(){var n,e,t,r,i,s,o,a=function(u,l){for(var h in l)c.call(l,h)&&(u[h]=l[h]);function p(){this.constructor=u}return p.prototype=l.prototype,u.prototype=new p,u.__super__=l.prototype,u},c={}.hasOwnProperty;o=Tr().isObject,s=en(),n=Ao(),t=Mo(),e=$o(),r=jo(),HC.exports=i=function(u){a(l,u);function l(h,p,C){var T,y;l.__super__.constructor.call(this,h),this.documentObject=h,o(p)&&(T=p,p=T.pubID,C=T.sysID),C==null&&(y=[p,C],C=y[0],p=y[1]),p!=null&&(this.pubID=this.stringify.dtdPubID(p)),C!=null&&(this.sysID=this.stringify.dtdSysID(C))}return l.prototype.element=function(h,p){var C;return C=new e(this,h,p),this.children.push(C),this},l.prototype.attList=function(h,p,C,T,y){var R;return R=new n(this,h,p,C,T,y),this.children.push(R),this},l.prototype.entity=function(h,p){var C;return C=new t(this,!1,h,p),this.children.push(C),this},l.prototype.pEntity=function(h,p){var C;return C=new t(this,!0,h,p),this.children.push(C),this},l.prototype.notation=function(h,p){var C;return C=new r(this,h,p),this.children.push(C),this},l.prototype.toString=function(h){return this.options.writer.set(h).docType(this)},l.prototype.ele=function(h,p){return this.element(h,p)},l.prototype.att=function(h,p,C,T,y){return this.attList(h,p,C,T,y)},l.prototype.ent=function(h,p){return this.entity(h,p)},l.prototype.pent=function(h,p){return this.pEntity(h,p)},l.prototype.not=function(h,p){return this.notation(h,p)},l.prototype.up=function(){return this.root()||this.documentObject},l}(s)}).call(WC)});var Ho=F((UC,KC)=>{(function(){var n,e,t=function(i,s){for(var o in s)r.call(s,o)&&(i[o]=s[o]);function a(){this.constructor=i}return a.prototype=s.prototype,i.prototype=new a,i.__super__=s.prototype,i},r={}.hasOwnProperty;n=en(),KC.exports=e=function(i){t(s,i);function s(o,a){if(s.__super__.constructor.call(this,o),a==null)throw new Error("Missing raw text");this.value=this.stringify.raw(a)}return s.prototype.clone=function(){return Object.create(this)},s.prototype.toString=function(o){return this.options.writer.set(o).raw(this)},s}(n)}).call(UC)});var Uo=F((zC,VC)=>{(function(){var n,e,t=function(i,s){for(var o in s)r.call(s,o)&&(i[o]=s[o]);function a(){this.constructor=i}return a.prototype=s.prototype,i.prototype=new a,i.__super__=s.prototype,i},r={}.hasOwnProperty;n=en(),VC.exports=e=function(i){t(s,i);function s(o,a){if(s.__super__.constructor.call(this,o),a==null)throw new Error("Missing element text");this.value=this.stringify.eleText(a)}return s.prototype.clone=function(){return Object.create(this)},s.prototype.toString=function(o){return this.options.writer.set(o).text(this)},s}(n)}).call(zC)});var Ko=F((XC,BC)=>{(function(){var n,e,t=function(i,s){for(var o in s)r.call(s,o)&&(i[o]=s[o]);function a(){this.constructor=i}return a.prototype=s.prototype,i.prototype=new a,i.__super__=s.prototype,i},r={}.hasOwnProperty;n=en(),BC.exports=e=function(i){t(s,i);function s(o,a,c){if(s.__super__.constructor.call(this,o),a==null)throw new Error("Missing instruction target");this.target=this.stringify.insTarget(a),c&&(this.value=this.stringify.insValue(c))}return s.prototype.clone=function(){return Object.create(this)},s.prototype.toString=function(o){return this.options.writer.set(o).processingInstruction(this)},s}(n)}).call(XC)});var en=F((GC,QC)=>{(function(){var n,e,t,r,i,s,o,a,c,u,l,h,p,C={}.hasOwnProperty;p=Tr(),h=p.isObject,l=p.isFunction,u=p.isEmpty,i=null,n=null,e=null,t=null,r=null,a=null,c=null,o=null,QC.exports=s=function(){function T(y){this.parent=y,this.parent&&(this.options=this.parent.options,this.stringify=this.parent.stringify),this.children=[],i||(i=Fo(),n=No(),e=Oo(),t=Lo(),r=Wo(),a=Ho(),c=Uo(),o=Ko())}return T.prototype.element=function(y,R,S){var v,b,P,N,q,O,H,B,Y,Z;if(O=null,R==null&&(R={}),R=R.valueOf(),h(R)||(Y=[R,S],S=Y[0],R=Y[1]),y!=null&&(y=y.valueOf()),Array.isArray(y))for(P=0,H=y.length;P<H;P++)b=y[P],O=this.element(b);else if(l(y))O=this.element(y.apply());else if(h(y)){for(q in y)if(!!C.call(y,q))if(Z=y[q],l(Z)&&(Z=Z.apply()),h(Z)&&u(Z)&&(Z=null),!this.options.ignoreDecorators&&this.stringify.convertAttKey&&q.indexOf(this.stringify.convertAttKey)===0)O=this.attribute(q.substr(this.stringify.convertAttKey.length),Z);else if(!this.options.separateArrayItems&&Array.isArray(Z))for(N=0,B=Z.length;N<B;N++)b=Z[N],v={},v[q]=b,O=this.element(v);else h(Z)?(O=this.element(q),O.element(Z)):O=this.element(q,Z)}else!this.options.ignoreDecorators&&this.stringify.convertTextKey&&y.indexOf(this.stringify.convertTextKey)===0?O=this.text(S):!this.options.ignoreDecorators&&this.stringify.convertCDataKey&&y.indexOf(this.stringify.convertCDataKey)===0?O=this.cdata(S):!this.options.ignoreDecorators&&this.stringify.convertCommentKey&&y.indexOf(this.stringify.convertCommentKey)===0?O=this.comment(S):!this.options.ignoreDecorators&&this.stringify.convertRawKey&&y.indexOf(this.stringify.convertRawKey)===0?O=this.raw(S):!this.options.ignoreDecorators&&this.stringify.convertPIKey&&y.indexOf(this.stringify.convertPIKey)===0?O=this.instruction(y.substr(this.stringify.convertPIKey.length),S):O=this.node(y,R,S);if(O==null)throw new Error("Could not create any elements with: "+y);return O},T.prototype.insertBefore=function(y,R,S){var v,b,P;if(this.isRoot)throw new Error("Cannot insert elements at root level");return b=this.parent.children.indexOf(this),P=this.parent.children.splice(b),v=this.parent.element(y,R,S),Array.prototype.push.apply(this.parent.children,P),v},T.prototype.insertAfter=function(y,R,S){var v,b,P;if(this.isRoot)throw new Error("Cannot insert elements at root level");return b=this.parent.children.indexOf(this),P=this.parent.children.splice(b+1),v=this.parent.element(y,R,S),Array.prototype.push.apply(this.parent.children,P),v},T.prototype.remove=function(){var y,R;if(this.isRoot)throw new Error("Cannot remove the root element");return y=this.parent.children.indexOf(this),[].splice.apply(this.parent.children,[y,y-y+1].concat(R=[])),this.parent},T.prototype.node=function(y,R,S){var v,b;return y!=null&&(y=y.valueOf()),R||(R={}),R=R.valueOf(),h(R)||(b=[R,S],S=b[0],R=b[1]),v=new i(this,y,R),S!=null&&v.text(S),this.children.push(v),v},T.prototype.text=function(y){var R;return R=new c(this,y),this.children.push(R),this},T.prototype.cdata=function(y){var R;return R=new n(this,y),this.children.push(R),this},T.prototype.comment=function(y){var R;return R=new e(this,y),this.children.push(R),this},T.prototype.commentBefore=function(y){var R,S,v;return S=this.parent.children.indexOf(this),v=this.parent.children.splice(S),R=this.parent.comment(y),Array.prototype.push.apply(this.parent.children,v),this},T.prototype.commentAfter=function(y){var R,S,v;return S=this.parent.children.indexOf(this),v=this.parent.children.splice(S+1),R=this.parent.comment(y),Array.prototype.push.apply(this.parent.children,v),this},T.prototype.raw=function(y){var R;return R=new a(this,y),this.children.push(R),this},T.prototype.instruction=function(y,R){var S,v,b,P,N;if(y!=null&&(y=y.valueOf()),R!=null&&(R=R.valueOf()),Array.isArray(y))for(P=0,N=y.length;P<N;P++)S=y[P],this.instruction(S);else if(h(y))for(S in y)!C.call(y,S)||(v=y[S],this.instruction(S,v));else l(R)&&(R=R.apply()),b=new o(this,y,R),this.children.push(b);return this},T.prototype.instructionBefore=function(y,R){var S,v,b;return v=this.parent.children.indexOf(this),b=this.parent.children.splice(v),S=this.parent.instruction(y,R),Array.prototype.push.apply(this.parent.children,b),this},T.prototype.instructionAfter=function(y,R){var S,v,b;return v=this.parent.children.indexOf(this),b=this.parent.children.splice(v+1),S=this.parent.instruction(y,R),Array.prototype.push.apply(this.parent.children,b),this},T.prototype.declaration=function(y,R,S){var v,b;return v=this.document(),b=new t(v,y,R,S),v.children[0]instanceof t?v.children[0]=b:v.children.unshift(b),v.root()||v},T.prototype.doctype=function(y,R){var S,v,b,P,N,q,O,H,B,Y;for(v=this.document(),b=new r(v,y,R),B=v.children,P=N=0,O=B.length;N<O;P=++N)if(S=B[P],S instanceof r)return v.children[P]=b,b;for(Y=v.children,P=q=0,H=Y.length;q<H;P=++q)if(S=Y[P],S.isRoot)return v.children.splice(P,0,b),b;return v.children.push(b),b},T.prototype.up=function(){if(this.isRoot)throw new Error("The root node has no parent. Use doc() if you need to get the document object.");return this.parent},T.prototype.root=function(){var y;for(y=this;y;){if(y.isDocument)return y.rootObject;if(y.isRoot)return y;y=y.parent}},T.prototype.document=function(){var y;for(y=this;y;){if(y.isDocument)return y;y=y.parent}},T.prototype.end=function(y){return this.document().end(y)},T.prototype.prev=function(){var y;if(y=this.parent.children.indexOf(this),y<1)throw new Error("Already at the first node");return this.parent.children[y-1]},T.prototype.next=function(){var y;if(y=this.parent.children.indexOf(this),y===-1||y===this.parent.children.length-1)throw new Error("Already at the last node");return this.parent.children[y+1]},T.prototype.importDocument=function(y){var R;return R=y.root().clone(),R.parent=this,R.isRoot=!1,this.children.push(R),this},T.prototype.ele=function(y,R,S){return this.element(y,R,S)},T.prototype.nod=function(y,R,S){return this.node(y,R,S)},T.prototype.txt=function(y){return this.text(y)},T.prototype.dat=function(y){return this.cdata(y)},T.prototype.com=function(y){return this.comment(y)},T.prototype.ins=function(y,R){return this.instruction(y,R)},T.prototype.doc=function(){return this.document()},T.prototype.dec=function(y,R,S){return this.declaration(y,R,S)},T.prototype.dtd=function(y,R){return this.doctype(y,R)},T.prototype.e=function(y,R,S){return this.element(y,R,S)},T.prototype.n=function(y,R,S){return this.node(y,R,S)},T.prototype.t=function(y){return this.text(y)},T.prototype.d=function(y){return this.cdata(y)},T.prototype.c=function(y){return this.comment(y)},T.prototype.r=function(y){return this.raw(y)},T.prototype.i=function(y,R){return this.instruction(y,R)},T.prototype.u=function(){return this.up()},T.prototype.importXMLBuilder=function(y){return this.importDocument(y)},T}()}).call(GC)});var $d=F((YC,JC)=>{(function(){var n,e=function(r,i){return function(){return r.apply(i,arguments)}},t={}.hasOwnProperty;JC.exports=n=function(){function r(i){this.assertLegalChar=e(this.assertLegalChar,this);var s,o,a;i||(i={}),this.noDoubleEncoding=i.noDoubleEncoding,o=i.stringify||{};for(s in o)!t.call(o,s)||(a=o[s],this[s]=a)}return r.prototype.eleName=function(i){return i=""+i||"",this.assertLegalChar(i)},r.prototype.eleText=function(i){return i=""+i||"",this.assertLegalChar(this.elEscape(i))},r.prototype.cdata=function(i){return i=""+i||"",i=i.replace("]]>","]]]]><![CDATA[>"),this.assertLegalChar(i)},r.prototype.comment=function(i){if(i=""+i||"",i.match(/--/))throw new Error("Comment text cannot contain double-hypen: "+i);return this.assertLegalChar(i)},r.prototype.raw=function(i){return""+i||""},r.prototype.attName=function(i){return i=""+i||""},r.prototype.attValue=function(i){return i=""+i||"",this.attEscape(i)},r.prototype.insTarget=function(i){return""+i||""},r.prototype.insValue=function(i){if(i=""+i||"",i.match(/\?>/))throw new Error("Invalid processing instruction value: "+i);return i},r.prototype.xmlVersion=function(i){if(i=""+i||"",!i.match(/1\.[0-9]+/))throw new Error("Invalid version number: "+i);return i},r.prototype.xmlEncoding=function(i){if(i=""+i||"",!i.match(/^[A-Za-z](?:[A-Za-z0-9._-])*$/))throw new Error("Invalid encoding: "+i);return i},r.prototype.xmlStandalone=function(i){return i?"yes":"no"},r.prototype.dtdPubID=function(i){return""+i||""},r.prototype.dtdSysID=function(i){return""+i||""},r.prototype.dtdElementValue=function(i){return""+i||""},r.prototype.dtdAttType=function(i){return""+i||""},r.prototype.dtdAttDefault=function(i){return i!=null?""+i||"":i},r.prototype.dtdEntityValue=function(i){return""+i||""},r.prototype.dtdNData=function(i){return""+i||""},r.prototype.convertAttKey="@",r.prototype.convertPIKey="?",r.prototype.convertTextKey="#text",r.prototype.convertCDataKey="#cdata",r.prototype.convertCommentKey="#comment",r.prototype.convertRawKey="#raw",r.prototype.assertLegalChar=function(i){var s;if(s=i.match(/[\0\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/),s)throw new Error("Invalid character in string: "+i+" at index "+s.index);return i},r.prototype.elEscape=function(i){var s;return s=this.noDoubleEncoding?/(?!&\S+;)&/g:/&/g,i.replace(s,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\r/g,"&#xD;")},r.prototype.attEscape=function(i){var s;return s=this.noDoubleEncoding?/(?!&\S+;)&/g:/&/g,i.replace(s,"&amp;").replace(/</g,"&lt;").replace(/"/g,"&quot;").replace(/\t/g,"&#x9;").replace(/\n/g,"&#xA;").replace(/\r/g,"&#xD;")},r}()}).call(YC)});var jd=F((ZC,eb)=>{(function(){var n,e={}.hasOwnProperty;eb.exports=n=function(){function t(r){var i,s,o,a,c,u,l,h,p;r||(r={}),this.pretty=r.pretty||!1,this.allowEmpty=(s=r.allowEmpty)!=null?s:!1,this.pretty?(this.indent=(o=r.indent)!=null?o:"  ",this.newline=(a=r.newline)!=null?a:`
`,this.offset=(c=r.offset)!=null?c:0,this.dontprettytextnodes=(u=r.dontprettytextnodes)!=null?u:0):(this.indent="",this.newline="",this.offset=0,this.dontprettytextnodes=0),this.spacebeforeslash=(l=r.spacebeforeslash)!=null?l:"",this.spacebeforeslash===!0&&(this.spacebeforeslash=" "),this.newlinedefault=this.newline,this.prettydefault=this.pretty,h=r.writer||{};for(i in h)!e.call(h,i)||(p=h[i],this[i]=p)}return t.prototype.set=function(r){var i,s,o;r||(r={}),"pretty"in r&&(this.pretty=r.pretty),"allowEmpty"in r&&(this.allowEmpty=r.allowEmpty),this.pretty?(this.indent="indent"in r?r.indent:"  ",this.newline="newline"in r?r.newline:`
`,this.offset="offset"in r?r.offset:0,this.dontprettytextnodes="dontprettytextnodes"in r?r.dontprettytextnodes:0):(this.indent="",this.newline="",this.offset=0,this.dontprettytextnodes=0),this.spacebeforeslash="spacebeforeslash"in r?r.spacebeforeslash:"",this.spacebeforeslash===!0&&(this.spacebeforeslash=" "),this.newlinedefault=this.newline,this.prettydefault=this.pretty,s=r.writer||{};for(i in s)!e.call(s,i)||(o=s[i],this[i]=o);return this},t.prototype.space=function(r){var i;return this.pretty?(i=(r||0)+this.offset+1,i>0?new Array(i).join(this.indent):""):""},t}()}).call(ZC)});var qc=F((tb,nb)=>{(function(){var n,e,t,r,i,s,o,a,c,u,l,h,p,C,T=function(R,S){for(var v in S)y.call(S,v)&&(R[v]=S[v]);function b(){this.constructor=R}return b.prototype=S.prototype,R.prototype=new b,R.__super__=S.prototype,R},y={}.hasOwnProperty;o=Lo(),a=Wo(),n=No(),e=Oo(),c=Fo(),l=Ho(),p=Uo(),u=Ko(),t=Ao(),r=$o(),i=Mo(),s=jo(),C=jd(),nb.exports=h=function(R){T(S,R);function S(v){S.__super__.constructor.call(this,v)}return S.prototype.document=function(v){var b,P,N,q,O;for(this.textispresent=!1,q="",O=v.children,P=0,N=O.length;P<N;P++)b=O[P],q+=function(){switch(!1){case!(b instanceof o):return this.declaration(b);case!(b instanceof a):return this.docType(b);case!(b instanceof e):return this.comment(b);case!(b instanceof u):return this.processingInstruction(b);default:return this.element(b,0)}}.call(this);return this.pretty&&q.slice(-this.newline.length)===this.newline&&(q=q.slice(0,-this.newline.length)),q},S.prototype.attribute=function(v){return" "+v.name+'="'+v.value+'"'},S.prototype.cdata=function(v,b){return this.space(b)+"<![CDATA["+v.text+"]]>"+this.newline},S.prototype.comment=function(v,b){return this.space(b)+"<!-- "+v.text+" -->"+this.newline},S.prototype.declaration=function(v,b){var P;return P=this.space(b),P+='<?xml version="'+v.version+'"',v.encoding!=null&&(P+=' encoding="'+v.encoding+'"'),v.standalone!=null&&(P+=' standalone="'+v.standalone+'"'),P+=this.spacebeforeslash+"?>",P+=this.newline,P},S.prototype.docType=function(v,b){var P,N,q,O,H;if(b||(b=0),O=this.space(b),O+="<!DOCTYPE "+v.root().name,v.pubID&&v.sysID?O+=' PUBLIC "'+v.pubID+'" "'+v.sysID+'"':v.sysID&&(O+=' SYSTEM "'+v.sysID+'"'),v.children.length>0){for(O+=" [",O+=this.newline,H=v.children,N=0,q=H.length;N<q;N++)P=H[N],O+=function(){switch(!1){case!(P instanceof t):return this.dtdAttList(P,b+1);case!(P instanceof r):return this.dtdElement(P,b+1);case!(P instanceof i):return this.dtdEntity(P,b+1);case!(P instanceof s):return this.dtdNotation(P,b+1);case!(P instanceof n):return this.cdata(P,b+1);case!(P instanceof e):return this.comment(P,b+1);case!(P instanceof u):return this.processingInstruction(P,b+1);default:throw new Error("Unknown DTD node type: "+P.constructor.name)}}.call(this);O+="]"}return O+=this.spacebeforeslash+">",O+=this.newline,O},S.prototype.element=function(v,b){var P,N,q,O,H,B,Y,Z,Oe,ot,Ye,He,de;b||(b=0),de=!1,this.textispresent?(this.newline="",this.pretty=!1):(this.newline=this.newlinedefault,this.pretty=this.prettydefault),He=this.space(b),Z="",Z+=He+"<"+v.name,Oe=v.attributes;for(Y in Oe)!y.call(Oe,Y)||(P=Oe[Y],Z+=this.attribute(P));if(v.children.length===0||v.children.every(function(Ue){return Ue.value===""}))this.allowEmpty?Z+="></"+v.name+">"+this.newline:Z+=this.spacebeforeslash+"/>"+this.newline;else if(this.pretty&&v.children.length===1&&v.children[0].value!=null)Z+=">",Z+=v.children[0].value,Z+="</"+v.name+">"+this.newline;else{if(this.dontprettytextnodes){for(ot=v.children,q=0,H=ot.length;q<H;q++)if(N=ot[q],N.value!=null){this.textispresent++,de=!0;break}}for(this.textispresent&&(this.newline="",this.pretty=!1,He=this.space(b)),Z+=">"+this.newline,Ye=v.children,O=0,B=Ye.length;O<B;O++)N=Ye[O],Z+=function(){switch(!1){case!(N instanceof n):return this.cdata(N,b+1);case!(N instanceof e):return this.comment(N,b+1);case!(N instanceof c):return this.element(N,b+1);case!(N instanceof l):return this.raw(N,b+1);case!(N instanceof p):return this.text(N,b+1);case!(N instanceof u):return this.processingInstruction(N,b+1);default:throw new Error("Unknown XML node type: "+N.constructor.name)}}.call(this);de&&this.textispresent--,this.textispresent||(this.newline=this.newlinedefault,this.pretty=this.prettydefault),Z+=He+"</"+v.name+">"+this.newline}return Z},S.prototype.processingInstruction=function(v,b){var P;return P=this.space(b)+"<?"+v.target,v.value&&(P+=" "+v.value),P+=this.spacebeforeslash+"?>"+this.newline,P},S.prototype.raw=function(v,b){return this.space(b)+v.value+this.newline},S.prototype.text=function(v,b){return this.space(b)+v.value+this.newline},S.prototype.dtdAttList=function(v,b){var P;return P=this.space(b)+"<!ATTLIST "+v.elementName+" "+v.attributeName+" "+v.attributeType,v.defaultValueType!=="#DEFAULT"&&(P+=" "+v.defaultValueType),v.defaultValue&&(P+=' "'+v.defaultValue+'"'),P+=this.spacebeforeslash+">"+this.newline,P},S.prototype.dtdElement=function(v,b){return this.space(b)+"<!ELEMENT "+v.name+" "+v.value+this.spacebeforeslash+">"+this.newline},S.prototype.dtdEntity=function(v,b){var P;return P=this.space(b)+"<!ENTITY",v.pe&&(P+=" %"),P+=" "+v.name,v.value?P+=' "'+v.value+'"':(v.pubID&&v.sysID?P+=' PUBLIC "'+v.pubID+'" "'+v.sysID+'"':v.sysID&&(P+=' SYSTEM "'+v.sysID+'"'),v.nData&&(P+=" NDATA "+v.nData)),P+=this.spacebeforeslash+">"+this.newline,P},S.prototype.dtdNotation=function(v,b){var P;return P=this.space(b)+"<!NOTATION "+v.name,v.pubID&&v.sysID?P+=' PUBLIC "'+v.pubID+'" "'+v.sysID+'"':v.pubID?P+=' PUBLIC "'+v.pubID+'"':v.sysID&&(P+=' SYSTEM "'+v.sysID+'"'),P+=this.spacebeforeslash+">"+this.newline,P},S.prototype.openNode=function(v,b){var P,N,q,O;if(b||(b=0),v instanceof c){q=this.space(b)+"<"+v.name,O=v.attributes;for(N in O)!y.call(O,N)||(P=O[N],q+=this.attribute(P));return q+=(v.children?">":"/>")+this.newline,q}else return q=this.space(b)+"<!DOCTYPE "+v.rootNodeName,v.pubID&&v.sysID?q+=' PUBLIC "'+v.pubID+'" "'+v.sysID+'"':v.sysID&&(q+=' SYSTEM "'+v.sysID+'"'),q+=(v.children?" [":">")+this.newline,q},S.prototype.closeNode=function(v,b){switch(b||(b=0),!1){case!(v instanceof c):return this.space(b)+"</"+v.name+">"+this.newline;case!(v instanceof a):return this.space(b)+"]>"+this.newline}},S}(C)}).call(tb)});var sb=F((rb,ib)=>{(function(){var n,e,t,r,i,s=function(a,c){for(var u in c)o.call(c,u)&&(a[u]=c[u]);function l(){this.constructor=a}return l.prototype=c.prototype,a.prototype=new l,a.__super__=c.prototype,a},o={}.hasOwnProperty;i=Tr().isPlainObject,e=en(),r=$d(),t=qc(),ib.exports=n=function(a){s(c,a);function c(u){c.__super__.constructor.call(this,null),u||(u={}),u.writer||(u.writer=new t),this.options=u,this.stringify=new r(u),this.isDocument=!0}return c.prototype.end=function(u){var l;return u?i(u)&&(l=u,u=this.options.writer.set(l)):u=this.options.writer,u.document(this)},c.prototype.toString=function(u){return this.options.writer.set(u).document(this)},c}(e)}).call(rb)});var cb=F((ob,ab)=>{(function(){var n,e,t,r,i,s,o,a,c,u,l,h,p,C,T,y,R,S,v,b,P={}.hasOwnProperty;b=Tr(),S=b.isObject,R=b.isFunction,v=b.isPlainObject,l=Fo(),e=No(),t=Oo(),p=Ho(),y=Uo(),h=Ko(),a=Lo(),c=Wo(),r=Ao(),s=Mo(),i=$o(),o=jo(),n=Md(),T=$d(),C=qc(),ab.exports=u=function(){function N(q,O,H){var B;q||(q={}),q.writer?v(q.writer)&&(B=q.writer,q.writer=new C(B)):q.writer=new C(q),this.options=q,this.writer=q.writer,this.stringify=new T(q),this.onDataCallback=O||function(){},this.onEndCallback=H||function(){},this.currentNode=null,this.currentLevel=-1,this.openTags={},this.documentStarted=!1,this.documentCompleted=!1,this.root=null}return N.prototype.node=function(q,O,H){var B;if(q==null)throw new Error("Missing node name");if(this.root&&this.currentLevel===-1)throw new Error("Document can only have one root node");return this.openCurrent(),q=q.valueOf(),O==null&&(O={}),O=O.valueOf(),S(O)||(B=[O,H],H=B[0],O=B[1]),this.currentNode=new l(this,q,O),this.currentNode.children=!1,this.currentLevel++,this.openTags[this.currentLevel]=this.currentNode,H!=null&&this.text(H),this},N.prototype.element=function(q,O,H){return this.currentNode&&this.currentNode instanceof c?this.dtdElement.apply(this,arguments):this.node(q,O,H)},N.prototype.attribute=function(q,O){var H,B;if(!this.currentNode||this.currentNode.children)throw new Error("att() can only be used immediately after an ele() call in callback mode");if(q!=null&&(q=q.valueOf()),S(q))for(H in q)!P.call(q,H)||(B=q[H],this.attribute(H,B));else R(O)&&(O=O.apply()),(!this.options.skipNullAttributes||O!=null)&&(this.currentNode.attributes[q]=new n(this,q,O));return this},N.prototype.text=function(q){var O;return this.openCurrent(),O=new y(this,q),this.onData(this.writer.text(O,this.currentLevel+1)),this},N.prototype.cdata=function(q){var O;return this.openCurrent(),O=new e(this,q),this.onData(this.writer.cdata(O,this.currentLevel+1)),this},N.prototype.comment=function(q){var O;return this.openCurrent(),O=new t(this,q),this.onData(this.writer.comment(O,this.currentLevel+1)),this},N.prototype.raw=function(q){var O;return this.openCurrent(),O=new p(this,q),this.onData(this.writer.raw(O,this.currentLevel+1)),this},N.prototype.instruction=function(q,O){var H,B,Y,Z,Oe;if(this.openCurrent(),q!=null&&(q=q.valueOf()),O!=null&&(O=O.valueOf()),Array.isArray(q))for(H=0,Z=q.length;H<Z;H++)B=q[H],this.instruction(B);else if(S(q))for(B in q)!P.call(q,B)||(Y=q[B],this.instruction(B,Y));else R(O)&&(O=O.apply()),Oe=new h(this,q,O),this.onData(this.writer.processingInstruction(Oe,this.currentLevel+1));return this},N.prototype.declaration=function(q,O,H){var B;if(this.openCurrent(),this.documentStarted)throw new Error("declaration() must be the first node");return B=new a(this,q,O,H),this.onData(this.writer.declaration(B,this.currentLevel+1)),this},N.prototype.doctype=function(q,O,H){if(this.openCurrent(),q==null)throw new Error("Missing root node name");if(this.root)throw new Error("dtd() must come before the root node");return this.currentNode=new c(this,O,H),this.currentNode.rootNodeName=q,this.currentNode.children=!1,this.currentLevel++,this.openTags[this.currentLevel]=this.currentNode,this},N.prototype.dtdElement=function(q,O){var H;return this.openCurrent(),H=new i(this,q,O),this.onData(this.writer.dtdElement(H,this.currentLevel+1)),this},N.prototype.attList=function(q,O,H,B,Y){var Z;return this.openCurrent(),Z=new r(this,q,O,H,B,Y),this.onData(this.writer.dtdAttList(Z,this.currentLevel+1)),this},N.prototype.entity=function(q,O){var H;return this.openCurrent(),H=new s(this,!1,q,O),this.onData(this.writer.dtdEntity(H,this.currentLevel+1)),this},N.prototype.pEntity=function(q,O){var H;return this.openCurrent(),H=new s(this,!0,q,O),this.onData(this.writer.dtdEntity(H,this.currentLevel+1)),this},N.prototype.notation=function(q,O){var H;return this.openCurrent(),H=new o(this,q,O),this.onData(this.writer.dtdNotation(H,this.currentLevel+1)),this},N.prototype.up=function(){if(this.currentLevel<0)throw new Error("The document node has no parent");return this.currentNode?(this.currentNode.children?this.closeNode(this.currentNode):this.openNode(this.currentNode),this.currentNode=null):this.closeNode(this.openTags[this.currentLevel]),delete this.openTags[this.currentLevel],this.currentLevel--,this},N.prototype.end=function(){for(;this.currentLevel>=0;)this.up();return this.onEnd()},N.prototype.openCurrent=function(){if(this.currentNode)return this.currentNode.children=!0,this.openNode(this.currentNode)},N.prototype.openNode=function(q){if(!q.isOpen)return!this.root&&this.currentLevel===0&&q instanceof l&&(this.root=q),this.onData(this.writer.openNode(q,this.currentLevel)),q.isOpen=!0},N.prototype.closeNode=function(q){if(!q.isClosed)return this.onData(this.writer.closeNode(q,this.currentLevel)),q.isClosed=!0},N.prototype.onData=function(q){return this.documentStarted=!0,this.onDataCallback(q)},N.prototype.onEnd=function(){return this.documentCompleted=!0,this.onEndCallback()},N.prototype.ele=function(){return this.element.apply(this,arguments)},N.prototype.nod=function(q,O,H){return this.node(q,O,H)},N.prototype.txt=function(q){return this.text(q)},N.prototype.dat=function(q){return this.cdata(q)},N.prototype.com=function(q){return this.comment(q)},N.prototype.ins=function(q,O){return this.instruction(q,O)},N.prototype.dec=function(q,O,H){return this.declaration(q,O,H)},N.prototype.dtd=function(q,O,H){return this.doctype(q,O,H)},N.prototype.e=function(q,O,H){return this.element(q,O,H)},N.prototype.n=function(q,O,H){return this.node(q,O,H)},N.prototype.t=function(q){return this.text(q)},N.prototype.d=function(q){return this.cdata(q)},N.prototype.c=function(q){return this.comment(q)},N.prototype.r=function(q){return this.raw(q)},N.prototype.i=function(q,O){return this.instruction(q,O)},N.prototype.att=function(){return this.currentNode&&this.currentNode instanceof c?this.attList.apply(this,arguments):this.attribute.apply(this,arguments)},N.prototype.a=function(){return this.currentNode&&this.currentNode instanceof c?this.attList.apply(this,arguments):this.attribute.apply(this,arguments)},N.prototype.ent=function(q,O){return this.entity(q,O)},N.prototype.pent=function(q,O){return this.pEntity(q,O)},N.prototype.not=function(q,O){return this.notation(q,O)},N}()}).call(ob)});var db=F((ub,lb)=>{(function(){var n,e,t,r,i,s,o,a,c,u,l,h,p,C,T=function(R,S){for(var v in S)y.call(S,v)&&(R[v]=S[v]);function b(){this.constructor=R}return b.prototype=S.prototype,R.prototype=new b,R.__super__=S.prototype,R},y={}.hasOwnProperty;o=Lo(),a=Wo(),n=No(),e=Oo(),c=Fo(),l=Ho(),p=Uo(),u=Ko(),t=Ao(),r=$o(),i=Mo(),s=jo(),C=jd(),lb.exports=h=function(R){T(S,R);function S(v,b){S.__super__.constructor.call(this,b),this.stream=v}return S.prototype.document=function(v){var b,P,N,q,O,H,B,Y;for(H=v.children,P=0,q=H.length;P<q;P++)b=H[P],b.isLastRootNode=!1;for(v.children[v.children.length-1].isLastRootNode=!0,B=v.children,Y=[],N=0,O=B.length;N<O;N++)switch(b=B[N],!1){case!(b instanceof o):Y.push(this.declaration(b));break;case!(b instanceof a):Y.push(this.docType(b));break;case!(b instanceof e):Y.push(this.comment(b));break;case!(b instanceof u):Y.push(this.processingInstruction(b));break;default:Y.push(this.element(b))}return Y},S.prototype.attribute=function(v){return this.stream.write(" "+v.name+'="'+v.value+'"')},S.prototype.cdata=function(v,b){return this.stream.write(this.space(b)+"<![CDATA["+v.text+"]]>"+this.endline(v))},S.prototype.comment=function(v,b){return this.stream.write(this.space(b)+"<!-- "+v.text+" -->"+this.endline(v))},S.prototype.declaration=function(v,b){return this.stream.write(this.space(b)),this.stream.write('<?xml version="'+v.version+'"'),v.encoding!=null&&this.stream.write(' encoding="'+v.encoding+'"'),v.standalone!=null&&this.stream.write(' standalone="'+v.standalone+'"'),this.stream.write(this.spacebeforeslash+"?>"),this.stream.write(this.endline(v))},S.prototype.docType=function(v,b){var P,N,q,O;if(b||(b=0),this.stream.write(this.space(b)),this.stream.write("<!DOCTYPE "+v.root().name),v.pubID&&v.sysID?this.stream.write(' PUBLIC "'+v.pubID+'" "'+v.sysID+'"'):v.sysID&&this.stream.write(' SYSTEM "'+v.sysID+'"'),v.children.length>0){for(this.stream.write(" ["),this.stream.write(this.endline(v)),O=v.children,N=0,q=O.length;N<q;N++)switch(P=O[N],!1){case!(P instanceof t):this.dtdAttList(P,b+1);break;case!(P instanceof r):this.dtdElement(P,b+1);break;case!(P instanceof i):this.dtdEntity(P,b+1);break;case!(P instanceof s):this.dtdNotation(P,b+1);break;case!(P instanceof n):this.cdata(P,b+1);break;case!(P instanceof e):this.comment(P,b+1);break;case!(P instanceof u):this.processingInstruction(P,b+1);break;default:throw new Error("Unknown DTD node type: "+P.constructor.name)}this.stream.write("]")}return this.stream.write(this.spacebeforeslash+">"),this.stream.write(this.endline(v))},S.prototype.element=function(v,b){var P,N,q,O,H,B,Y,Z;b||(b=0),Z=this.space(b),this.stream.write(Z+"<"+v.name),B=v.attributes;for(H in B)!y.call(B,H)||(P=B[H],this.attribute(P));if(v.children.length===0||v.children.every(function(Oe){return Oe.value===""}))this.allowEmpty?this.stream.write("></"+v.name+">"):this.stream.write(this.spacebeforeslash+"/>");else if(this.pretty&&v.children.length===1&&v.children[0].value!=null)this.stream.write(">"),this.stream.write(v.children[0].value),this.stream.write("</"+v.name+">");else{for(this.stream.write(">"+this.newline),Y=v.children,q=0,O=Y.length;q<O;q++)switch(N=Y[q],!1){case!(N instanceof n):this.cdata(N,b+1);break;case!(N instanceof e):this.comment(N,b+1);break;case!(N instanceof c):this.element(N,b+1);break;case!(N instanceof l):this.raw(N,b+1);break;case!(N instanceof p):this.text(N,b+1);break;case!(N instanceof u):this.processingInstruction(N,b+1);break;default:throw new Error("Unknown XML node type: "+N.constructor.name)}this.stream.write(Z+"</"+v.name+">")}return this.stream.write(this.endline(v))},S.prototype.processingInstruction=function(v,b){return this.stream.write(this.space(b)+"<?"+v.target),v.value&&this.stream.write(" "+v.value),this.stream.write(this.spacebeforeslash+"?>"+this.endline(v))},S.prototype.raw=function(v,b){return this.stream.write(this.space(b)+v.value+this.endline(v))},S.prototype.text=function(v,b){return this.stream.write(this.space(b)+v.value+this.endline(v))},S.prototype.dtdAttList=function(v,b){return this.stream.write(this.space(b)+"<!ATTLIST "+v.elementName+" "+v.attributeName+" "+v.attributeType),v.defaultValueType!=="#DEFAULT"&&this.stream.write(" "+v.defaultValueType),v.defaultValue&&this.stream.write(' "'+v.defaultValue+'"'),this.stream.write(this.spacebeforeslash+">"+this.endline(v))},S.prototype.dtdElement=function(v,b){return this.stream.write(this.space(b)+"<!ELEMENT "+v.name+" "+v.value),this.stream.write(this.spacebeforeslash+">"+this.endline(v))},S.prototype.dtdEntity=function(v,b){return this.stream.write(this.space(b)+"<!ENTITY"),v.pe&&this.stream.write(" %"),this.stream.write(" "+v.name),v.value?this.stream.write(' "'+v.value+'"'):(v.pubID&&v.sysID?this.stream.write(' PUBLIC "'+v.pubID+'" "'+v.sysID+'"'):v.sysID&&this.stream.write(' SYSTEM "'+v.sysID+'"'),v.nData&&this.stream.write(" NDATA "+v.nData)),this.stream.write(this.spacebeforeslash+">"+this.endline(v))},S.prototype.dtdNotation=function(v,b){return this.stream.write(this.space(b)+"<!NOTATION "+v.name),v.pubID&&v.sysID?this.stream.write(' PUBLIC "'+v.pubID+'" "'+v.sysID+'"'):v.pubID?this.stream.write(' PUBLIC "'+v.pubID+'"'):v.sysID&&this.stream.write(' SYSTEM "'+v.sysID+'"'),this.stream.write(this.spacebeforeslash+">"+this.endline(v))},S.prototype.endline=function(v){return v.isLastRootNode?"":this.newline},S}(C)}).call(ub)});var hb=F((fb,zo)=>{(function(){var n,e,t,r,i,s,o;o=Tr(),i=o.assign,s=o.isFunction,n=sb(),e=cb(),r=qc(),t=db(),zo.exports.create=function(a,c,u,l){var h,p;if(a==null)throw new Error("Root element needs a name");return l=i({},c,u,l),h=new n(l),p=h.element(a),l.headless||(h.declaration(l),(l.pubID!=null||l.sysID!=null)&&h.doctype(l)),p},zo.exports.begin=function(a,c,u){var l;return s(a)&&(l=[a,c],c=l[0],u=l[1],a={}),c?new e(a,c,u):new n(a)},zo.exports.stringWriter=function(a){return new r(a)},zo.exports.streamWriter=function(a,c){return new t(a,c)}}).call(fb)});var vb=F(mb=>{var pb=bC(),rq=hb();mb.build=oq;function iq(n){function e(t){return t<10?"0"+t:t}return n.getUTCFullYear()+"-"+e(n.getUTCMonth()+1)+"-"+e(n.getUTCDate())+"T"+e(n.getUTCHours())+":"+e(n.getUTCMinutes())+":"+e(n.getUTCSeconds())+"Z"}var sq=Object.prototype.toString;function gb(n){var e=sq.call(n).match(/\[object (.*)\]/);return e&&e[1]}function oq(n,e){var t={version:"1.0",encoding:"UTF-8"},r={pubid:"-//Apple//DTD PLIST 1.0//EN",sysid:"http://www.apple.com/DTDs/PropertyList-1.0.dtd"},i=rq.create("plist");return i.dec(t.version,t.encoding,t.standalone),i.dtd(r.pubid,r.sysid),i.att("version","1.0"),Wd(n,i),e||(e={}),e.pretty=e.pretty!==!1,i.end(e)}function Wd(n,e){var t,r,i,s=gb(n);if(s!="Undefined")if(Array.isArray(n))for(e=e.ele("array"),r=0;r<n.length;r++)Wd(n[r],e);else if(Buffer.isBuffer(n))e.ele("data").raw(n.toString("base64"));else if(s=="Object"){e=e.ele("dict");for(i in n)n.hasOwnProperty(i)&&(e.ele("key").txt(i),Wd(n[i],e))}else s=="Number"?(t=n%1==0?"integer":"real",e.ele(t).txt(n.toString())):s=="Date"?e.ele("date").txt(iq(new Date(n))):s=="Boolean"?e.ele(n?"true":"false"):s=="String"?e.ele("string").txt(n):s=="ArrayBuffer"?e.ele("data").raw(pb.fromByteArray(n)):n&&n.buffer&&gb(n.buffer)=="ArrayBuffer"&&e.ele("data").raw(pb.fromByteArray(new Uint8Array(n.buffer),e))}});var Cb=F(Hd=>{var yb=yC();Object.keys(yb).forEach(function(n){Hd[n]=yb[n]});var wb=vb();Object.keys(wb).forEach(function(n){Hd[n]=wb[n]})});var _q={};Hb(_q,{activate:()=>Rq,deactivate:()=>Sq});var Mc=ne(require("vscode"));var re=ne(require("vscode")),gs=ne(require("fs/promises")),Rb=ne(require("path"));var Ne=ne(require("vscode")),Kd=ne(require("path"));var wf=ne(require("vscode")),Ii=ne(require("path"));var Qo=ne(require("vscode"));var jc=ne(require("child_process")),sf=ne(require("fs/promises")),xr=ne(require("path"));var St=ne(require("vscode")),Kb={get lsp(){return{get serverPath(){return St.workspace.getConfiguration("sourcekit-lsp").get("serverPath","")},get serverArguments(){return St.workspace.getConfiguration("sourcekit-lsp").get("serverArguments",[])},get inlayHintsEnabled(){return St.workspace.getConfiguration("sourcekit-lsp").get("inlayHints.enabled",!0)}}},get excludePathsFromPackageDependencies(){return St.workspace.getConfiguration("swift").get("excludePathsFromPackageDependencies",[])},set excludePathsFromPackageDependencies(n){St.workspace.getConfiguration("swift").update("excludePathsFromPackageDependencies",n)},get path(){return St.workspace.getConfiguration("swift").get("path","")},get runtimePath(){return St.workspace.getConfiguration("swift").get("runtimePath","")},get sdk(){return St.workspace.getConfiguration("swift").get("SDK","")},get buildArguments(){return St.workspace.getConfiguration("swift").get("buildArguments",[])},get buildPath(){return St.workspace.getConfiguration("swift").get("buildPath","")},get swiftEnvironmentVariables(){return St.workspace.getConfiguration("swift").get("swiftEnvironmentVariables",{})},get problemMatchCompileErrors(){return St.workspace.getConfiguration("swift").get("problemMatchCompileErrors",!0)},get autoGenerateLaunchConfigurations(){return St.workspace.getConfiguration("swift").get("autoGenerateLaunchConfigurations",!0)},get backgroundCompilation(){return St.workspace.getConfiguration("swift").get("backgroundCompilation",!1)},get diagnostics(){return St.workspace.getConfiguration("swift").get("diagnostics",!1)},get testEnvironmentVariables(){return St.workspace.getConfiguration("swift").get("testEnvironmentVariables",{})}},te=Kb;function En(n=process.env){if(te.runtimePath==="")return;let e=te.runtimePath,t=ws(),r=process.platform==="win32"?";":":";switch(n){case!1:return{[t]:e};case!0:return{[t]:`${e}${r}\${env:${t}}`};default:return n[t]?{[t]:`${e}${r}${n[t]}`}:{[t]:e}}}function ws(){switch(process.platform){case"win32":return"Path";case"darwin":return"DYLD_LIBRARY_PATH";default:return"LD_LIBRARY_PATH"}}async function xn(n,e,t={},r,i=!0){if(r==null||r.workspaceContext.outputChannel.logDiagnostic(`Exec: ${n} ${e.join(" ")}`,r.name),i){let s=En(t.env);s&&Object.keys(s).length>0&&(t.env=Ve(Ve({},t.env??process.env),s))}return new Promise((s,o)=>jc.execFile(n,e,t,(a,c,u)=>{a&&o({error:a,stdout:c,stderr:u}),s({stdout:c,stderr:u})}))}async function of(n,e,t,r,i,s={},o,a=!0){if(o==null||o.workspaceContext.outputChannel.logDiagnostic(`Exec: ${n} ${e.join(" ")}`,o.name),a){let c=En(s.env);c&&Object.keys(c).length>0&&(s.env=Ve(Ve({},s.env??process.env),c))}return new Promise((c,u)=>{var h,p;let l=jc.execFile(n,e,s,C=>{C&&u({error:C}),c()});if(t&&((h=l.stdout)==null||h.pipe(t)),r&&((p=l.stderr)==null||p.pipe(r)),i){let C=i.onCancellationRequested(()=>{l.kill(),C.dispose()})}})}async function qr(n,e={},t){let r=Yr();return n=Wc(n),Object.keys(te.swiftEnvironmentVariables).length>0&&(e.env=Ve(Ve({},e.env??process.env),te.swiftEnvironmentVariables)),await xn(r,n,e,t)}function Wc(n){switch(n[0]){case"package":{let e=n.splice(0,2).concat(Go());switch(e[1]){case"dump-symbol-graph":case"diagnose-api-breaking-changes":case"resolve":return[...e,...af(),...n];default:return e.concat(n)}}case"build":case"run":case"test":return[...n.splice(0,1).concat(Go()),...af(),...n];default:return n}}function af(){return te.sdk!==""?["--sdk",te.sdk]:[]}function Go(){return te.buildPath&&te.buildPath.length>0?["--build-path",te.buildPath]:[]}function Ir(n,e=!1){let t=te.buildPath.length>0?te.buildPath:".build";return!xr.isAbsolute(t)&&e?xr.join(n,t):t}function cf(n=!1){if(te.sdk==="")return[];let e=["-sdk",te.sdk];return n?e.flatMap(t=>["-Xswiftc",t]):e}function zb(n){return process.platform==="win32"?`${n}.exe`:n}function Yr(n="swift"){return xr.join(te.path,zb(n))}function uf(n){let e=/([^/]*)\/?$/,t=n.match(e)[1];return t.endsWith(".git")&&(t=t.replace(/\.git$/,"")),t}async function cr(...n){try{return await sf.access(xr.join(...n)),!0}catch{return!1}}function Gn(n,e){let t=xr.relative(e,n);return t[0]!=="."||t[1]!=="."}function Hc(n=8){return Math.random().toString(16).substring(2,n)}function qn(n){return n.stderr?n.stderr:n.error?JSON.stringify(n.error):n instanceof Error?n.message:JSON.stringify(n)}function lf(n){return n.length===1?n[0]:[n.slice(0,-1).join(", "),n[n.length-1]].join(" and ")}function df(n,e){let t=[],r=0;for(let i of n){if(r>0){t.push(i),r-=1;continue}let s=e.find(a=>a.argument===i);if(s){t.push(i),r=s.include;continue}e.find(a=>a.include===1&&i.startsWith(a.argument+"="))&&t.push(i)}return t}var Cs=class{constructor(e,t){this.exists=t;this.fileWatcher=Qo.workspace.createFileSystemWatcher(new Qo.RelativePattern(e,"Tests/LinuxMain.swift"),!1,!0),this.fileWatcher.onDidCreate(()=>this.exists=!0),this.fileWatcher.onDidDelete(()=>this.exists=!1)}static async create(e){let t=await cr(e.fsPath,"Tests","LinuxMain.swift");return new Cs(e,t)}dispose(){var e;(e=this.fileWatcher)==null||e.dispose()}};var Pi=ne(require("vscode"));var Uc=class{constructor(e,t){this.folderContext=e;this.workspaceContext=t}install(){this.packageFileWatcher=this.createPackageFileWatcher(),this.resolvedFileWatcher=this.createResolvedFileWatcher()}dispose(){var e,t;(e=this.packageFileWatcher)==null||e.dispose(),(t=this.resolvedFileWatcher)==null||t.dispose()}createPackageFileWatcher(){let e=Pi.workspace.createFileSystemWatcher(new Pi.RelativePattern(this.folderContext.folder,"Package.swift"));return e.onDidCreate(async()=>await this.handlePackageSwiftChange()),e.onDidChange(async()=>await this.handlePackageSwiftChange()),e.onDidDelete(async()=>await this.handlePackageSwiftChange()),e}createResolvedFileWatcher(){let e=Pi.workspace.createFileSystemWatcher(new Pi.RelativePattern(this.folderContext.folder,"Package.resolved"));return e.onDidCreate(async()=>await this.handlePackageResolvedChange()),e.onDidChange(async()=>await this.handlePackageResolvedChange()),e.onDidDelete(async()=>await this.handlePackageResolvedChange()),e}async handlePackageSwiftChange(){await this.folderContext.reload(),this.workspaceContext.fireEvent(this.folderContext,_e.packageUpdated)}async handlePackageResolvedChange(){await this.folderContext.reloadPackageResolved(),this.workspaceContext.fireEvent(this.folderContext,_e.resolvedUpdated)}};var Yo=ne(require("vscode")),Kc=ne(require("fs/promises"));var ki=class{constructor(e,t){this.pins=e;this.version=t}static fromV1JSON(e){return new ki(e.object.pins.map(t=>new zc(t.package,t.repositoryURL,t.state)),e.version)}static fromV2JSON(e){return new ki(e.pins.map(t=>new zc(t.identity,t.location,t.state)),e.version)}},zc=class{constructor(e,t,r){this.identity=e;this.location=t;this.state=r}};function Vb(n){return n.products!==void 0}function Xb(n){return n instanceof Error}var ur=class{constructor(e,t,r){this.folder=e;this.contents=t;this.resolved=r}static async create(e){let t=await ur.loadPackage(e),r=await ur.loadPackageResolved(e);return new ur(e,t,r)}static async loadPackage(e){try{let{stdout:t}=await qr(["package","describe","--type","json"],{cwd:e.fsPath});for(;!t.startsWith("{");){let r=t.indexOf(`
`);t=t.slice(r+1)}return JSON.parse(t)}catch(t){let r=t;return r.stderr!==void 0&&(r.stderr.startsWith("error: root manifest")||r.stderr.startsWith("error: Could not find Package.swift"))?void 0:Error(qn(t))}}static async loadPackageResolved(e){try{let t=Yo.Uri.joinPath(e,"Package.resolved"),r=await Kc.readFile(t.fsPath,"utf8"),i=JSON.parse(r),s=i;return s.version===1?ki.fromV1JSON(i):s.version===2?ki.fromV2JSON(i):void 0}catch{return}}async loadWorkspaceState(){try{let e=Yo.Uri.joinPath(Yo.Uri.file(Ir(this.folder.fsPath,!0)),"workspace-state.json"),t=await Kc.readFile(e.fsPath,"utf8");return JSON.parse(t)}catch{return}}async reload(){this.contents=await ur.loadPackage(this.folder)}async reloadPackageResolved(){this.resolved=await ur.loadPackageResolved(this.folder)}get isValid(){return Vb(this.contents)}get error(){if(Xb(this.contents))return this.contents}get foundPackage(){return this.contents!==void 0}get name(){var e;return((e=this.contents)==null?void 0:e.name)??""}get products(){var e;return((e=this.contents)==null?void 0:e.products)??[]}get dependencies(){var e;return((e=this.contents)==null?void 0:e.dependencies)??[]}get targets(){var e;return((e=this.contents)==null?void 0:e.targets)??[]}get executableProducts(){return this.products.filter(e=>e.type.executable!==void 0)}get libraryProducts(){return this.products.filter(e=>e.type.library!==void 0)}getTargets(e){return this.targets.filter(t=>t.type===e)}};var ta=ne(require("vscode"));var Be=ne(require("vscode")),Ei=ne(require("fs/promises")),Zo=ne(require("path")),gf=ne(require("stream"));var ff=ne(require("os")),Jr=ne(require("vscode"));async function bs(n,e=!1){if(!te.autoGenerateLaunchConfigurations)return;let t=Jr.workspace.getConfiguration("launch",n.folder),r=t.get("configurations")||[],i=["program","cwd","preLaunchTask",`env.${ws()}`],s=[],o=Bb(n),a=!1;for(let c of o){let u=r.findIndex(l=>l.name===c.name);if(u!==-1){let l=JSON.parse(JSON.stringify(r[u]));Gb(l,c,i),JSON.stringify(r[u])!==JSON.stringify(l)&&s.push({index:u,config:l})}else r.push(c),a=!0}if(s.length>0){if(!e){let c=lf(s.map(l=>l.config.name));await Jr.window.showWarningMessage(`${n.name}: The Swift extension would like to update launch configurations '${c}'. Do you want to update?`,"Update","Cancel")==="Update"&&(e=!0)}e&&(s.forEach(c=>r[c.index]=c.config),a=!0)}a&&await t.update("configurations",r,Jr.ConfigurationTarget.WorkspaceFolder)}function Bb(n){let e=n.swiftPackage.executableProducts,t,r;n.relativePath.length===0?(t=`\${workspaceFolder:${n.workspaceFolder.name}}`,r=""):(t=`\${workspaceFolder:${n.workspaceFolder.name}}/${n.relativePath}`,r=` (${n.relativePath})`);let i=Ir(t);return e.flatMap(s=>[{type:"lldb",request:"launch",name:`Debug ${s.name}${r}`,program:`${i}/debug/`+s.name,args:[],cwd:t,preLaunchTask:`swift: Build Debug ${s.name}${r}`,env:En(!0)},{type:"lldb",request:"launch",name:`Release ${s.name}${r}`,program:`${i}/release/`+s.name,args:[],cwd:t,preLaunchTask:`swift: Build Release ${s.name}${r}`,env:En(!0)}])}function Vc(n,e=!1){var a;if(n.swiftPackage.getTargets("test").length===0)return null;let t=e?n.workspaceFolder.uri.fsPath:`\${workspaceFolder:${n.workspaceFolder.name}}`,r,i;n.relativePath.length===0?(r=t,i=""):(r=`${t}/${n.relativePath}`,i=` (${n.relativePath})`);let s=Ve(Ve({},En()),te.testEnvironmentVariables),o=Ir(r);if(process.platform==="darwin"){let c=n.workspaceContext.toolchain.xcTestPath;return c===void 0?null:{type:"lldb",request:"launch",name:`Test ${n.swiftPackage.name}`,program:`${c}/xctest`,args:[`${o}/debug/${n.swiftPackage.name}PackageTests.xctest`],cwd:r,env:s,preLaunchTask:`swift: Build All${i}`}}else if(process.platform==="win32"){let c=n.workspaceContext.toolchain.runtimePath,u=n.workspaceContext.toolchain.xcTestPath;if(u===void 0)return null;u!==c&&(s.Path=`${u};${s.Path??process.env.Path}`);let l=te.sdk===""?process.env.SDKROOT:te.sdk;if(l===void 0)return null;let h;return((a=Jr.workspace.getConfiguration("lldb"))==null?void 0:a.get("library"))&&(h=[`settings set target.sdk-path ${l}`]),{type:"lldb",request:"launch",name:`Test ${n.swiftPackage.name}`,program:`${o}/debug/${n.swiftPackage.name}PackageTests.xctest`,cwd:r,env:s,preRunCommands:h,preLaunchTask:`swift: Build All${i}`}}else return{type:"lldb",request:"launch",name:`Test ${n.swiftPackage.name}`,program:`${o}/debug/${n.swiftPackage.name}PackageTests.xctest`,cwd:r,env:s,preLaunchTask:`swift: Build All${i}`}}function hf(n,e,t){if(n.swiftPackage.getTargets("test").length===0||process.platform!=="darwin")return null;let r,i;n.relativePath.length===0?(r=`\${workspaceFolder:${n.workspaceFolder.name}}`,i=""):(r=`\${workspaceFolder:${n.workspaceFolder.name}}/${n.relativePath}`,i=` (${n.relativePath})`);let s=Ir(r),o=n.workspaceContext.toolchain.xcTestPath;if(o===void 0)return null;let a;switch(ff.arch()){case"x64":a="x86_64";break;case"arm64":a="arm64e";break;default:return null}let c=Object.entries(Ve(Ve({},En()),te.testEnvironmentVariables)).map(([u,l])=>`settings set target.env-vars ${u}="${l}"`);return{type:"lldb",request:"custom",name:`Test ${n.swiftPackage.name}`,targetCreateCommands:[`file -a ${a} ${o}/xctest`],processCreateCommands:[...c,`process launch -e ${t} -w ${r} -- ${e} ${s}/debug/${n.swiftPackage.name}PackageTests.xctest`],preLaunchTask:`swift: Build All${i}`}}function Gb(n,e,t){t.forEach(r=>{if(r.includes(".")){let[i,s]=r.split(".",2);if(n[i]===void 0)n[i]=e[i];else if(e[i]===void 0){let o=Object.keys(n[i]);o.length===1&&o[0]===s?n[i]=void 0:n[i][s]=void 0}else n[i][s]=e[i][s]}else n[r]=e[r]})}var vt=ne(require("vscode"));var $t=class{constructor(e,t,r){this.major=e;this.minor=t;this.patch=r}static fromString(e){let t=e.match(/(\d+).(\d+)(?:.(\d+))?/);if(t){let r=parseInt(t[1]),i=parseInt(t[2]);if(t[3]===void 0)return new $t(r,i,0);{let s=parseInt(t[3]);return new $t(r,i,s)}}}toString(){return`${this.major}.${this.minor}.${this.patch}`}isLessThan(e){return this.major<e.major?!0:this.major>e.major?!1:this.minor<e.minor?!0:this.minor>e.minor?!1:this.patch<e.patch}isGreaterThan(e){return this.major>e.major?!0:this.major<e.major?!1:this.minor>e.minor?!0:this.minor<e.minor?!1:this.patch>e.patch}isLessThanOrEqual(e){return!this.isGreaterThan(e)}isGreaterThanOrEqual(e){return!this.isLessThan(e)}};function Yb(n){if(n.workspaceContext.swiftVersion.isLessThan(new $t(5,1,0)))return[];if(process.platform!=="darwin"){let e=n.linuxMain.exists,t=n.workspaceContext.swiftVersion.isGreaterThanOrEqual(new $t(5,4,0));if(e||!t)return["--enable-test-discovery"]}return[]}function pf(){return process.platform==="win32"?["-Xswiftc","-g","-Xswiftc","-use-ld=lld","-Xlinker","-debug:dwarf"]:[]}function Jb(n){let e=[...pf()];n.swiftPackage.getTargets("test").length>0&&e.push(...Yb(n));let t=Bt.buildAllName;return n.relativePath.length>0&&(t+=` (${n.relativePath})`),hn(["build","--build-tests",...e,...te.buildArguments],t,{group:vt.TaskGroup.Build,cwd:n.folder,scope:n.workspaceFolder,presentationOptions:{reveal:vt.TaskRevealKind.Silent},problemMatcher:te.problemMatchCompileErrors?"$swiftc":void 0})}async function Jo(n){let e=await vt.tasks.fetchTasks({type:"swift"}),t=Bt.buildAllName;n.relativePath.length>0&&(t+=` (${n.relativePath})`);let r=e.find(i=>i.name===`swift: ${t}`&&i.definition.cwd===n.folder.fsPath&&i.source==="Workspace");if(r)return r;if(r=e.find(i=>i.name===t&&i.definition.cwd===n.folder.fsPath&&i.source==="swift"),!r)throw Error("Build All Task does not exist");return r}function Zb(n,e){let t="";return e.relativePath.length>0&&(t=` (${e.relativePath})`),[hn(["build","--product",n.name,...pf(),...te.buildArguments],`Build Debug ${n.name}${t}`,{group:vt.TaskGroup.Build,cwd:e.folder,scope:e.workspaceFolder,presentationOptions:{reveal:vt.TaskRevealKind.Silent},problemMatcher:te.problemMatchCompileErrors?"$swiftc":void 0}),hn(["build","-c","release","--product",n.name,...te.buildArguments],`Build Release ${n.name}${t}`,{group:vt.TaskGroup.Build,cwd:e.folder,scope:e.workspaceFolder,presentationOptions:{reveal:vt.TaskRevealKind.Silent},problemMatcher:te.problemMatchCompileErrors?"$swiftc":void 0})]}function hn(n,e,t){var o,a;let r=Yr();n=Wc(n);let i=new vt.Task({type:"swift",command:r,args:n,cwd:(o=t==null?void 0:t.cwd)==null?void 0:o.fsPath},(t==null?void 0:t.scope)??vt.TaskScope.Workspace,e,"swift",new vt.ShellExecution(r,n,{cwd:(a=t==null?void 0:t.cwd)==null?void 0:a.fsPath,env:Ve(Ve({},te.swiftEnvironmentVariables),En())}),t==null?void 0:t.problemMatcher),s;return(t==null?void 0:t.prefix)?s=`(${t.prefix}) `:s="",i.detail=`${s}swift ${n.join(" ")}`,i.group=t==null?void 0:t.group,i.presentationOptions=(t==null?void 0:t.presentationOptions)??{},i}var Bt=class{constructor(e){this.workspaceContext=e}async provideTasks(e){if(this.workspaceContext.folders.length===0)return[];let t=[];for(let r of this.workspaceContext.folders){if(!r.swiftPackage.foundPackage)continue;t.push(Jb(r));let i=r.swiftPackage.executableProducts;for(let s of i)t.push(...Zb(s,r))}return t}resolveTask(e,t){let r=Yr(),i=new vt.Task(e.definition,e.scope??vt.TaskScope.Workspace,e.name??"Custom Task","swift",new vt.ShellExecution(r,e.definition.args,{cwd:e.definition.cwd}),e.problemMatchers);return i.detail=e.detail??`${e.definition.command} ${e.definition.args.join(" ")}`,i.group=e.group,i.presentationOptions=e.presentationOptions,i}};Bt.buildAllName="Build All",Bt.cleanBuildName="Clean Build Artifacts",Bt.resolvePackageName="Resolve Package Dependencies",Bt.updatePackageName="Update Package Dependencies";var xi=class{constructor(e,t,r){this.request=e;this.folderContext=t;this.controller=r;this.testRun=this.controller.createTestRun(this.request),this.testItems=this.createTestList(),this.currentTestItem=void 0}get workspaceContext(){return this.folderContext.workspaceContext}static setupProfiles(e,t){e.createRunProfile("Run",Be.TestRunProfileKind.Run,async(r,i)=>{await new xi(r,t,e).runHandler(!1,i)}),e.createRunProfile("Debug",Be.TestRunProfileKind.Debug,async(r,i)=>{await new xi(r,t,e).runHandler(!0,i)})}createTestList(){var r;let e=[];this.request.include?this.request.include.forEach(i=>e.push(i)):this.controller.items.forEach(i=>e.push(i));let t=[];for(;e.length>0;){let i=e.pop();if(!((r=this.request.exclude)==null?void 0:r.includes(i))){if(i.children.size>0){i.children.forEach(s=>e.push(s));continue}t.push(i)}}return t}async runHandler(e,t){try{let r=await Jo(this.folderContext),i=await this.folderContext.taskQueue.queueOperation({task:r},t);if(i===void 0||i!==0){this.testRun.end();return}this.setTestsEnqueued(),e?await this.debugSession(t):await this.runSession(t)}catch(r){let i=r;if(i&&i.error&&i.error.message.startsWith("Command failed")){this.testRun.end();return}if(this.currentTestItem){let s=new Be.TestMessage(qn(r));this.testRun.errored(this.currentTestItem,s)}this.testRun.appendOutput(`\r
Error: ${qn(r)}`)}this.testRun.end()}createLaunchConfigurationForTesting(e,t=null){let r=this.testItems.map(i=>i.id).join(",");if(process.platform==="darwin")if(e&&t){let i=hf(this.folderContext,`-XCTest ${r}`,t);return i===null?null:i}else{let i=Vc(this.folderContext,!0);return i===null?null:(i.args=["-XCTest",r,...i.args],i.stdio=[null,null,t],i)}else{let i=Vc(this.folderContext,!0);return i===null?null:(i.args=[r],i.stdio=[null,t,null],i)}}async runSession(e){let t=this.createLaunchConfigurationForTesting(!1);if(t===null)return;let r=new gf.Writable({write:(o,a,c)=>{let u=o.toString();this.testRun.appendOutput(u.replace(/\n/g,`\r
`)),process.platform==="darwin"?this.parseResultDarwin(u):this.parseResultNonDarwin(u),c()}}),i=r,s=r;if(e.isCancellationRequested){r.end();return}this.testRun.appendOutput(`> Test run started at ${new Date().toLocaleString()} <\r
\r
`),Be.commands.executeCommand("testing.showMostRecentOutput"),await of(t.program,t.args,i,s,e,{cwd:t.cwd,env:Ve(Ve({},process.env),t.env),maxBuffer:16*1024*1024},this.folderContext,!1)}async debugSession(e){let t=this.workspaceContext.tempFolder.filename("TestOutput","txt"),r=this.createLaunchConfigurationForTesting(!0,t);if(r===null)return;if(r.preLaunchTask=void 0,te.diagnostics){let o=JSON.stringify(r);this.workspaceContext.outputChannel.logDiagnostic(`Debug Config: ${o}`,this.folderContext.name)}let i=[],s=Be.debug.onDidStartDebugSession(o=>{this.workspaceContext.outputChannel.logDiagnostic("Start Test Debugging",this.folderContext.name);let a=e.onCancellationRequested(()=>{this.workspaceContext.outputChannel.logDiagnostic("Test Debugging Cancelled",this.folderContext.name),Be.debug.stopDebugging(o)});i.push(a)});return i.push(s),new Promise((o,a)=>{Be.debug.startDebugging(this.folderContext.workspaceFolder,r).then(c=>{if(c){this.testRun.appendOutput(`> Test run started at ${new Date().toLocaleString()} <\r
\r
`),Be.commands.executeCommand("testing.showMostRecentOutput");let u=Be.debug.onDidTerminateDebugSession(async()=>{this.workspaceContext.outputChannel.logDiagnostic("Stop Test Debugging",this.folderContext.name);try{if(!e.isCancellationRequested){let l=await Ei.readFile(t,{encoding:"utf8"});this.testRun.appendOutput(l.replace(/\n/g,`\r
`)),process.platform==="darwin"?this.parseResultDarwin(l):this.parseResultNonDarwin(l)}Ei.rm(t)}catch{}i.forEach(l=>l.dispose()),o()});i.push(u)}else Ei.rm(t),i.forEach(u=>u.dispose()),a()},c=>{Ei.rm(t),i.forEach(u=>u.dispose()),a(c)})})}parseResultDarwin(e){let t=e.split(`
`).map(r=>r.trim());for(let r of t){let i=/^Test Case '-\[(\S+)\s(.*)\]' started./.exec(r);if(i){let c=`${i[1]}/${i[2]}`,u=this.testItems.findIndex(l=>l.id===c);u!==-1&&(this.testRun.started(this.testItems[u]),this.currentTestItem=this.testItems[u]);continue}let s=/^Test Case '-\[(\S+)\s(.*)\]' passed \((\d.*) seconds\)/.exec(r);if(s){let c=`${s[1]}/${s[2]}`,u=+s[3],l=this.testItems.findIndex(h=>h.id===c);l!==-1&&(this.testRun.passed(this.testItems[l],u*1e3),this.testItems.splice(l,1)),this.currentTestItem=void 0;continue}let o=/^(.+):(\d+):\serror:\s-\[(\S+)\s(.*)\] : (.*)$/.exec(r);if(o){let c=`${o[3]}/${o[4]}`,u=this.testItems.findIndex(l=>l.id===c);if(u!==-1){let l=new Be.TestMessage(o[5]);l.location=new Be.Location(Be.Uri.file(o[1]),new Be.Position(parseInt(o[2])-1,0)),this.testRun.failed(this.testItems[u],l),this.testItems.splice(u,1)}this.currentTestItem=void 0;continue}let a=/^(.+):(\d+):\s-\[(\S+)\s(.*)\] : Test skipped/.exec(r);if(a){let c=`${a[3]}/${a[4]}`,u=this.testItems.findIndex(l=>l.id===c);u!==-1&&(this.testRun.skipped(this.testItems[u]),this.testItems.splice(u,1)),this.currentTestItem=void 0;continue}}}parseResultNonDarwin(e){let t=e.split(`
`).map(r=>r.trim());for(let r of t){let i=/^Test Case '(.*)\.(.*)' started/.exec(r);if(i){let a=`${i[1]}/${i[2]}`,c=this.testItems.findIndex(u=>u.id.endsWith(a));c!==-1&&(this.testRun.started(this.testItems[c]),this.currentTestItem=this.testItems[c]);continue}let s=/^(.+):(\d+):\serror:\s*(.*)\.(.*) : (.*)/.exec(r);if(s){let a=`${s[3]}/${s[4]}`,c=this.testItems.findIndex(u=>this.isTestWithFilenameInTarget(a,s[1],u));if(c===-1&&(c=this.testItems.findIndex(u=>u.id.endsWith(a))),c!==-1){let u=new Be.TestMessage(s[5]);u.location=new Be.Location(Be.Uri.file(s[1]),new Be.Position(parseInt(s[2]),0)),this.testRun.failed(this.testItems[c],u),this.testItems.splice(c,1)}this.currentTestItem=void 0;continue}let o=/^(.+):(\d+):\s*(.*)\.(.*) : Test skipped:/.exec(r);if(o){let a=`${o[3]}/${o[4]}`,c=this.testItems.findIndex(u=>this.isTestWithFilenameInTarget(a,o[1],u));c===-1&&(c=this.testItems.findIndex(u=>u.id.endsWith(a))),c!==-1&&(this.testRun.skipped(this.testItems[c]),this.testItems.splice(c,1)),this.currentTestItem=void 0;continue}}for(let r of t){let i=/^Test Case '(.*)\.(.*)' passed \((\d.*) seconds\)/.exec(r);if(i){let s=`${i[1]}/${i[2]}`,o=+i[3],a=this.testItems.findIndex(c=>c.id.endsWith(s));a!==-1&&(this.testRun.passed(this.testItems[a],o),this.testItems.splice(a,1)),this.currentTestItem=void 0;continue}}}isTestWithFilenameInTarget(e,t,r){var o;if(!r.id.endsWith(e))return!1;let i=(o=r.parent)==null?void 0:o.parent;if(!i)return!1;let s=this.folderContext.swiftPackage.targets.find(a=>i.label===a.name);if(s){let a=t,c=Zo.join(this.folderContext.folder.fsPath,s.path),u=Zo.relative(c,a);return s.sources.find(l=>l===u)!==void 0}return!1}setTestsEnqueued(){for(let e of this.testItems)this.testRun.enqueued(e)}};var Ds=ne(require("vscode")),ea=ne(require("path"));var Xc=class{constructor(e,t,r){this.uri=e;this.folderContext=t;this.controller=r;var i;this.targetName=(i=this.getTarget(e))==null?void 0:i.name,this.classes=[],this.functions=[]}includesFunction(e,t,r){return e!==this.targetName?!1:this.functions.find(i=>i.className===t&&i.funcName===r)!==void 0}addTestItems(){if(!this.targetName)return;let e=this.controller.items.get(this.targetName);!e||this.addTestItemsToTarget(e)}updateTestItems(e){if(!this.targetName)return;let t=this.parseSymbolList(e),r=this.controller.items.get(this.targetName);if(!r){this.functions=t.functions,this.classes=t.classes;return}let i=t.functions,s=[];this.functions.forEach(o=>{i.find(a=>o.className===a.className&&o.funcName===a.funcName)||s.push(o)}),this.functions=i,this.classes=t.classes,this.addTestItemsToTarget(r);for(let o of s){let a=`${this.targetName}.${o.className}`,c=r.children.get(a);if(!c)continue;let u=`${this.targetName}.${o.className}/${o.funcName}`;c.children.delete(u)}r.children.forEach(o=>{o.children.size===0&&r.children.delete(o.id)})}addTestItemsToTarget(e){let t=e.id;for(let r of this.classes){let i=`${t}.${r.className}`,s=e.children.get(i);if(!!s)if(s.uri)s.range=r.range;else{let o=s.children;e.children.delete(i);let a=this.controller.createTestItem(i,r.className,this.uri);o.forEach(c=>a.children.add(c)),a.range=r.range,e.children.add(a)}}for(let r of this.functions){let i=`${t}.${r.className}`,s=e.children.get(i);if(!s)continue;let o=`${t}.${r.className}/${r.funcName}`,a=s.children.get(o);if(a)if(a.uri)a.range=r.range;else{s.children.delete(o);let c=this.controller.createTestItem(o,r.funcName,this.uri);c.range=r.range,s.children.add(c)}else{let c=this.controller.createTestItem(o,r.funcName,this.uri);c.range=r.range,s.children.add(c)}}}parseSymbolList(e){let t=[],r=[];return e.filter(s=>s.kind===Ds.SymbolKind.Class||s.kind===Ds.SymbolKind.Namespace).forEach(s=>{var a;s.kind===Ds.SymbolKind.Class&&t.push({className:s.name,range:s.range});let o=(a=s.children)==null?void 0:a.filter(c=>c.kind===Ds.SymbolKind.Method&&c.name.match(/^test.*\(\)/));o==null||o.forEach(c=>{r.push({className:s.name,funcName:c.name.slice(0,-2),range:c.range})})}),{classes:t,functions:r}}getTarget(e){return Gn(e.fsPath,this.folderContext.folder.fsPath)?this.folderContext.swiftPackage.getTargets("test").find(i=>{let s=ea.relative(ea.join(this.folderContext.folder.fsPath,i.path),e.fsPath);return i.sources.find(o=>o===s)!==void 0}):void 0}};var Ts=class{constructor(e){this.folderContext=e;this.controller=ta.tests.createTestController(e.name,`${e.name} Tests`),this.controller.resolveHandler=async r=>{r||await this.discoverTestsInWorkspace()},xi.setupProfiles(this.controller,this.folderContext);let t=e.workspaceContext.tasks.onDidEndTaskProcess(r=>{var o;let i=r.execution.task,s=i.execution;i.scope===this.folderContext.workspaceFolder&&i.group===ta.TaskGroup.Build&&((o=s==null?void 0:s.options)==null?void 0:o.cwd)===this.folderContext.folder.fsPath&&r.exitCode===0&&this.discoverTestsInWorkspace()});this.subscriptions=[t,this.controller]}dispose(){this.subscriptions.forEach(e=>e.dispose())}static observeFolders(e){return e.observeFolders((t,r,i)=>{var s;switch(r){case _e.add:t==null||t.addTestExplorer(),(s=t==null?void 0:t.testExplorer)==null||s.discoverTestsInWorkspace();break;case _e.focus:t&&(i.languageClientManager.documentSymbolWatcher=(o,a)=>Ts.onDocumentSymbols(t,o,a))}})}static onDocumentSymbols(e,t,r){var o;let i=t==null?void 0:t.uri,s=e==null?void 0:e.testExplorer;s&&r&&i&&i.scheme==="file"&&Gn(i.fsPath,e.folder.fsPath)&&(((o=s.lspFunctionParser)==null?void 0:o.uri)===i||(s.lspFunctionParser=new Xc(i,e,s.controller)),s.lspFunctionParser.updateTestItems(r))}async discoverTestsInWorkspace(){var e;try{let{stdout:t}=await qr(["test","--skip-build","--list-tests"],{cwd:this.folderContext.folder.fsPath},this.folderContext);this.deleteErrorTestItem();let r=t.match(/^.*\.[a-zA-Z0-9_]*\/[a-zA-Z0-9_]*$/gm);if(!r)return;this.controller.items.forEach(i=>{i.children.forEach(s=>{s.children.forEach(o=>{var c;let a=`${i.label}.${s.label}/${o.label}`;!r.find(u=>u===a)&&!((c=this.lspFunctionParser)==null?void 0:c.includesFunction(i.label,s.label,o.label))&&s.children.delete(o.id)}),s.children.size===0&&i.children.delete(s.id)})});for(let i of r){let s=/^([\w\d_]*)\.([\w\d_]*)\/([\w\d_]*)/.exec(i);if(!s)continue;let o=this.controller.items.get(s[1]);o||(o=this.controller.createTestItem(s[1],s[1]),this.controller.items.add(o));let a=o.children.get(`${s[1]}.${s[2]}`);a||(a=this.controller.createTestItem(`${s[1]}.${s[2]}`,s[2]),o.children.add(a));let c=this.controller.createTestItem(i,s[3]);a.children.add(c)}(e=this.lspFunctionParser)==null||e.addTestItems()}catch(t){let r=qn(t);process.platform==="darwin"&&r.match(/error: unableToLoadBundle/)||process.platform==="win32"&&r.match(/The file doesn’t exist./)||!["darwin","win32"].includes(process.platform)&&r.match(/No such file or directory/)?this.setErrorTestItem("Build the project to enable test discovery."):this.setErrorTestItem(r),this.folderContext.workspaceContext.outputChannel.log(`Test Discovery Failed: ${r}`,this.folderContext.name)}}deleteErrorTestItem(){this.controller.items.delete(Ts.errorTestItemId)}setErrorTestItem(e,t="Test Discovery Error"){if(this.deleteErrorTestItem(),this.controller.items.size===0){let r=this.controller.createTestItem(Ts.errorTestItemId,t);r.error=e,this.controller.items.add(r)}}},qi=Ts;qi.errorTestItemId="#Error#";var mf=ne(require("vscode")),vf=ne(require("path"));var Rs=class{constructor(e){this.folderContext=e;this.waitingToRun=!1}static start(e){let t=mf.workspace.onDidSaveTextDocument(r=>{if(te.backgroundCompilation===!1)return;let i=e.folders.find(s=>Gn(r.uri.fsPath,s.folder.fsPath));!i||vf.join(i.folder.fsPath,"Package.swift")!==r.uri.fsPath&&i.backgroundCompilation.runTask()});return{dispose:()=>t.dispose()}}async runTask(){let e=await Jo(this.folderContext);!e||this.folderContext.taskQueue.queueOperation({task:e})}};var yf=class{constructor(e,t,r){this.cb=t;this.token=r;this.promise=void 0;this.task=e.task,this.showStatusItem=e.showStatusItem,this.log=e.log}isEqual(e){let t=e.task.definition.args,r=this.task.definition.args;return t.length!==r.length?!1:t.every((i,s)=>i===r[s])}},Bc=class{constructor(e){this.folderContext=e;this.queue=[],this.workspaceContext=e.workspaceContext,this.activeOperation=void 0}queueOperation(e,t){let r=this.findQueuedOperation(e);if(r&&r.promise!==void 0)return r.promise;if(e.checkAlreadyRunning===!0&&this.activeOperation&&this.activeOperation.promise&&this.activeOperation.isEqual(e))return this.activeOperation.promise;let i=new Promise(s=>{r=new yf(e,o=>{s(o)},t),this.queue.push(r),this.processQueue()});return this.queue.length>0&&!this.queue[this.queue.length-1].promise&&(this.queue[this.queue.length-1].promise=i),i}processQueue(){if(!this.activeOperation){let e=this.queue.shift();if(e){let t=e.task;this.activeOperation=e,e.showStatusItem===!0&&this.workspaceContext.statusItem.start(t),e.log&&this.workspaceContext.outputChannel.logStart(`${e.log} ... `,this.folderContext.name),this.workspaceContext.tasks.executeTaskAndWait(t,e.token).then(r=>{if(e.log)switch(r){case 0:this.workspaceContext.outputChannel.logEnd("done.");break;case void 0:this.workspaceContext.outputChannel.logEnd("cancelled.");break;default:this.workspaceContext.outputChannel.logEnd("failed.");break}this.finishTask(e,r)}).catch(r=>{e.log&&this.workspaceContext.outputChannel.logEnd(`${r}`),this.finishTask(e,void 0)})}}}finishTask(e,t){e.cb(t),e.showStatusItem===!0&&this.workspaceContext.statusItem.end(e.task),this.activeOperation=void 0,this.processQueue()}findQueuedOperation(e){for(let t of this.queue)if(t.isEqual(e))return t}};var Qn=class{constructor(e,t,r,i,s){this.folder=e;this.linuxMain=t;this.swiftPackage=r;this.workspaceFolder=i;this.workspaceContext=s;this.hasResolveErrors=!1;this.packageWatcher=new Uc(this,s),this.packageWatcher.install(),this.backgroundCompilation=new Rs(this),this.taskQueue=new Bc(this)}dispose(){var e,t,r;(e=this.linuxMain)==null||e.dispose(),(t=this.packageWatcher)==null||t.dispose(),(r=this.testExplorer)==null||r.dispose()}static async create(e,t,r){let i=`Loading Package (${Qn.uriName(e)})`;r.statusItem.start(i);let s=await Cs.create(e),o=await ur.create(e);r.statusItem.end(i);let a=new Qn(e,s,o,t,r),c=o.error;return c&&(wf.window.showErrorMessage(`Failed to load ${a.name}/Package.swift: ${c.message}`),r.outputChannel.log(`Failed to load Package.swift: ${c.message}`,a.name)),a}get name(){return this.relativePath.length===0?this.workspaceFolder.name:`${this.workspaceFolder.name}/${this.relativePath}`}get relativePath(){return Ii.relative(this.workspaceFolder.uri.fsPath,this.folder.fsPath)}async reload(){await this.swiftPackage.reload()}async reloadPackageResolved(){await this.swiftPackage.reloadPackageResolved()}async fireEvent(e){this.workspaceContext.fireEvent(this,e)}editedPackageFolder(e){return Ii.join(this.folder.fsPath,"Packages",e)}addTestExplorer(){this.testExplorer=new qi(this)}async getEditedPackages(){let e=await this.swiftPackage.loadWorkspaceState();return(e==null?void 0:e.object.dependencies.filter(t=>t.state.name==="edited"&&t.state.path).map(t=>({name:t.packageRef.identity,folder:t.state.path})))??[]}static uriName(e){return Ii.basename(e.fsPath)}};var Fi=ne(require("vscode")),Cf=ne(require("path")),bf=class{constructor(e){this.task=e}get name(){if(this.task instanceof Fi.Task){let e=this.task.definition.cwd;return e?`${this.task.name} (${Cf.basename(e)})`:this.task.name}else return this.task}},Gc=class{constructor(){this.runningTasks=[];this.item=Fi.window.createStatusBarItem(Fi.StatusBarAlignment.Left)}start(e){if(this.runningTasks.findIndex(r=>r.task===e)!==-1)return;let t=new bf(e);this.runningTasks.push(t),this.show(`$(sync~spin) ${t.name}`)}end(e){let t=this.runningTasks.findIndex(r=>r.task===e);if(t!==-1)if(this.runningTasks.splice(t,1),this.runningTasks.length===0)this.hide();else{let r=this.runningTasks[this.runningTasks.length-1];this.show(`$(sync~spin) ${r.name}`)}}show(e){this.item.text=e,this.item.show()}hide(){this.item.hide()}dispose(){this.item.dispose()}};var Df=ne(require("vscode"));var Qc=class{constructor(){this.channel=Df.window.createOutputChannel("Swift")}dispose(){this.channel.dispose()}log(e,t){let r;t!==void 0?r=`${t}: ${e}`:r=e;let i=`${this.nowFormatted}: ${r}`;this.channel.appendLine(i),console.log(i)}logDiagnostic(e,t){if(!te.diagnostics)return;let r;t!==void 0?r=`${t}: ${e}`:r=e;let i=`${this.nowFormatted}: ${r}`;this.channel.appendLine(i),console.log(i)}logStart(e,t){let r;t!==void 0?r=`${t}: ${e}`:r=e;let i=`${this.nowFormatted}: ${r}`;this.channel.append(i),console.log(i)}logEnd(e){this.channel.appendLine(e),console.log(e)}get nowFormatted(){return new Date().toLocaleString("en-US",{hourCycle:"h23",hour:"2-digit",minute:"numeric",second:"numeric"})}};var Nr=ne(require("path")),na=ne(require("fs/promises"));var Fr=class{constructor(e,t){this.success=e;this.failure=t}static makeSuccess(e){return new Fr(e)}static makeFailure(e){return new Fr(void 0,e)}};async function Tf(n){let e=Nr.join(n.swiftFolderPath,"lldb"),t=Nr.dirname(n.swiftFolderPath);try{let s=["-b","-O","script print('<!' + lldb.SBHostOS.GetLLDBPath(lldb.ePathTypeLLDBShlibDir).fullpath + '!>')"],{stdout:o}=await xn(e,s),a=/^<!([^!]*)!>/m.exec(o);a&&(t=a[1])}catch{if(process.platform==="win32")return Fr.makeFailure(void 0)}let r=await eD(t);return r?Fr.makeSuccess(r):Fr.makeFailure("LLDB failed to provide a library path")}async function eD(n){if((await na.stat(n)).isFile())return n;let t,r;if(process.platform==="linux")t=Nr.join(n,"lib"),r=/liblldb.*\.so.*/;else if(process.platform==="darwin")t=Nr.join(n,"lib"),r=/liblldb\..*dylib|LLDB/;else if(process.platform==="win32")t=Nr.join(n,"bin"),r=/liblldb\.dll/;else return n;for(let i of[n,t]){let s=await tD(i,r);if(s)return Nr.join(i,s)}}async function tD(n,e){try{let t=await na.readdir(n);for(let r of t)if(e.test(r))return r}catch{}return null}var _n=ne(require("vscode")),bc=ne(Cd());var bo=ne(require("vscode"));var kw=ne(Cd()),Ew=new kw.RequestType("sourcekit-lsp/inlayHints");var xw=class{constructor(e){this.client=e}provideInlayHints(e,t,r){if(!te.lsp.inlayHintsEnabled)return null;let i={textDocument:this.client.code2ProtocolConverter.asTextDocumentIdentifier(e),range:{start:t.start,end:t.end}};return this.client.sendRequest(Ew,i,r).then(o=>o.map(a=>{let c=a.label,u;switch(a.category){case"type":u=bo.InlayHintKind.Type,c=`: ${c}`;break;case"parameter":u=bo.InlayHintKind.Parameter;break}return{label:c,position:a.position,kind:u,paddingLeft:!0}}),o=>o)}};function qw(n){return bo.languages.registerInlayHintsProvider(wi.documentSelector,new xw(n))}var Dc=class{constructor(e){this.workspaceContext=e;this.observeFoldersDisposable=e.observeFolders(async(t,r)=>{switch(r){case _e.add:t&&t.folder&&this.isActiveFileInFolder(t.folder)&&await this.setLanguageClientFolder(t.folder);break;case _e.focus:await this.setLanguageClientFolder(t==null?void 0:t.folder);break}}),this.onDidCreateFileDisposable=_n.workspace.onDidCreateFiles(()=>{this.supportsDidChangedWatchedFiles||this.restartLanguageClient()}),this.onDidDeleteFileDisposable=_n.workspace.onDidDeleteFiles(()=>{this.supportsDidChangedWatchedFiles||this.restartLanguageClient()}),this.onChangeConfig=_n.workspace.onDidChangeConfiguration(t=>{t.affectsConfiguration("sourcekit-lsp.serverPath")&&_n.window.showInformationMessage("Changing LSP server path requires the language server be restarted.","Ok").then(r=>{r==="Ok"&&this.restartLanguageClient()})}),this.supportsDidChangedWatchedFiles=e.swiftVersion.isGreaterThanOrEqual(new $t(5,6,0)),this.waitingOnRestartCount=0,this.documentSymbolWatcher=void 0,this.cancellationToken=new _n.CancellationTokenSource}dispose(){var e,t,r,i,s,o;(e=this.cancellationToken)==null||e.cancel(),(t=this.cancellationToken)==null||t.dispose(),this.observeFoldersDisposable.dispose(),(r=this.onDidCreateFileDisposable)==null||r.dispose(),(i=this.onDidDeleteFileDisposable)==null||i.dispose(),this.onChangeConfig.dispose(),(s=this.inlayHints)==null||s.dispose(),(o=this.languageClient)==null||o.stop()}async setLanguageClientFolder(e,t=!1){var r,i,s;if(this.languageClient===void 0){this.currentWorkspaceFolder=e,this.restartedPromise=this.setupLanguageClient(e);return}else{if(e===void 0||this.currentWorkspaceFolder===e&&!t)return;if(this.waitingOnRestartCount+=1,this.restartedPromise)try{await this.restartedPromise}catch{}if(this.waitingOnRestartCount-=1,this.waitingOnRestartCount!==0)return;let o=this.languageClient;this.languageClient=null,this.currentWorkspaceFolder=e,(r=this.inlayHints)==null||r.dispose(),this.inlayHints=void 0,o&&((i=this.cancellationToken)==null||i.cancel(),(s=this.cancellationToken)==null||s.dispose(),this.restartedPromise=o.stop().then(async()=>{await this.setupLanguageClient(e)}).catch(a=>{this.workspaceContext.outputChannel.log(`${a}`)}))}}get workspaceFolder(){var e,t,r;return(r=(t=(e=this.languageClient)==null?void 0:e.clientOptions)==null?void 0:t.workspaceFolder)==null?void 0:r.uri}async useLanguageClient(e){var t;if(!this.languageClient)throw bd.LanguageClientUnavailable;return await((t=this.clientReadyPromise)==null?void 0:t.then(()=>{if(!this.languageClient||!this.cancellationToken)throw bd.LanguageClientUnavailable;return e(this.languageClient,this.cancellationToken.token)}))}async restartLanguageClient(){await this.setLanguageClientFolder(this.currentWorkspaceFolder,!0)}isActiveFileInFolder(e){if(_n.window.activeTextEditor&&_n.window.activeTextEditor.document){let t=_n.window.activeTextEditor.document.uri.fsPath;if(Gn(t,e.fsPath))return!0}return!1}setupLanguageClient(e){let t=this.createLSPClient(e);return this.startClient(t)}createLSPClient(e){var l;let t=te.lsp,r=t.serverPath,i=r.length>0?r:Yr("sourcekit-lsp"),s=[...cf(!0),...df(te.buildArguments.concat(Go()),Dc.buildArgumentFilter)],o={command:i,args:t.serverArguments.concat(s),options:{env:Ve(Ve(Ve({},process.env),te.swiftEnvironmentVariables),En())}};r.length>0&&te.path.length>0&&r!==Yr("sourcekit-lsp")&&te.path&&(o.options={env:Bo(Ve({},(l=o.options)==null?void 0:l.env),{SOURCEKIT_TOOLCHAIN_PATH:this.workspaceContext.toolchain.toolchainPath})});let a=o,c;e&&(c={uri:e,name:Qn.uriName(e),index:0});let u={documentSelector:Dc.documentSelector,revealOutputChannelOn:bc.RevealOutputChannelOn.Never,workspaceFolder:c,middleware:{provideDocumentSymbols:async(h,p,C)=>{let T=await C(h,p),y=T;return this.documentSymbolWatcher&&y&&this.documentSymbolWatcher(h,y),T}}};return new bc.LanguageClient("sourcekit-lsp","SourceKit Language Server",a,u)}startClient(e){return e.clientOptions.workspaceFolder?this.workspaceContext.outputChannel.log(`SourceKit-LSP setup for ${Qn.uriName(e.clientOptions.workspaceFolder.uri)}`):this.workspaceContext.outputChannel.log("SourceKit-LSP setup"),this.clientReadyPromise=e.start().then(()=>{this.inlayHints=qw(e)}).catch(t=>{var r;throw this.workspaceContext.outputChannel.log(`${t}`),(r=this.languageClient)==null||r.stop(),this.languageClient=void 0,t}),this.languageClient=e,this.cancellationToken=new _n.CancellationTokenSource,this.clientReadyPromise}},wi=Dc;wi.documentSelector=[{scheme:"file",language:"swift"},{scheme:"untitled",language:"swift"},{scheme:"file",language:"c"},{scheme:"untitled",language:"c"},{scheme:"file",language:"cpp"},{scheme:"untitled",language:"cpp"},{scheme:"file",language:"objective-c"},{scheme:"untitled",language:"objective-c"},{scheme:"file",language:"objective-cpp"},{scheme:"untitled",language:"objective-cpp"}],wi.buildArgumentFilter=[{argument:"--build-path",include:1},{argument:"-Xswiftc",include:1},{argument:"-Xcc",include:1},{argument:"-Xcxx",include:1},{argument:"-Xlinker",include:1},{argument:"-Xclangd",include:1},{argument:"-index-store-path",include:1}];var bd=(e=>(e[e.LanguageClientUnavailable=0]="LanguageClientUnavailable",e))(bd||{});var Iw=ne(require("os")),Dd=ne(require("path")),Fw=ne(require("fs/promises"));var Do=class{constructor(e){this.path=e}filename(e,t){let r;return t?r=`${e}${Hc(16)}.${t}`:r=`${e}${Hc(16)}`,Dd.join(this.path,r)}static async create(){let e=Dd.join((0,Iw.tmpdir)(),"vscode-swift");try{await Fw.mkdir(e)}catch{}return new Do(e)}};var Ic=ne(require("fs/promises")),ct=ne(require("path")),bb=ne(Cb()),Db=ne(require("vscode"));var Vo=class{constructor(e,t,r,i,s,o,a,c,u){this.swiftFolderPath=e;this.toolchainPath=t;this.swiftVersionString=r;this.swiftVersion=i;this.runtimePath=s;this.defaultTarget=o;this.defaultSDK=a;this.customSDK=c;this.xcTestPath=u}static async create(){var u;let e=await this.getSwiftFolderPath(),t=await this.getToolchainPath(e),r=await this.getSwiftTargetInfo(),i=await this.getSwiftVersion(r),s=await this.getRuntimePath(r),o=await this.getDefaultSDK(),a=this.getCustomSDK(),c=await this.getXCTestPath(r,i,s,a??o);return new Vo(e,t,r.compilerVersion,i,s,(u=r.target)==null?void 0:u.triple,o,a,c)}logDiagnostics(e){e.logDiagnostic(`Swift Path: ${this.swiftFolderPath}`),e.logDiagnostic(`Toolchain Path: ${this.toolchainPath}`),this.runtimePath&&e.logDiagnostic(`Runtime Library Path: ${this.runtimePath}`),this.defaultTarget&&e.logDiagnostic(`Default Target: ${this.defaultTarget}`),this.defaultSDK&&e.logDiagnostic(`Default SDK: ${this.defaultSDK}`),this.customSDK&&e.logDiagnostic(`Custom SDK: ${this.customSDK}`),this.xcTestPath&&e.logDiagnostic(`XCTest Path: ${this.xcTestPath}`)}static async getSwiftFolderPath(){if(te.path!=="")return te.path;try{let e;switch(process.platform){case"darwin":{let{stdout:r}=await xn("which",["swift"]);e=r.trimEnd();break}case"win32":{let{stdout:r}=await xn("where",["swift"]);e=r.trimEnd();break}default:{let{stdout:r}=await xn("/bin/sh",["-c","type swift"]),i=/^swift is (.*)$/.exec(r.trimEnd());if(i)e=i[1];else throw Error("Failed to find swift executable");break}}let t=await Ic.realpath(e);return ct.dirname(t)}catch{throw Error("Failed to find swift executable")}}static async getToolchainPath(e){if(te.path!=="")return ct.dirname(ct.dirname(te.path));try{switch(process.platform){case"darwin":{let{stdout:t}=await xn("xcrun",["--find","swift"]),r=t.trimEnd();return ct.dirname(ct.dirname(ct.dirname(r)))}default:return ct.dirname(ct.dirname(ct.dirname(e)))}}catch{throw Error("Failed to find swift toolchain")}}static async getRuntimePath(e){if(te.runtimePath!=="")return te.runtimePath;if(process.platform==="win32"){let{stdout:t}=await xn("where",["swiftCore.dll"]),r=t.trimEnd();return r.length>0?ct.dirname(r):void 0}else return e.paths.runtimeLibraryPaths.length>0?e.paths.runtimeLibraryPaths.join(":"):void 0}static async getDefaultSDK(){switch(process.platform){case"darwin":{if(process.env.SDKROOT)return process.env.SDKROOT;let{stdout:e}=await xn("xcrun",["--sdk","macosx","--show-sdk-path"]);return ct.join(e.trimEnd())}case"win32":return process.env.SDKROOT}}static getCustomSDK(){return te.sdk!==""?te.sdk:void 0}static async getXCTestPath(e,t,r,i){var s;switch(process.platform){case"darwin":{let{stdout:o}=await xn("xcode-select",["-p"]);return ct.join(o.trimEnd(),"usr","bin")}case"win32":{let o=r!==void 0&&await cr(ct.join(r,"XCTest.dll"))?r:void 0;if(!i)return o;let a=ct.dirname(ct.dirname(ct.dirname(i))),c=ct.join(a,"Info.plist");if(await cr(c)!==!0){if(o)return o;Db.window.showWarningMessage("XCTest not found due to non-standardized library layout. Tests explorer won't work as expected.");return}let u=await Ic.readFile(c,"utf8"),h=bb.parse(u).DefaultProperties.XCTEST_VERSION;if(!h)throw Error("Info.plist is missing the XCTEST_VERSION key.");if(t>=new $t(5,7,0)){let p,C=(s=e.target)==null?void 0:s.triple.split("-",1)[0];switch(C){case"x86_64":p="bin64";break;case"i686":p="bin32";break;case"aarch64":p="bin64a";break;default:throw Error(`unsupported architecture ${C}`)}return ct.join(a,"Developer","Library",`XCTest-${h}`,"usr",p)}else return ct.join(a,"Developer","Library",`XCTest-${h}`,"usr","bin")}}}static async getSwiftTargetInfo(){try{let{stdout:e}=await qr(["-print-target-info"]);return JSON.parse(e.trimEnd())}catch{throw Error("Cannot parse swift target info output.")}}static getSwiftVersion(e){let t=e.compilerVersion.match(/Swift version ([\S]+)/),r;return t&&(r=$t.fromString(t[1])),r??new $t(0,0,0)}};var Fc=ne(require("vscode")),Ud=class{constructor(){this.observers=new Set;this.onDidEndTaskProcessDisposible=Fc.tasks.onDidEndTaskProcess(e=>{this.observers.forEach(t=>t(e))}),this.onDidEndTaskDisposible=Fc.tasks.onDidEndTaskProcess(e=>{this.observers.forEach(t=>t({execution:e.execution,exitCode:void 0}))})}onDidEndTaskProcess(e){return this.observers.add(e),{dispose:()=>{this.removeObserver(e)}}}async executeTaskAndWait(e,t){return new Promise(r=>{let i=this.onDidEndTaskProcess(s=>{s.execution.task.definition===e.definition&&(i.dispose(),r(s.exitCode))});Fc.tasks.executeTask(e).then(s=>{t==null||t.onCancellationRequested(()=>{s.terminate(),i.dispose(),r(void 0)})})})}removeObserver(e){this.observers.delete(e)}dispose(){this.onDidEndTaskDisposible.dispose(),this.onDidEndTaskProcessDisposible.dispose()}};var Xo=class{constructor(e,t){this.tempFolder=e;this.toolchain=t;this.folders=[];this.observers=new Set;this.outputChannel=new Qc,this.statusItem=new Gc,this.languageClientManager=new wi(this),this.outputChannel.log(this.toolchain.swiftVersionString),this.toolchain.logDiagnostics(this.outputChannel),this.tasks=new Ud;let r=Ne.workspace.onDidChangeConfiguration(s=>{if(s.affectsConfiguration("swift.path")&&Ne.window.showInformationMessage("Changing the Swift path requires the project be reloaded.","Ok").then(o=>{o==="Ok"&&Ne.commands.executeCommand("workbench.action.reloadWindow")}),s.affectsConfiguration("swift.SDK")&&Ne.window.showInformationMessage("Changing the Swift SDK path requires the project be reloaded.","Ok").then(o=>{o==="Ok"&&Ne.commands.executeCommand("workbench.action.reloadWindow")}),s.affectsConfiguration("swift.runtimePath")){if(!te.autoGenerateLaunchConfigurations)return;Ne.window.showInformationMessage(`Launch configurations need to be updated after changing the Swift runtime path. Custom versions of environment variable '${ws()}' may be overridden. Do you want to update?`,"Update","Cancel").then(async o=>{o==="Update"&&this.folders.forEach(async a=>await bs(a,!0))})}if(s.affectsConfiguration("swift.buildPath")){if(!te.autoGenerateLaunchConfigurations)return;Ne.window.showInformationMessage("Launch configurations need to be updated after changing the Swift build path. Do you want to update?","Update","Cancel").then(async o=>{o==="Update"&&this.folders.forEach(async a=>await bs(a,!0))})}}),i=Rs.start(this);this.subscriptions=[i,r,this.tasks,this.languageClientManager,this.outputChannel,this.statusItem]}dispose(){this.folders.forEach(e=>e.dispose()),this.subscriptions.forEach(e=>e.dispose())}get swiftVersion(){return this.toolchain.swiftVersion}static async create(){let e=await Do.create(),t=await Vo.create();return new Xo(e,t)}setupEventListeners(){let e=Ne.workspace.onDidChangeWorkspaceFolders(r=>{if(this===void 0){console.log("Trying to run onDidChangeWorkspaceFolders on deleted context");return}this.onDidChangeWorkspaceFolders(r)}),t=Ne.window.onDidChangeActiveTextEditor(async r=>{if(this===void 0){console.log("Trying to run onDidChangeWorkspaceFolders on deleted context");return}await this.focusTextEditor(r)});this.subscriptions.push(e,t)}async addWorkspaceFolders(){if(Ne.workspace.workspaceFolders&&Ne.workspace.workspaceFolders.length>0)for(let e of Ne.workspace.workspaceFolders)await this.addWorkspaceFolder(e);this.currentFolder===void 0&&(this.folders.length===1?await this.fireEvent(this.folders[0],_e.focus):await this.fireEvent(null,_e.focus))}async fireEvent(e,t){for(let r of this.observers)await r(e,t,this)}async focusFolder(e){e!==this.currentFolder&&(this.currentFolder!==void 0&&await this.fireEvent(this.currentFolder,_e.unfocus),this.currentFolder=e,await this.fireEvent(e,_e.focus))}async onDidChangeWorkspaceFolders(e){for(let t of e.added)await this.addWorkspaceFolder(t);for(let t of e.removed)await this.removeFolder(t)}async addWorkspaceFolder(e){await cr(e.uri.fsPath,"Package.swift")&&await this.addPackageFolder(e.uri,e),this.getActiveWorkspaceFolder(Ne.window.activeTextEditor)===e&&await this.focusTextEditor(Ne.window.activeTextEditor)}async addPackageFolder(e,t){let r=await Qn.create(e,t,this);return this.folders.push(r),await this.fireEvent(r,_e.add),r}async removeFolder(e){let t=this.folders.findIndex(s=>s.workspaceFolder===e);if(t===-1){console.error(`Trying to delete folder ${e} which has no record`);return}let r=this.folders[t];this.currentFolder===r&&this.focusFolder(null);let i=[...this.observers];i.reverse();for(let s of i)await s(r,_e.remove,this);r.dispose(),this.folders.splice(t,1)}observeFolders(e){return this.observers.add(e),{dispose:()=>this.observers.delete(e)}}async setLLDBVersion(){let e=await Tf(this.toolchain);if(!e.success){if(!e.failure)return;let s=`Error: ${qn(e.failure)}`;Ne.window.showErrorMessage(`Failed to setup CodeLLDB for debugging of Swift code. Debugging may produce unexpected results. ${s}`),this.outputChannel.log(`Failed to setup CodeLLDB: ${s}`);return}let t=e.success,r=Ne.workspace.getConfiguration("lldb");r.get("library")!==t&&Ne.window.showInformationMessage("CodeLLDB requires the correct Swift version of LLDB for debugging. Do you want to set this up in your global settings or the workspace settings?","Global","Workspace","Cancel").then(s=>{switch(s){case"Global":r.update("library",t,Ne.ConfigurationTarget.Global),r.update("library",void 0,Ne.ConfigurationTarget.Workspace);break;case"Workspace":r.update("library",t,Ne.ConfigurationTarget.Workspace);break}})}async focusTextEditor(e){!e||!e.document||e.document.uri.scheme!=="file"||await this.focusUri(e.document.uri)}async focusUri(e){let t=await this.getPackageFolder(e);if(t instanceof Qn)await this.focusFolder(t);else if(t instanceof Ne.Uri){let r=Ne.workspace.getWorkspaceFolder(t);if(!r)return;await this.unfocusCurrentFolder();let i=await this.addPackageFolder(t,r);await this.focusFolder(i)}else await this.focusFolder(null)}getWorkspaceFolder(e){return Ne.workspace.getWorkspaceFolder(e)}getActiveWorkspaceFolder(e){if(!(!e||!e.document))return Ne.workspace.getWorkspaceFolder(e.document.uri)}async getPackageFolder(e){let t=this.folders.find(a=>Gn(e.fsPath,a.folder.fsPath));if(t)return t;let r=this.getWorkspaceFolder(e);if(!r)return;let i=r.uri.fsPath,s,o=Kd.dirname(e.fsPath);for(await cr(o,"Package.swift")&&(s=o);o!==i;)o=Kd.dirname(o),await cr(o,"Package.swift")&&(s=o);if(s)return Ne.Uri.file(s)}async unfocusCurrentFolder(){this.currentFolder!==void 0&&await this.fireEvent(this.currentFolder,_e.unfocus),this.currentFolder=void 0}},_e=(o=>(o.add="add",o.remove="remove",o.focus="focus",o.unfocus="unfocus",o.packageUpdated="packageUpdated",o.resolvedUpdated="resolvedUpdated",o))(_e||{});var tn=ne(require("vscode")),Nc=ne(require("fs/promises")),Vd=ne(require("path"));var zd=ne(require("vscode")),aq={set hasPackage(n){zd.commands.executeCommand("setContext","swift.hasPackage",n)},set packageHasDependencies(n){zd.commands.executeCommand("setContext","swift.packageHasDependencies",n)}},Ri=aq;var Kn=class{constructor(e,t,r,i){this.name=e;this.path=t;this.version=r;this.type=i}toTreeItem(){let e=new tn.TreeItem(this.name,tn.TreeItemCollapsibleState.Collapsed);return e.id=this.path,e.description=this.version,e.iconPath=this.type==="editing"?new tn.ThemeIcon("edit"):new tn.ThemeIcon("archive"),e.contextValue=this.type,e}},Tb=class{constructor(e,t,r){this.name=e;this.path=t;this.isDirectory=r}toTreeItem(){let e=new tn.TreeItem(this.name,this.isDirectory?tn.TreeItemCollapsibleState.Collapsed:tn.TreeItemCollapsibleState.None);return e.id=this.path,e.resourceUri=tn.Uri.file(this.path),this.isDirectory||(e.command={command:"vscode.open",arguments:[e.resourceUri],title:"Open File"}),e}},Xd=class{constructor(e){this.workspaceContext=e;this.didChangeTreeDataEmitter=new tn.EventEmitter;this.onDidChangeTreeData=this.didChangeTreeDataEmitter.event;Ri.hasPackage=!1,Ri.packageHasDependencies=!1}dispose(){var e;(e=this.workspaceObserver)==null||e.dispose()}observeFolders(e){this.workspaceObserver=this.workspaceContext.observeFolders((t,r)=>{switch(r){case _e.focus:if(!t)return;e.title=`Package Dependencies (${t.name})`,this.updateView(t);break;case _e.unfocus:e.title="Package Dependencies",this.updateView(void 0);break;case _e.resolvedUpdated:if(!t)return;t===this.workspaceContext.currentFolder&&this.updateView(t)}})}updateView(e){if(!e||!e.swiftPackage.foundPackage){Ri.hasPackage=!1,Ri.packageHasDependencies=!1;return}Ri.hasPackage=!0,Ri.packageHasDependencies=e.swiftPackage.dependencies.length>0,this.didChangeTreeDataEmitter.fire()}getTreeItem(e){return e.toTreeItem()}async getChildren(e){let t=this.workspaceContext.currentFolder;if(!t)return[];if(!e){let i=[...this.getLocalDependencies(t),...this.getRemoteDependencies(t)],s=await this.getEditedDependencies(t),o=[];for(let a of i)s.find(u=>u.name===a.name)||o.push(a);return[...o,...s].sort((a,c)=>a.name.localeCompare(c.name))}let r=Ir(t.folder.fsPath,!0);if(e instanceof Kn){let i=e.type==="remote"?Vd.join(r,"checkouts",uf(e.path)):e.path;return this.getNodesInDirectory(i)}else return this.getNodesInDirectory(e.path)}getLocalDependencies(e){return e.swiftPackage.dependencies.filter(t=>!t.requirement&&t.url).map(t=>new Kn(t.identity,t.url,"local","local"))}getRemoteDependencies(e){var t;return((t=e.swiftPackage.resolved)==null?void 0:t.pins.map(r=>new Kn(r.identity,r.location,r.state.version??r.state.branch??r.state.revision.substring(0,7),"remote")))??[]}async getEditedDependencies(e){return(await e.getEditedPackages()).map(t=>new Kn(t.name,t.folder,"local","editing"))}async getNodesInDirectory(e){let t=await Nc.readdir(e),r=[],i=te.excludePathsFromPackageDependencies;for(let s of t){if(i.includes(s))continue;let o=Vd.join(e,s),a=await Nc.stat(o);r.push(new Tb(s,o,a.isDirectory()))}return r.sort((s,o)=>s.isDirectory===o.isDirectory?s.name.localeCompare(o.name):s.isDirectory?-1:1)}};async function cq(n){let e=n.currentFolder;!e||await Oc(e)}async function Oc(n,e){let t=hn(["package","resolve"],Bt.resolvePackageName,{cwd:n.folder,scope:n.workspaceFolder,prefix:n.name,presentationOptions:{reveal:re.TaskRevealKind.Silent}});await Si(t,"Resolving Dependencies",n,!1,e).then(r=>{_b(r,n)})}async function uq(n){let e=n.currentFolder;!e||await lq(e)}async function lq(n){let e=hn(["package","update"],Bt.updatePackageName,{cwd:n.folder,scope:n.workspaceFolder,prefix:n.name,presentationOptions:{reveal:re.TaskRevealKind.Silent}});await Si(e,"Updating Dependencies",n).then(t=>{_b(t,n)})}async function dq(n){let e=n.currentFolder;!e||await fq(e)}async function fq(n){let e=hn(["package","clean"],Bt.cleanBuildName,{cwd:n.folder,scope:n.workspaceFolder,prefix:n.name,presentationOptions:{reveal:re.TaskRevealKind.Silent},group:re.TaskGroup.Clean});await Si(e,"Clean Build",n)}async function hq(n){let e=n.currentFolder;!e||await pq(e)}async function pq(n){let e=hn(["package","reset"],"Reset Package Dependencies",{cwd:n.folder,scope:n.workspaceFolder,prefix:n.name,presentationOptions:{reveal:re.TaskRevealKind.Silent},group:re.TaskGroup.Clean});await Si(e,"Reset Package",n).then(async t=>{if(!t)return;let r=hn(["package","resolve"],Bt.resolvePackageName,{cwd:n.folder,scope:n.workspaceFolder,prefix:n.name,presentationOptions:{reveal:re.TaskRevealKind.Silent}});await Si(r,"Resolving Dependencies",n)})}async function gq(n){var s;let e=(s=re.window.activeTextEditor)==null?void 0:s.document;if(!e)return;if(process.platform==="win32"&&n.toolchain.swiftVersion<new $t(5,7,0)){re.window.showErrorMessage("Run Swift Script is unavailable with the legacy driver on Windows.");return}let t=e.fileName,r=!1;if(e.isUntitled){r=!0,t=n.tempFolder.filename(e.fileName,"swift");let o=e.getText();await gs.writeFile(t,o)}else await e.save();let i=hn([t],`Run ${t}`,{scope:re.TaskScope.Global,cwd:re.Uri.file(Rb.dirname(t)),presentationOptions:{reveal:re.TaskRevealKind.Always,clear:!0}});await n.tasks.executeTaskAndWait(i),r&&await gs.rm(t)}async function mq(n,e){let t=e.currentFolder;!t||re.window.showOpenDialog({canSelectFiles:!1,canSelectFolders:!0,canSelectMany:!1,defaultUri:t.folder,openLabel:"Select",title:"Select folder"}).then(async r=>{if(!r)return;let i=r[0],s=hn(["package","edit","--path",i.fsPath,n],"Edit Package Dependency",{scope:t.workspaceFolder,cwd:t.folder,prefix:t.name});await Si(s,`Use local version of ${n}`,t,!0).then(o=>{o&&e.fireEvent(t,_e.resolvedUpdated)})})}async function vq(n,e){let t=e.currentFolder;if(!t)return;let r=hn(["package","edit",n],"Edit Package Dependency",{scope:t.workspaceFolder,cwd:t.folder,prefix:t.name});await Si(r,`edit locally ${n}`,t,!0).then(i=>{var s;if(i){e.fireEvent(t,_e.resolvedUpdated);let o=((s=re.workspace.workspaceFolders)==null?void 0:s.length)??0;re.workspace.updateWorkspaceFolders(o,0,{uri:re.Uri.file(t.editedPackageFolder(n)),name:n})}})}async function yq(n,e){let t=e.currentFolder;if(!t)return;e.outputChannel.log(`unedit dependency ${n}`,t.name);let r=`Reverting edited dependency ${n} (${t.name})`;e.statusItem.start(r),await Sb(t,n,e),e.statusItem.end(r)}async function Sb(n,e,t,r=[]){var i;try{await qr(["package","unedit",...r,e],{cwd:n.folder.fsPath},n),t.fireEvent(n,_e.resolvedUpdated);let s=(i=re.workspace.workspaceFolders)==null?void 0:i.findIndex(o=>o.name===e);if(s)try{await gs.stat(re.workspace.workspaceFolders[s].uri.fsPath)}catch{re.workspace.updateWorkspaceFolders(s,1)}}catch(s){let o=s;o.stderr.match(/has uncommited changes/)?re.window.showWarningMessage(`${e} has uncommitted changes. Are you sure you want to continue?`,"Yes","No").then(async a=>{if(a==="No"){t.outputChannel.log(o.stderr,n.name);return}await Sb(n,e,t,["--force"])}):(t.outputChannel.log(o.stderr,n.name),re.window.showErrorMessage(`${o.stderr}`))}}async function wq(n){var t;let e=((t=re.workspace.workspaceFolders)==null?void 0:t.length)??0;re.workspace.updateWorkspaceFolders(e,0,{uri:re.Uri.file(n.path),name:n.name})}async function Cq(n){if(n.currentFolder){let e=re.Uri.joinPath(n.currentFolder.folder,"Package.swift"),t=await re.workspace.openTextDocument(e);re.window.showTextDocument(t)}}async function Si(n,e,t,r=!1,i){try{return await t.taskQueue.queueOperation({task:n,showStatusItem:!0,log:e,checkAlreadyRunning:i})===0?!0:(r&&re.window.showErrorMessage(`${e} failed`),!1)}catch(s){return r&&re.window.showErrorMessage(`${e} failed: ${s}`),!1}}function bq(n){try{let e=re.Uri.parse(n.path,!0);re.env.openExternal(e)}catch{}}function _b(n,e){let t=e.hasResolveErrors;e.hasResolveErrors=!n,t&&!e.hasResolveErrors&&e.fireEvent(_e.resolvedUpdated)}function Pb(n){n.subscriptions.push(re.commands.registerCommand("swift.resolveDependencies",()=>cq(n)),re.commands.registerCommand("swift.updateDependencies",()=>uq(n)),re.commands.registerCommand("swift.cleanBuild",()=>dq(n)),re.commands.registerCommand("swift.resetPackage",()=>hq(n)),re.commands.registerCommand("swift.runSingle",()=>gq(n)),re.commands.registerCommand("swift.openPackage",()=>Cq(n)),re.commands.registerCommand("swift.useLocalDependency",e=>{e instanceof Kn&&mq(e.name,n)}),re.commands.registerCommand("swift.editDependency",e=>{e instanceof Kn&&vq(e.name,n)}),re.commands.registerCommand("swift.uneditDependency",e=>{e instanceof Kn&&yq(e.name,n)}),re.commands.registerCommand("swift.openInWorkspace",e=>{e instanceof Kn&&wq(e)}),re.commands.registerCommand("swift.openExternal",e=>{e instanceof Kn&&bq(e)}))}var zn=ne(require("vscode"));var Bd=class{constructor(e,t){this.document=e;this.position=t}match(e){let t=this.getLine();if(!t)return null;let r=e.exec(t.text);if(r){let i=r.index+r[0].length;this.position=this.position.translate(void 0,i+t.whitespace);let s=r.map(o=>o);return s.shift(),s}return null}skipUntil(e){let t='{([<"',r='})]>"',i="})]",s=[];for(let o=this.getLine();o;o=this.getLine()){let a=-1,c=0;for(;c<o.text.length;){let u=o.text[c];if(e.indexOf(u)!==-1){let l=s.pop();if(!l)return this.position=this.position.translate(void 0,c+o.whitespace+1),o.text[c];e=l}else if((a=t.indexOf(u))!==-1)s.push(e),e=r[a];else{if(i.indexOf(u)!==-1&&e!=='"')return;u==="\\"&&e==='"'&&(c+=1)}c+=1}this.position=this.position.translate(1,-this.position.character)}}getLine(){for(;this.position.line<this.document.lineCount;){let t=this.document.lineAt(this.position.line).text.substring(this.position.character),r=/^\s*/.exec(t),i=0;if(r&&(i=r[0].length),t.length>i)return{text:t.substring(i),whitespace:i};this.position=this.position.translate(1,-this.position.character)}return null}};var Gd=class extends zn.CompletionItem{constructor(e,t,r,i){super(t,zn.CompletionItemKind.Text);this.detail=r,this.insertText=e,this.sortText=i}},kb=class{async provideCompletionItems(e,t){return this.isLineComment(e,t.line-1)===!1?void 0:[new Gd("/// ","///","Documentation comment")]}isLineComment(e,t){return!!/^\s*\/\/\//.test(e.lineAt(t).text)}},Eb=class{async provideCompletionItems(e,t){if(this.isLineComment(e,t.line)===!1)return;let i=this.getFunctionDetails(e,t);if(i){if(i.parameters.length===0&&i.returns===!1)return;let s=this.constructSnippetString(i),o=new zn.SnippetString(s);return[new Gd(o,"/// - parameters:","Function documentation comment")]}}isLineComment(e,t){return!!/^\s*\/\/\/\s*$/.test(e.lineAt(t).text)}getFunctionDetails(e,t){let r=new Bd(e,new zn.Position(t.line+1,0));if(!r.match(/(?:func|init)/))return null;let i=r.match(/^([^(<]*)\s*(\(|<)/);if(!i||i[1]==="<"&&(r.skipUntil(">"),!r.match(/^\(/)))return null;let s=[];if(!r.match(/^\)/))for(;;){let c=r.match(/(\S*)(?:\s*)?:/);if(!c)return null;s.push(...c);let u=r.skipUntil(",)");if(!u)return null;if(u===")")break}let o=!1;for(;;){let c=r.match(/^\s*([a-z]+)/);if(!c||c.length===0)break;c[0]==="throws"&&(o=!0)}let a=r.match(/^\s*->/)!==null;return{parameters:s,returns:a,throws:o}}constructSnippetString(e){let t=" $1",r=2;if(e.parameters.length===1)t+=`
/// - Parameter ${e.parameters[0]}: $${r}`,r++;else if(e.parameters.length>0){t+=`
/// - Parameters:`;for(let i of e.parameters)t+=`
///   - ${i}: $${r}`,r++}return e.returns&&(t+=`
/// - Returns: $${r}`),t}};function xb(){let n=zn.languages.registerCompletionItemProvider("swift",new Eb,"/"),e=zn.languages.registerCompletionItemProvider("swift",new kb,`
`);return{dispose:()=>{n.dispose(),e.dispose()}}}var Qd=ne(require("vscode")),qb=ne(wd());var Ac=class{constructor(e){let t=Qd.languages.createLanguageStatusItem("swiftlang-version",Ac.documentSelector);t.text=e.toolchain.swiftVersionString,this.packageSwiftItem=Qd.languages.createLanguageStatusItem("swiftlang-package",Ac.documentSelector),this.packageSwiftItem.text="No Package.swift";let r=e.observeFolders(async(i,s)=>{switch(s){case _e.focus:i?(this.packageSwiftItem.text="Package.swift",this.packageSwiftItem.command=qb.Command.create("Open Package","swift.openPackage")):(this.packageSwiftItem.text="No Package.swift",this.packageSwiftItem.command=void 0)}});this.subscriptions=[r,t,this.packageSwiftItem]}dispose(){this.subscriptions.forEach(e=>e.dispose())}},Lc=Ac;Lc.documentSelector=[{scheme:"file",language:"swift"},{scheme:"untitled",language:"swift"},{scheme:"file",language:"c"},{scheme:"untitled",language:"c"},{scheme:"file",language:"cpp"},{scheme:"untitled",language:"cpp"},{scheme:"file",language:"objective-c"},{scheme:"untitled",language:"objective-c"},{scheme:"file",language:"objective-cpp"},{scheme:"untitled",language:"objective-cpp"}];async function Rq(n){try{console.debug("Activating Swift for Visual Studio Code...");let e=await Xo.create();n.subscriptions.push(e),e.setLLDBVersion(),e.setupEventListeners();let t=Mc.tasks.registerTaskProvider("swift",new Bt(e));Pb(e);let r=xb(),i=new Lc(e),s=e.observeFolders((l,h)=>{e.outputChannel.log(`${h}: ${l==null?void 0:l.folder.fsPath}`,l==null?void 0:l.name)}),o=new Xd(e),a=Mc.window.createTreeView("packageDependencies",{treeDataProvider:o,showCollapseAll:!0});o.observeFolders(a);let c=e.observeFolders(async(l,h)=>{if(!!l)switch(h){case _e.add:case _e.packageUpdated:bs(l),l.swiftPackage.foundPackage&&await Oc(l,!0);break;case _e.resolvedUpdated:l.swiftPackage.foundPackage&&await Oc(l,!0)}}),u=qi.observeFolders(e);return e.addWorkspaceFolders(),n.subscriptions.push(c,u,a,o,s,i,r,t),{workspaceContext:e}}catch(e){throw Error(qn(e))}}function Sq(){}module.exports=Ub(_q);0&&(module.exports={activate,deactivate});
